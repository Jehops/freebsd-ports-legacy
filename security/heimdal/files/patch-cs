--- lib/otp/otp_md.c.orig	Tue Jul 11 19:26:43 2000
+++ lib/otp/otp_md.c	Thu Jan  4 09:38:17 2001
@@ -212,7 +212,7 @@
  */
 
 static void
-SHA1Final_little_endian (void *res, struct sha1 *m)
+SHA1Final_little_endian (void *res, SHA_CTX *m)
 {
   unsigned char tmp[20];
   unsigned char *p = res;
@@ -231,7 +231,7 @@
 otp_sha_init (OtpKey key, const char *pwd, const char *seed)
 {
   unsigned char res[20];
-  struct sha1 sha1;
+  SHA_CTX sha1;
 
   return otp_md_init (key, pwd, seed, 
 		      (void (*)(void *))SHA1Init, 
@@ -245,7 +245,7 @@
 	      size_t len,
 	      unsigned char *res)
 {
-  struct sha1 sha1;
+  SHA_CTX sha1;
 
   return otp_md_hash (data, len,
 		      (void (*)(void *))SHA1Init,
@@ -258,7 +258,7 @@
 otp_sha_next (OtpKey key)
 {
   unsigned char res[20];
-  struct sha1 sha1;
+  SHA_CTX sha1;
 
   return otp_md_next (key, 
 		      (void (*)(void *))SHA1Init, 
