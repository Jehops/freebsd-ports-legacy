--- pf/pf_ioctl.c.orig	Sun Sep 28 15:00:08 2003
+++ pf/pf_ioctl.c	Sun Sep 28 15:00:16 2003
@@ -201,7 +201,7 @@
 	/* psize */	nopsize,
 	/* flags */	0,
 	/* kqfilter */	nokqfilter,
-#else
+#elif (__FreeBSD_version < 501109)
 	.d_open =	pfopen,
 	.d_close =	pfclose,
 	.d_read =	noread,
@@ -215,6 +215,12 @@
 	.d_dump =	nodump,
 	.d_flags =	0,
 	.d_kqfilter =	nokqfilter,
+#else
+	.d_open =	pfopen,
+	.d_close =	pfclose,
+	.d_ioctl =	pfioctl,
+	.d_name =	PF_NAME,
+	.d_flags =	0,
 #endif
 };
 #endif /* __FreeBSD__ */
