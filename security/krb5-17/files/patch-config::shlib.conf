--- config/shlib.conf.orig	Mon Oct 23 05:20:11 2006
+++ config/shlib.conf	Wed Mar 28 17:17:55 2007
@@ -258,22 +258,15 @@
 	;;
 
 *-*-freebsd*)
-	if test -x /usr/bin/objformat ; then
-		objformat=`/usr/bin/objformat`
-	else
-		objformat="aout"
-	fi
-	PICFLAGS=-fpic
-	if test "x$objformat" = "xelf" ; then
+	case $krb5_cv_host in
+	sparc64-*)	PICFLAGS=-fPIC;;
+	*)		PICFLAGS=-fpic;;
+	esac
 		SHLIBVEXT='.so.$(LIBMAJOR)'
+		LDCOMBINE="libtool --mode=link cc -shared"
 		RPATH_FLAG='-Wl,-rpath -Wl,'
-	else
-		RPATH_FLAG=-R
-		SHLIBVEXT='.so.$(LIBMAJOR).$(LIBMINOR)'
-	fi
 	CC_LINK_SHARED='$(CC) $(PROG_LIBPATH) $(RPATH_FLAG)$(PROG_RPATH) $(CFLAGS) $(LDFLAGS)'
 	SHLIBEXT=.so
-	LDCOMBINE='ld -Bshareable'
 	SHLIB_EXPFLAGS='-R$(SHLIB_RDIRS) $(SHLIB_DIRS) $(SHLIB_EXPLIBS)'
 	CC_LINK_STATIC='$(CC) $(PROG_LIBPATH) $(CFLAGS) $(LDFLAGS)'
 	RUN_ENV='LD_LIBRARY_PATH=`echo $(PROG_LIBPATH) | sed -e "s/-L//g" -e "s/ /:/g"`; export LD_LIBRARY_PATH;'
