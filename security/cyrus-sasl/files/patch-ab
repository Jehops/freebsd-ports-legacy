--- configure.in.orig	Mon May  8 12:51:13 2000
+++ configure.in	Sat Jun 10 20:23:18 2000
@@ -66,8 +66,9 @@
 dnl check for -R, etc. switch
 CMU_GUESS_RUNPATH_SWITCH
 dnl let's just link against local.  otherwise we never find anything useful.
-CPPFLAGS="-I/usr/local/include ${CPPFLAGS}"
-CMU_ADD_LIBPATH("/usr/local/lib")
+CPPFLAGS="-I${OPENSSLINC} -I${OPENSSLINC}/openssl ${CPPFLAGS}"
+CMU_ADD_LIBPATH("${LOCALBASE}/lib")
+CMU_ADD_LIBPATH("${OPENSSLLIB}")
 
 AM_DISABLE_STATIC
 
@@ -413,8 +414,9 @@
 
   if test "$with_des" != no; then
     AC_CHECK_HEADER(krb.h,
-      AC_CHECK_LIB(krb, krb_mk_priv,:,
-                   AC_WARN(No Kerberos V4 found); krb4=no,
+      AC_CHECK_LIB(krb, krb_mk_priv, COM_ERR="",
+                   AC_CHECK_LIB(krb, krb_mk_err, COM_ERR="-lcom_err",
+			AC_WARN(No Kerberos V4 found); krb4=no,-ldes -lcom_err),
 		   -ldes),
       AC_WARN(No Kerberos V4 found); krb4=no)
   else
@@ -428,7 +430,7 @@
   AC_MSG_RESULT(enabled)
   SASL_MECHS="$SASL_MECHS libkerberos4.la"
   AC_DEFINE(HAVE_KRB)
-  SASL_KRB_LIB="-lkrb -ldes"
+  SASL_KRB_LIB="-lkrb -ldes $COM_ERR"
   AC_SUBST(SASL_KRB_LIB)
 else
   AC_MSG_RESULT(disabled)
