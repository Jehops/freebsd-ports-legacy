--- Makefile.in.orig	Thu Jun  6 19:39:35 1996
+++ Makefile.in	Fri Jun  7 11:58:02 1996
@@ -137,12 +137,16 @@
 SHELL = /bin/sh
 
 GMPDIR 		= gmp-1.3.2
-GMPLIBS 	= -L$(GMPDIR) -lgmp
-GMPDEP 		= $(GMPDIR)/gmp.h $(GMPDIR)/libgmp.a
+GMPINCDIR	= $(GMPDIR)
+GMPLIBDIR	= $(GMPDIR)
+GMPDEP 		= $(GMPINCDIR)/gmp.h $(GMPLIBDIR)/libgmp.a
+GMPLIBS 	= -L$(GMPLIBDIR) -lgmp
 
 ZLIBDIR		= zlib095
-ZLIBDEP		= $(ZLIBDIR)/libz.a
-ZLIBLIBS	= -L$(ZLIBDIR) -lz
+ZLIBINCDIR	= $(ZLIBDIR)
+ZLIBLIBDIR	= $(ZLIBDIR)
+ZLIBDEP		= $(ZLIBINCDIR)/zlib.h $(ZLIBLIBDIR)/libz.a
+ZLIBLIBS	= -L$(ZLIBLIBDIR) -lz
 
 RSAREFDIR	= rsaref2
 RSAREFSRCDIR 	= $(RSAREFDIR)/source
@@ -223,7 +227,7 @@
 	$(CC) -o rfc-pg rfc-pg.c
 
 .c.o:
-	$(CC) -c -I. -I$(srcdir)/$(GMPDIR) -I$(srcdir)/$(ZLIBDIR) $(DEFS) -DHOST_KEY_FILE=\"$(HOST_KEY_FILE)\" -DHOST_CONFIG_FILE=\"$(HOST_CONFIG_FILE)\" -DSERVER_CONFIG_FILE=\"$(SERVER_CONFIG_FILE)\" -DSSH_PROGRAM=\"$(SSH_PROGRAM)\" -DETCDIR=\"$(etcdir)\" -DPIDDIR=\"$(piddir)\" -DBINDIR=\"$(bindir)\" $(CFLAGS) $(X_CFLAGS) $<
+	$(CC) -c -I. -I$(GMPINCDIR) -I$(ZLIBINCDIR) $(DEFS) -DHOST_KEY_FILE=\"$(HOST_KEY_FILE)\" -DHOST_CONFIG_FILE=\"$(HOST_CONFIG_FILE)\" -DSERVER_CONFIG_FILE=\"$(SERVER_CONFIG_FILE)\" -DSSH_PROGRAM=\"$(SSH_PROGRAM)\" -DETCDIR=\"$(etcdir)\" -DPIDDIR=\"$(piddir)\" -DBINDIR=\"$(bindir)\" $(CFLAGS) $(X_CFLAGS) $<
 
 sshd: $(SSHD_OBJS) $(GMPDEP) $(RSAREFDEP) $(ZLIBDEP)
 	-rm -f sshd
@@ -282,7 +286,7 @@
               CC="$(CC)" CFLAGS="$(CFLAGS) -I. -I$(srcdir)/$(GMPDIR) \
 	       -I../$(srcdir)/$(GMPDIR)" RANLIB="$(RANLIB)"
 
-$(ZLIBDEP):
+$(ZLIBDIR)/libz.a:
 	-if test '!' -d $(ZLIBDIR); then \
 	  mkdir $(ZLIBDIR); \
 	  cp $(srcdir)/$(ZLIBDIR)/Makefile $(ZLIBDIR); \
