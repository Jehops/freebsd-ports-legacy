--- opt/drweb/update/update.pl.orig	Wed May 15 03:58:22 2002
+++ opt/drweb/update/update.pl	Fri May 17 13:07:42 2002
@@ -35,10 +35,10 @@
 my $ini = $ARGV[0];
 if( $ini eq '' )
 {
-  $ini = "/etc/drweb/drweb32.ini";
+  $ini = "%INSTALL%/drweb32.ini";
 }
 
-my $fetch = "fetch -aq -o";
+my $fetch = "fetch -q -o";
 #my $fetch = "wget -q -O";
    $fetch = "wget -q -O" if( $^O =~ /Linux/i );   
 
@@ -52,7 +52,7 @@
    die "Bases path is not defined!" unless $bases;
    die "Update path is not defined!" unless $update;
    
-   $pidFile = "/var/drweb/run/drwebd.pid" if( $pidFile eq '' );
+   $pidFile = "%INSTALL%/run/drwebd.pid" if( $pidFile eq '' );
 
 my $version = readVersion( $engine ); 
    die "Engine version error (invalid engine?)" unless $version;
@@ -179,7 +179,7 @@
       {
         $engine = $v;
         $engine =~ s/^[\"\t =]*//g;
-        $engine =~ s/[\" \t]$*//g;       
+	$engine =~ s/[\" \t]*$//g;
       }
     }
     elsif( /^PidFile/ )
@@ -189,7 +189,7 @@
       {
         $pidFile= $v;
         $pidFile =~ s/^[\"\t =]*//g;
-        $pidFile =~ s/[\" \t]$*//g;       
+	$pidFile =~ s/[\" \t]*$//g;
       }
     }
     elsif( /^VirusBase/ && $bases eq '' ) # first base path only
@@ -200,7 +200,8 @@
         $bases = $v;
 
         $bases =~ s/^[\"\t =]*//g;
-        $bases =~ s/[\" \t]$*//g;
+	$bases =~ s/,.*$//;
+	$bases =~ s/[\" \t]*$//g;
 	$bases =~ s/\/[\d\w\*\?\.]*$//;
       }
     }
@@ -211,7 +212,7 @@
       {
         $update = $v;
         $update =~ s/^[\"\t =]*//g;
-        $update =~ s/[\" \t]$*//g;       
+	$update =~ s/[\" \t]*$//g;
       }
     }
   } 
