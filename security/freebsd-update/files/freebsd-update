#!/bin/sh

if [ ! -r %%PREFIX%%/etc/freebsd-update.conf ] ; then
	echo "%%PREFIX%%/etc/freebsd-update.conf not found"
	exit 1
fi

case "$1" in
fetch)
	cd %%PREFIX%%/freebsd-update && make 				\
		CONFFILE=%%PREFIX%%/etc/freebsd-update.conf fetch-update;;
install)
	cd %%PREFIX%%/freebsd-update && make 				\
		CONFFILE=%%PREFIX%%/etc/freebsd-update.conf install-update;;
rollback)
	cd %%PREFIX%%/freebsd-update && make 				\
		CONFFILE=%%PREFIX%%/etc/freebsd-update.conf rollback-update;;
cron)
	cd %%PREFIX%%/freebsd-update && make MAILTO=root QUIET=YES 	\
		CONFFILE=%%PREFIX%%/etc/freebsd-update.conf daily;;
*)
	echo "Usage: freebsd-update {fetch|install|rollback|cron}" >&2
	echo "  freebsd-update fetch:    Fetches updates" >&2
	echo "  freebsd-update install:  Installs fetched updates" >&2
	echo "  freebsd-update rollback: Rolls back installed updates" >&2
	echo "  freebsd-update cron:     Suitable for use in cron(8)," >&2
	echo "                           fetches updates and sends an" >&2
	echo "                           email to root if any exist." >&2
	;;
esac

exit 0
