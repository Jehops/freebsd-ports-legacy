--- portscanner.c.orig	Wed Aug 19 10:37:44 1998
+++ portscanner.c	Sun Jul  7 13:16:39 2002
@@ -25,8 +25,8 @@
 /***********************************************************/
 
 #include <stdio.h>
-#include <sys/socket.h>
 #include <sys/types.h>
+#include <sys/socket.h>
 #include <netinet/in.h>
 #include <unistd.h>
 #include <netdb.h>
@@ -268,7 +268,7 @@
      goodproto = 0;
     } else address2.sin_port = htons(base_port+current_port);
 
-    if (!finished)
+    if (!finished) {
     if (connect(sock, (struct sockaddr *)&address2, sizeof(address2)) == 0) {
      switch (verbose) {
       case 0: if (strobe)
@@ -312,6 +312,7 @@
        finished = 1;
      }
     /* fprintf(stderr,"current_port: %d,b: %d,e:%d,b+c:%d\n", current_port, base_port,end_port,base_port+current_port); */
+   }
    }
 
   if (verbose == 2) printf("Port scan finished !\n");
