--- configure.orig	Sun Jun 19 21:56:23 2005
+++ configure	Thu Jun 23 14:57:09 2005
@@ -10914,6 +10914,9 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+#include <sys/types.h>
+#include <netinet/in.h>
+#include <arpa/nameser.h>
 #include <resolv.h>
 _ACEOF
 rm -f conftest.$ac_objext
@@ -10957,6 +10960,9 @@
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <sys/types.h>
+#include <netinet/in.h>
+#include <arpa/nameser.h>
 #include <resolv.h>
 _ACEOF
 if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
@@ -13267,7 +13273,7 @@
 # Check whether --enable-gethostbyname_r or --disable-gethostbyname_r was given.
 if test "${enable_gethostbyname_r+set}" = set; then
   enableval="$enable_gethostbyname_r"
-  disable_gethostbyname_r=$enableval
+  test $enableval = yes && disable_gethostbyname_r=no || disable_gethostbyname_r=yes
 fi;
 
 if test "$disable_gethostbyname_r" = "yes"; then
