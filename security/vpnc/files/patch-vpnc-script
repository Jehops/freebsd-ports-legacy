
$FreeBSD$

--- vpnc-script.orig
+++ vpnc-script
@@ -56,8 +56,8 @@
 		;;
 esac
 
-DEFAULT_ROUTE_FILE=/var/run/vpnc/defaultroute
-RESOLV_CONF_BACKUP=/var/run/vpnc/resolv.conf-backup
+DEFAULT_ROUTE_FILE=/var/run/vpnc.defaultroute
+RESOLV_CONF_BACKUP=/var/run/vpnc.resolv.conf-backup
 FULL_SCRIPTNAME=/usr/local/sbin/vpnc
 SCRIPTNAME=`basename $FULL_SCRIPTNAME`
 
@@ -407,11 +407,13 @@
 			fi
 		fi
 	elif [ "$OS" = "FreeBSD" ]; then
-		if [ ! -e /dev/tun ]; then
+		kldstat -q -m if_tun
+		if [ ${?} != 0 ]; then
 			kldload if_tun
 		fi
 	elif [ "$OS" = "GNU/kFreeBSD" ]; then
-		if [ ! -e /dev/tun ]; then
+		kldstat -q -m if_tun
+		if [ ${?} != 0 ]; then
 			kldload if_tun
 		fi
 	elif [ "$OS" = "NetBSD" ]; then
