--- compat.c.orig	2015-04-08 21:02:53.327154000 -0500
+++ compat.c	2015-04-08 21:03:58.915062000 -0500
@@ -167,6 +167,8 @@
 					SSH_BUG_SCANNER },
 		{ "Probe-*",
 					SSH_BUG_PROBE },
+		{ "TTSSH/*",
+					SSH_BUG_HOSTKEYS },
 		{ NULL,			0 }
 	};
 
--- compat.h.orig	2015-04-08 21:02:42.865971000 -0500
+++ compat.h	2015-04-08 21:04:06.865029000 -0500
@@ -60,6 +60,7 @@
 #define SSH_NEW_OPENSSH		0x04000000
 #define SSH_BUG_DYNAMIC_RPORT	0x08000000
 #define SSH_BUG_CURVE25519PAD	0x10000000
+#define SSH_BUG_HOSTKEYS	0x20000000
 
 void     enable_compat13(void);
 void     enable_compat20(void);
--- sshd.c.orig	2015-04-08 21:01:02.944936000 -0500
+++ sshd.c	2015-04-08 21:03:55.086137000 -0500
@@ -2321,7 +2321,7 @@
 	    options.client_alive_count_max);
 
 	/* Try to send all our hostkeys to the client */
-	if (compat20)
+	if (compat20 && (datafellows & SSH_BUG_HOSTKEYS) == 0)
 		notify_hostkeys(active_state);
 
 	/* Start session. */
