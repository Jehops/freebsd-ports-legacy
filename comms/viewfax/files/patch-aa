--- viewfax.c	1996/11/13 21:46:44	2.4
+++ viewfax.c	2000/08/25 19:51:10	2.4.0.1
@@ -294,6 +294,9 @@ drawline(pixnum *run, int LineNum, struc
     while (tot < pn->width) {
 	n = *r++;
 	tot += n;
+	/* Watch out for buffer overruns, e.g. when n == 65535.  */
+	if ( tot > pn->width || LineNum >= pn->height && tot >= pn->width )
+	    break;
 	if (pix)
 	    acc |= (~(t32bits)0 >> nacc);
 	else if (nacc)
