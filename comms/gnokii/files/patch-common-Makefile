--- common/Makefile.orig	Tue May 20 21:04:08 2003
+++ common/Makefile	Tue May 20 21:21:55 2003
@@ -41,15 +41,12 @@
 	misc.o \
 	snprintf.o
 
-ifdef NO_SHARED
-GNOKII_LIB=libgnokii.a
-else
+GNOKII_LIBNOSHARED  =libgnokii.a
 GNOKII_LIB  =libgnokii.so
 GNOKII_LIBM =$(GNOKII_LIB).$(MAJOR_NUMBER)
 GNOKII_LIBMM=$(GNOKII_LIBM).$(MINOR_NUMBER)
-endif
 
-all: $(GNOKII_LIB)
+all: $(GNOKII_LIB) $(GNOKII_LIBNOSHARED)
 
 phones/PHONES.o:
 	$(MAKE) -C phones PHONES.o
@@ -64,8 +61,7 @@
 	$(CC) -o gnokii-debug $(OBJS) phones/PHONES.o links/LINKS.o devices/DEVICES.o ../gnokii/gnokii.o
 
 libgnokii.so: $(OBJS) phones/PHONES.o links/LINKS.o devices/DEVICES.o
-	$(CC) -shared -Wl,-soname,$(GNOKII_LIBM) -o $(GNOKII_LIBMM) $(OBJS) phones/PHONES.o links/LINKS.o devices/DEVICES.o
-	ln -sf $(GNOKII_LIBMM) $(GNOKII_LIBM)
+	$(CC) -shared -Wl,-soname,$(GNOKII_LIBM) -o $(GNOKII_LIBM) $(OBJS) phones/PHONES.o links/LINKS.o devices/DEVICES.o
 	ln -sf $(GNOKII_LIBM) $(GNOKII_LIB)
 
 libgnokii.a: $(OBJS) phones/PHONES.o links/LINKS.o devices/DEVICES.o
@@ -84,8 +80,8 @@
 
 install:
 	$(INSTALL) -d $(DESTDIR)$(libdir)
-	$(INSTALL) $(GNOKII_LIBMM) $(DESTDIR)$(libdir)
-	cd $(DESTDIR)$(libdir) && ln -sf $(GNOKII_LIBMM) $(GNOKII_LIBM)
+	$(INSTALL) $(GNOKII_LIBM) $(DESTDIR)$(libdir)
+	$(INSTALL) $(GNOKII_LIBNOSHARED) $(DESTDIR)$(libdir)
 	cd $(DESTDIR)$(libdir) && ln -sf $(GNOKII_LIBM) $(GNOKII_LIB)
 	$(INSTALL) -d $(DESTDIR)$(libdir)/pkgconfig
 	$(INSTALL) gnokii.pc $(DESTDIR)$(libdir)/pkgconfig
