--- configure.orig	2007-11-24 12:31:25.000000000 +0100
+++ configure	2007-12-06 12:08:24.000000000 +0100
@@ -981,7 +981,7 @@
 psdir='${docdir}'
 libdir='${exec_prefix}/lib'
 localedir='${datarootdir}/locale'
-mandir='${datarootdir}/man'
+mandir='${prefix}/man'
 
 ac_prev=
 ac_dashdash=
@@ -26588,13 +26588,15 @@
 # First of all, check if the user has set any of the PTHREAD_LIBS,
 # etcetera environment variables, and if threads linking works using
 # them:
-if test x"$PTHREAD_LIBS$PTHREAD_CFLAGS" != x; then
+if test x"-pthread" != x; then
+	PTHREAD_CFLAGS=""
+	PTHREAD_LIBS="-pthread"
         save_CFLAGS="$CFLAGS"
-        CFLAGS="$CFLAGS $PTHREAD_CFLAGS"
+        CFLAGS="$CFLAGS "
         save_LIBS="$LIBS"
-        LIBS="$PTHREAD_LIBS $LIBS"
-        { echo "$as_me:$LINENO: checking for pthread_join in LIBS=$PTHREAD_LIBS with CFLAGS=$PTHREAD_CFLAGS" >&5
-echo $ECHO_N "checking for pthread_join in LIBS=$PTHREAD_LIBS with CFLAGS=$PTHREAD_CFLAGS... $ECHO_C" >&6; }
+        LIBS="-pthread $LIBS"
+        { echo "$as_me:$LINENO: checking for pthread_join in LIBS=-pthread with CFLAGS=" >&5
+echo $ECHO_N "checking for pthread_join in LIBS=-pthread with CFLAGS=... $ECHO_C" >&6; }
         cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -26958,7 +26960,7 @@
 echo $ECHO_N "checking if more special flags are required for pthreads... $ECHO_C" >&6; }
         flag=no
         case "${host_cpu}-${host_os}" in
-                *-aix* | *-freebsd* | *-darwin*) flag="-D_THREAD_SAFE";;
+                *-aix* | *-darwin*) flag="-D_THREAD_SAFE";;
                 *solaris* | *-osf* | *-hpux*) flag="-D_REENTRANT";;
         esac
         { echo "$as_me:$LINENO: result: ${flag}" >&5
@@ -27762,7 +27764,7 @@
 
 if test "$enable_libical" == "yes"; then
 	OLD_CFLAGS="$CFLAGS"
-	LIBS="$LIBS $ICAL_LIBS -lpthread -lical"
+	LIBS="$LIBS $ICAL_LIBS -pthread -lical"
 	CFLAGS="$CFLAGS $ICAL_CFLAGS"
 	{ echo "$as_me:$LINENO: checking whether libical is installed" >&5
 echo $ECHO_N "checking whether libical is installed... $ECHO_C" >&6; }
@@ -29577,7 +29579,7 @@
 echo "${ECHO_T}$ac_cv_lib_Xpm_XpmWriteFileFromXpmImage" >&6; }
 if test $ac_cv_lib_Xpm_XpmWriteFileFromXpmImage = yes; then
    XPM_CFLAGS="$XINCL"
-                  XPM_LIBS="$XLIBS -lXpm -lX11"
+                  XPM_LIBS="$XLIBS -lXpm -lX11 -lroken -lcrypt"
                   cat >>confdefs.h <<\_ACEOF
 #define XPM 1
 _ACEOF
