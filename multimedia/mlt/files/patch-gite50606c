commit e50606ca3f680029b7f16bbbf284adac34f30ded
Author: Dan Dennedy <dan@dennedy.org>
Date:   Mon Jun 2 19:18:50 2014 -0700

    Fix compilation with clang.

diff --git a/configure b/configure
index eb20880..e540704 100755
--- configure
+++ configure
@@ -81,10 +81,12 @@ build_config()
 		if [ "$optimisations" = "true" ]
 		then
 			echo "OPTIMISATIONS=-O2 -pipe"
-			# Since gcc 4.6, this optimization enabled with -O1 causes filter_line_sse2 to crash.
-			echo "OPTIMISATIONS+=-fno-tree-dominator-opts"
-			# Since gcc 4.6, this optimization enabled with -O2 causes filter_line_sse2 to crash.
-			echo "OPTIMISATIONS+=-fno-tree-pre"
+			if $("$CC" --version 2> /dev/null | grep gcc); then
+				# Since gcc 4.6, this optimization enabled with -O1 causes filter_line_sse2 to crash.
+				echo "OPTIMISATIONS+=-fno-tree-dominator-opts"
+				# Since gcc 4.6, this optimization enabled with -O2 causes filter_line_sse2 to crash.
+				echo "OPTIMISATIONS+=-fno-tree-pre"
+			fi
 		fi
 
 		echo "CFLAGS+=-Wall -DPIC \$(TARGETARCH) \$(TARGETCPU) \$(OPTIMISATIONS) \$(MMX_FLAGS) \$(SSE_FLAGS) \$(SSE2_FLAGS) \$(DEBUG_FLAGS) \$(LARGE_FILE)"
