--- SConstruct~	Sun Dec 11 12:07:09 2005
+++ SConstruct	Thu Dec 29 00:19:48 2005
@@ -38,13 +38,17 @@
 
 ###### BUILD ENVIRONMENT
 
+opts.Add('CFLAGS','compiler flags', "-O3 -Wall")
+opts.Add('LDFLAGS','linker flags', "")
+
 env=Environment(options=opts, ENV=os.environ)
 debug=int(env['DEBUG'])
 
 if (debug>0):
   env.Append(CCFLAGS=['-g3','-Wall'])
-else:
-  env.Append(CCFLAGS=['-O3','-Wall'])
+env.Append(CCFLAGS=Split(env["CFLAGS"]))
+
+env.Append(LINKFLAGS=Split(env["LDFLAGS"]))
 
 env.Replace(CXXFILESUFFIX=".cpp")
 
@@ -48,7 +48,7 @@
 
 env.Replace(CXXFILESUFFIX=".cpp")
 
-env.Append(CPPDEFINES={"_FILE_OFFSET_BITS": "64", "_LARGEFILE_SOURCE": None})
+env.Append(CPPDEFINES=[("_FILE_OFFSET_BITS", "64"), "_LARGEFILE_SOURCE"])
 
 for v in ("CXX","LINK"):
   if (v in os.environ):
@@ -62,11 +62,11 @@
 
 if (not env.GetOption('clean')):
   if (conf.TryAction('pkg-config --exists ao')[0]):
-    conf.env.Append(CPPDEFINES={"HAVE_LIB_AO":None})
+    conf.env.Append(CPPDEFINES="HAVE_LIB_AO")
     conf.env.ParseConfig('pkg-config --cflags --libs ao')
     print "Checking for libao... found"
   elif (conf.CheckLibWithHeader('ao', 'ao/ao.h', 'C')):
-    conf.env.Append(CPPDEFINES={"HAVE_LIB_AO":None})
+    conf.env.Append(CPPDEFINES="HAVE_LIB_AO")
     conf.env.Append(LIBS=['ao'])
     print "Checking for libao... found"
   else:
@@ -85,7 +85,7 @@
 env.Replace(QT_LIB=qtlib)
 
 if (debug<=0):
-  env.Append(CPPDEFINES={"QT_NO_DEBUG": None})
+  env.Append(CPPDEFINES="QT_NO_DEBUG")
 
 ### FFMPEG
 
