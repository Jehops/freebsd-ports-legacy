--- src/ieee1394io.cc.orig	Thu May 19 00:40:12 2005
+++ src/ieee1394io.cc	Thu Jul 14 00:39:30 2005
@@ -62,11 +62,13 @@
 #include <sys/poll.h>
 #include <errno.h>
 
+#if 0
 #include <libraw1394/raw1394.h>
 #include <libraw1394/csr.h>
 #include <libavc1394/avc1394.h>
 #include <libavc1394/avc1394_vcr.h>
 #include <libavc1394/rom1394.h>
+#endif
 
 #include "ieee1394io.h"
 #include "preferences.h"
@@ -263,7 +265,7 @@
 raw1394Reader::raw1394Reader( int p, int c, int bufSize ) :
 		IEEE1394Reader( c, bufSize ), port( p )
 {
-	handle = NULL;
+	//handle = NULL;
 	cerr << ">>> Using raw1394 capture" << endl;
 }
 
@@ -332,7 +334,8 @@
 
 bool raw1394Reader::Open()
 {
-	bool success;
+	bool success = false;
+#if 0
 	int numcards;
 	struct raw1394_portinfo pinf[ 16 ];
 	iso_handler_t oldhandler;
@@ -367,6 +370,7 @@
 		cerr << exc << endl;
 		success = false;
 	}
+#endif
 	return success;
 }
 
@@ -377,11 +381,13 @@
 
 void raw1394Reader::Close()
 {
+#if 0
 	if ( handle != NULL )
 	{
 		raw1394_destroy_handle( handle );
 		handle = NULL;
 	}
+#endif
 }
 
 bool raw1394Reader::StartReceive()
@@ -391,7 +397,7 @@
 	/* Starting iso receive */
 	try
 	{
-		fail_neg( raw1394_start_iso_rcv( handle, channel ) );
+//		fail_neg( raw1394_start_iso_rcv( handle, channel ) );
 		success = true;
 	}
 	catch ( string exc )
@@ -405,8 +411,8 @@
 
 void raw1394Reader::StopReceive()
 {
-	if ( handle != NULL )
-		raw1394_stop_iso_rcv( handle, channel );
+//	if ( handle != NULL )
+//		raw1394_stop_iso_rcv( handle, channel );
 }
 
 
@@ -442,6 +448,7 @@
  
 */
 
+#if 0
 int raw1394Reader::HandlerProxy( raw1394handle_t handle, int channel, size_t length, quadlet_t *data )
 {
 	raw1394Reader *self = static_cast< raw1394Reader* >( raw1394_get_userdata( handle ) );
@@ -553,6 +560,7 @@
 
 	return 0;
 }
+#endif
 
 
 /** The thread responsible for polling the raw1394 interface.
@@ -572,6 +580,7 @@
 	struct pollfd raw1394_poll;
 	int result;
 		
+#if 0
 	raw1394_poll.fd = raw1394_get_fd( handle );
 	raw1394_poll.events = POLLIN | POLLERR | POLLHUP | POLLPRI;
 
@@ -589,6 +598,7 @@
 		        || ( raw1394_poll.revents & POLLPRI ) ) )
 			result = raw1394_loop_iterate( handle );
 	}
+#endif
 	return NULL;
 }
 
@@ -674,6 +684,7 @@
 
 bool dv1394Reader::Open()
 {
+#if 0
 	int n_frames = DV1394_MAX_FRAMES / 4;
 	struct dv1394_init init =
 	    {
@@ -704,6 +715,8 @@
 	}
 
 	return true;
+#endif
+	return false;
 }
 
 
@@ -712,6 +725,7 @@
 */
 void dv1394Reader::Close()
 {
+#if 0
 	if ( m_dv1394_fd != -1 )
 	{
 		if ( m_dv1394_map != NULL )
@@ -720,11 +734,13 @@
 		m_dv1394_map = NULL;
 		m_dv1394_fd = -1;
 	}
+#endif
 }
 
 
 bool dv1394Reader::StartReceive()
 {
+#if 0
 	/* Starting iso receive */
 	if ( ioctl( m_dv1394_fd, DV1394_START_RECEIVE, NULL ) )
 	{
@@ -732,6 +748,8 @@
 		return false;
 	}
 	return true;
+#endif
+	return false;
 }
 
 
@@ -740,6 +758,7 @@
 
 bool dv1394Reader::Handler( int handle )
 {
+#if 0
 	struct dv1394_status dvst;
 	struct pollfd pol;
 	int result;
@@ -826,6 +845,8 @@
 
 	}
 	return true;
+#endif
+	return false;
 }
 
 
@@ -861,6 +882,7 @@
 
 AVC::AVC( int p ) : port( p )
 {
+#if 0
 	pthread_mutex_init( &avc_mutex, NULL );
 	avc_handle = NULL;
 	int numcards;
@@ -897,6 +919,7 @@
 		avc_handle = NULL;
 		cerr << exc << endl;
 	}
+#endif
 	return;
 }
 
@@ -907,6 +930,7 @@
 
 AVC::~AVC()
 {
+#if 0
 	if ( avc_handle != NULL )
 	{
 		pthread_mutex_lock( &avc_mutex );
@@ -914,11 +938,13 @@
 		avc_handle = NULL;
 		pthread_mutex_unlock( &avc_mutex );
 	}
+#endif
 }
 
 
 extern KinoCommon *common;
 
+#if 0
 int AVC::ResetHandler( raw1394handle_t handle, unsigned int generation )
 {
 	cerr << "Reset Handler received" << endl;
@@ -926,7 +952,7 @@
 	common->getPageCapture() ->driver_locked = true;
 	return 0;
 }
-
+#endif
 
 /** See if a node_id is still valid and pointing to an AV/C Recorder.
  
@@ -942,6 +968,7 @@
 int AVC::isPhyIDValid( int phyID )
 {
 	int value = -1;
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -984,6 +1011,7 @@
 		}
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return value;
 }
 
@@ -992,6 +1020,7 @@
 */
 void AVC::Noop( void )
 {
+#if 0
 	struct pollfd raw1394_poll;
 	raw1394_poll.fd = raw1394_get_fd( avc_handle );
 	raw1394_poll.events = POLLIN | POLLPRI;
@@ -1002,11 +1031,13 @@
 		        || ( raw1394_poll.revents & POLLPRI ) )
 			raw1394_loop_iterate( avc_handle );
 	}
+#endif
 }
 
 
 int AVC::Play( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1018,12 +1049,14 @@
 		}
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 
 int AVC::Pause( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1040,12 +1073,14 @@
 	    };
 	nanosleep( &t, NULL );
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 
 int AVC::Stop( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1058,12 +1093,14 @@
 	    };
 	nanosleep( &t, NULL );
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 
 int AVC::Rewind( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1071,12 +1108,14 @@
 			avc1394_vcr_rewind( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 
 int AVC::FastForward( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1084,11 +1123,13 @@
 			avc1394_vcr_forward( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::Forward( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1096,11 +1137,13 @@
 			avc1394_vcr_next( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::Back( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1108,11 +1151,13 @@
 			avc1394_vcr_previous( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::NextScene( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1120,11 +1165,13 @@
 			avc1394_vcr_next_index( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::PreviousScene( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1132,11 +1179,13 @@
 			avc1394_vcr_previous_index( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::Record( int phyID )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1144,11 +1193,13 @@
 			avc1394_vcr_record( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 int AVC::Shuttle( int phyID, int speed )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1156,12 +1207,14 @@
 			avc1394_vcr_trick_play( avc_handle, phyID, speed );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return 0;
 }
 
 unsigned int AVC::TransportStatus( int phyID )
 {
 	quadlet_t val = 0;
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1169,11 +1222,13 @@
 			val = avc1394_vcr_status( avc_handle, phyID );
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return val;
 }
 
 bool AVC::Timecode( int phyID, char* timecode )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1202,10 +1257,13 @@
 	}
 	pthread_mutex_unlock( &avc_mutex );
 	return true;
+#endif
+	return false;
 }
 
 int AVC::getNodeId( const char *guid )
 {
+#if 0
 	pthread_mutex_lock( &avc_mutex );
 	if ( avc_handle != NULL )
 	{
@@ -1228,6 +1286,7 @@
 		}
 	}
 	pthread_mutex_unlock( &avc_mutex );
+#endif
 	return -1;
 }
 
@@ -1235,6 +1294,7 @@
 dv1394Writer::dv1394Writer( string device, unsigned int channel, unsigned int nBuffers,
                             unsigned int cip_n, unsigned int cip_d, unsigned int syt_offset ) : isInitialised( false )
 {
+#if 0
 	m_fd = -1;
 	m_deviceName = device;
 	m_channel = channel;
@@ -1244,6 +1304,7 @@
 	m_syt_offset = syt_offset;
 
 	m_fd = open( m_deviceName.c_str(), O_RDWR );
+#endif
 }
 
 
@@ -1259,6 +1320,7 @@
 
 void dv1394Writer::SendFrame( Frame &frame )
 {
+#if 0
 	bool isPAL = frame.IsPAL();
 
 	if ( !isInitialised )
@@ -1283,4 +1345,5 @@
 	}
 
 	write( m_fd, frame.data, ( isPAL ? DV1394_PAL_FRAME_SIZE : DV1394_NTSC_FRAME_SIZE ) );
+#endif
 }
