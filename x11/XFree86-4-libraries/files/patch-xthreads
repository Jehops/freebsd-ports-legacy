--- config/cf/FreeBSD.cf.orig	Wed Jul 10 16:27:39 2002
+++ config/cf/FreeBSD.cf	Wed Jul 10 17:14:39 2002
@@ -43,11 +43,15 @@
 #define GccUsesGas		YES
 #define UseGas			YES
 #define GnuCpp			YES
+#define HasPoll			YES
 #define HasNdbm			YES
 #define HasPutenv		YES
 #define HasSnprintf		YES
 #define HasBSD44Sockets 	YES
 #define HasDlopen		YES
+#if ((OSRelVersion >= 410002) && OSRelVersion < 500000) || (OSRelVersion >= 500012)
+#define HasSetProcTitle		YES
+#endif
 #ifndef HasLibCrypt
 # define HasLibCrypt		YES
 #endif
@@ -78,10 +82,6 @@
 # define HasPosixThreads	YES
 # define ThreadedX		YES
 /*
- * math.h uses _REENTRANT and stdio.h uses _THREAD_SAFE, so define both.
- */
-# define SystemMTDefines	-D_REENTRANT -D_THREAD_SAFE
-/*
  * FreeBSD has tread-safe api but no getpwnam_r yet.
  */
 # define HasThreadSafeAPI	YES
@@ -91,8 +91,15 @@
 # else
 #  define BuildThreadStubLibrary  YES 
 #  define NeedUIThrStubs          YES 
-#  define ThreadsCompileFlags	-pthread
-#  define ThreadsLibraries 	-pthread
+#  if (OSRelVersion >= 500016)
+#   define ThreadsLibraries	-lc_r
+#  else
+    /*
+     * math.h uses _REENTRANT and stdio.h uses _THREAD_SAFE, so define both.
+     */
+#   define SystemMTDefines	-D_REENTRANT -D_THREAD_SAFE
+#   define ThreadsLibraries	-pthread
+#  endif
 #  define SharedX11Reqs		$(LDPRELIB) $(XTHRSTUBLIB)
 #  define SharedXtReqs		$(LDPRELIB) $(XLIBONLY) $(SMLIB) $(ICELIB) $(XTHRSTUBLIB)
 # endif
@@ -216,6 +223,20 @@
 #endif
 #endif
 
+/* Katmai (SSE) and 3DNow will be autodetected, so binutils is the only 
+ * requirement for enabling this.  By 4.2 they were all supported.
+ */
+#ifdef i386Architecture &&  \
+	(OSMajorVersion >= 5) || (OSMajorVersion == 4 && OSMinorVersion >= 2))
+# define HasMMXSupport		YES
+# define Has3DNowSupport	YES
+# define HasKatmaiSupport	YES
+#else
+# define HasMMXSupport		NO
+# define Has3DNowSupport	NO
+# define HasKatmaiSupport	NO
+#endif
+
 /* 
  * This doesn't work the way it does on every other system. On FreeBSD it's
  * only a "hint, not a demand", whatever that means. Note that this is not 
@@ -540,7 +561,7 @@
 /*
  * A hack to work around an optimization problem with gcc 2.95.2
  */
-#if OSMajorVersion >= 4
+#if OSMajorVersion == 4
 #define GccOptBug295
 #endif
 
