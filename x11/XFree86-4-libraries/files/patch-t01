
$FreeBSD$

--- config/imake/imake.c.orig	Fri Dec 14 21:53:18 2001
+++ config/imake/imake.c	Sat May 11 03:03:51 2002
@@ -1161,7 +1161,7 @@
 get_gcc_incdir(FILE *inFile)
 {
   static char* gcc_path[] = {
-#if defined(linux) || defined(__OpenBSD__) || defined (__GNU__)
+#if defined(linux) || defined(__OpenBSD__) || defined (__GNU__) || defined(__FreeBSD__)
     "/usr/bin/cc",	/* for Linux PostIncDir */
 #endif
     "/usr/local/bin/gcc",
@@ -1207,6 +1207,19 @@
 	if (uname(&name) < 0)
 		LogFatal("Cannot invoke uname", "");
 
+# ifdef __FreeBSD__
+	/* Hack for FreeBSD ports "Cross Version" compiling system. */
+	{
+	  char *e;
+	  if ((e = getenv("OSREL")) != NULL && 
+	      strlen(name.sysname) + strlen(e) + 1 < SYS_NMLN) {
+	    strcpy(name.release, e);
+	    strcpy(name.version, name.sysname);
+	    strcat(name.version, " ");
+	    strcat(name.version, e);
+	  }
+	}
+# endif	    
 # ifdef DEFAULT_OS_NAME
 	parse_utsname(&name, DEFAULT_OS_NAME, buf, 
 		      "Bad DEFAULT_OS_NAME syntax %s");
