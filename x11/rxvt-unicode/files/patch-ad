--- src/command.c.orig	Thu Apr  5 03:52:39 2001
+++ src/command.c	Fri Jun 22 13:36:57 2001
@@ -322,7 +322,7 @@
 	ttydev = tty_name;
 
 # define PTYCHAR1	"pqrstuvwxyz"
-# define PTYCHAR2	"0123456789abcdef"
+# define PTYCHAR2	"0123456789abcdefghijklmnopqrstuv"
 	for (c1 = PTYCHAR1; *c1; c1++) {
 	    ptydev[len] = ttydev[len] = *c1;
 	    for (c2 = PTYCHAR2; *c2; c2++) {
@@ -2376,7 +2376,7 @@
     unsigned char   buf[256];
 
     va_start(arg_ptr, fmt);
-    vsprintf(buf, fmt, arg_ptr);
+    vsnprintf(buf, sizeof(buf), fmt, arg_ptr);
     va_end(arg_ptr);
     tt_write(buf, strlen(buf));
 }
