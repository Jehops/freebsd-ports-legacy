--- configure.in.orig	Tue Feb 29 18:40:50 2000
+++ configure.in	Thu Apr 11 03:33:45 2002
@@ -50,9 +50,10 @@
 AM_CONDITIONAL(INSTALLPAM, test x$enable_pam = xyes)
 
 if test "$enable_pam" = yes; then
-	AC_CHECK_LIB(pam, main, [PASSWDLIB="-lpam -ldl"
+	AC_CHECK_LIB(pam, main, [PASSWDLIB="-lpam"
 		AC_DEFINE_UNQUOTED(HAVE_PAM_LIB)],
-		[],-ldl)
+		[AC_CHECK_LIB(pam, main, [PASSWDLIB="-lpam -ldl"
+		AC_DEFINE_UNQUOTED(HAVE_PAM_LIB)],[],-ldl)])
 fi
 
 AC_ARG_WITH(pamdir,
@@ -66,6 +67,10 @@
     AC_MSG_CHECKING(for pam directory $PAM_DIR_PATH)
     if test -d "$PAM_DIR_PATH"; then
 	AC_MSG_RESULT(exists)
+    elif test -f "/etc/pam.conf"; then
+	AC_MSG_RESULT(using /etc/pam.conf)
+	PAMDIR=none
+	PAM_DIR_PATH=none
     else
 	AC_MSG_RESULT(does not exist)
 	AC_MSG_WARN([this may not be a pam system <<--------------])
@@ -183,7 +188,7 @@
 
 XLFLAGS="$X_LIBS"
 
-XLIBS="$X_EXTRA_LIBS -lXext -lXt -lX11 -lm"
+XLIBS="$X_PRE_LIBS $X_EXTRA_LIBS -lXext -lXt -lX11 -lm"
 
 XDM_EXTRA_LIBS="-lXmu -lXau -lXdmcp"
 
@@ -504,7 +509,7 @@
 AC_DEFINE_UNQUOTED(WDMDIR,"$DMDIR")
 AC_DEFINE_UNQUOTED(DEF_XDM_CONFIG,"$DMDIR/wdm-config")
 AC_DEFINE_UNQUOTED(DEF_CHOOSER,"$DMDIR/chooser")
-AC_DEFINE_UNQUOTED(DEF_AUTH_DIR,"$DMDIR/authdir")
+AC_DEFINE_UNQUOTED(DEF_AUTH_DIR,"$DMDIR")
 
 AC_SUBST(DMDIR)
 
