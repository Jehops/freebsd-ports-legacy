--- Makefile.orig	Sun Nov 12 06:54:45 2000
+++ Makefile	Thu Dec 14 10:50:15 2000
@@ -3,7 +3,7 @@
 #
 
 # Directory where Login.app will be installed
-INSTALL_DIR = /usr/local/GNUstep/Apps/Login.app
+INSTALL_DIR = ${PREFIX}/GNUstep/Apps/Login.app
 
 # Use shadow passwords, comment out to disable
 SHADOW = -DSHADOW_PASSWD
@@ -13,8 +13,10 @@
 
 INSTALL = /usr/bin/install -c
 CC = cc
-CFLAGS += -Wall -pedantic -D_GNU_SOURCE `get-wraster-flags --cflags` $(SHADOW)
-LDFLAGS += `get-wraster-flags --ldflags` `get-wraster-flags --libs` -lXmu -lPropList -lcrypt
+WRASTER_CFLAGS != ${X11BASE}/bin/get-wraster-flags --cflags
+WRASTER_LDFLAGS != ${X11BASE}/bin/get-wraster-flags --ldflags --libs
+CFLAGS += -Wall -pedantic -D_GNU_SOURCE $(WRASTER_CFLAGS) $(SHADOW)
+LDFLAGS += $(WRASTER_LDFLAGS) -lXmu -lPropList -lcrypt
 
 TARGET = Login
 
@@ -61,16 +63,14 @@
 	rm -rf $(TARGET) $(OBJS) core `find -name \*~`
 
 install: $(TARGET)
-	$(INSTALL) -d $(INSTALL_DIR)
-	$(INSTALL) -d $(INSTALL_DIR)/Scripts
-	$(INSTALL) -d $(INSTALL_DIR)/Themes
-	$(INSTALL) -d $(INSTALL_DIR)/Themes/Linux
-	$(INSTALL) -d $(INSTALL_DIR)/Themes/GNUstep
-	$(INSTALL) -s $(TARGET) $(INSTALL_DIR)
-	$(INSTALL) -m 644 Preferences $(INSTALL_DIR)/Preferences
-	$(INSTALL) $(SCRIPTS) $(INSTALL_DIR)/Scripts/
-	$(INSTALL) -m 644 $(THEME_LINUX) $(INSTALL_DIR)/Themes/Linux/
-	$(INSTALL) -m 644 $(THEME_GNUSTEP) $(INSTALL_DIR)/Themes/GNUstep/
+	$(MKDIR) $(INSTALL_DIR)/Scripts
+	$(MKDIR) $(INSTALL_DIR)/Themes/Linux
+	$(MKDIR) $(INSTALL_DIR)/Themes/GNUstep
+	$(BSD_INSTALL_PROGRAM) $(TARGET) $(INSTALL_DIR)
+	$(BSD_INSTALL_DATA) Preferences $(INSTALL_DIR)/Preferences
+	$(BSD_INSTALL_SCRIPT) $(SCRIPTS) $(INSTALL_DIR)/Scripts/
+	$(BSD_INSTALL_DATA) $(THEME_LINUX) $(INSTALL_DIR)/Themes/Linux/
+	$(BSD_INSTALL_DATA) $(THEME_GNUSTEP) $(INSTALL_DIR)/Themes/GNUstep/
 
 uninstall:
 	rm -rf $(INSTALL_DIR)
