--- switchuser.c	2000/12/13 19:53:23	1.1
+++ switchuser.c	2000/12/13 20:23:40
@@ -77,7 +77,7 @@
    char*  correct;
    struct passwd *pw;
 #ifdef SHADOW_PASSWD
-   struct spwd* sp;
+   struct passwd* sp;
 #endif
 
    pw = getpwnam(username);
@@ -87,10 +87,10 @@
    }
 
 #ifdef SHADOW_PASSWD
-   sp = getspnam(pw->pw_name);    
-   endspent();
+   sp = getpwnam(pw->pw_name);    
+   endpwent();
    if(sp) {
-      correct = sp->sp_pwdp;
+      correct = sp->pw_passwd;
    }
    else
 #endif
