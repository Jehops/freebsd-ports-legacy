#!/bin/sh
#
# $FreeBSD$
#

BASH="${PKG_PREFIX-/usr/local}/bin/bash"
RBASH="${PKG_PREFIX-/usr/local}/bin/rbash"
SHELLS="${PKG_DESTDIR-}/etc/shells"

case $2 in
POST-INSTALL)
  if [ -d "${SHELLS%/*}" ] && ! grep -qs "^$BASH\$" "$SHELLS"; then
    if [ `id -u` -eq 0 ]; then
      echo "$BASH" | /usr/bin/sed -e 's|//|/|g' >> "$SHELLS"
    else
      echo "Not root, please add $BASH to $SHELLS manually"
    fi
  fi
  if [ -d "${SHELLS%/*}" ] && ! grep -qs "^$RBASH\$" "$SHELLS"; then
    if [ `id -u` -eq 0 ]; then
      echo "$RBASH" | /usr/bin/sed -e 's|//|/|g' >> "$SHELLS"
    else
      echo "Not root, please add $RBASH to $SHELLS manually"
    fi
  fi
  ;;
esac
