--- Makefile.orig      Wed May 15 18:24:08 2002
+++ Makefile   Wed May 15 18:47:27 2002
@@ -16,12 +16,8 @@
           square.so \
           pulse.so \
           triangle.so
-LD = ld
-CC = cc
-CFLAGS = -Iinclude -Wall -fomit-frame-pointer -fstrength-reduce \
-         -funroll-loops -fmove-all-movables -ffast-math -fPIC -DPIC \
-          -O6 -mcpu=i586 -march=i586 -c
-LDFLAGS = -shared -lm
+CFLAGS += -I/usr/local/include -Iinclude -Wall -DPIC
+LDFLAGS += -L/usr/local/lib -lm -lgnugetopt

 all: $(PLUGINS)

@@ -39,45 +35,45 @@


 sawtooth.so: sawtooth.o avltree.o sawtooth.so.o
-      $(LD) $(LDFLAGS) sawtooth.o avltree.o sawtooth.so.o -o sawtooth.so
+      $(LD) $(LDFLAGS) -shared sawtooth.o avltree.o sawtooth.so.o -o sawtooth.so

 square.so: square.o avltree.o square.so.o
-      $(LD) $(LDFLAGS) square.o avltree.o square.so.o -o square.so
+      $(LD) $(LDFLAGS) -shared square.o avltree.o square.so.o -o square.so

 triangle.so: parabola.o avltree.o triangle.so.o
-      $(LD) $(LDFLAGS) parabola.o avltree.o triangle.so.o -o triangle.so
+      $(LD) $(LDFLAGS) -shared parabola.o avltree.o triangle.so.o -o triangle.so

 pulse.so: sawtooth.o avltree.o pulse.so.o
-      $(LD) $(LDFLAGS) sawtooth.o avltree.o pulse.so.o -o pulse.so
+      $(LD) $(LDFLAGS) -shared sawtooth.o avltree.o pulse.so.o -o pulse.so


 avltree.o: avltree.h common.h avltree.c
-      $(CC) $(CFLAGS) avltree.c
+      $(CC) $(CFLAGS) -c avltree.c

 sawtooth.o: sawtooth_data.h wavedata.h wavedata.c
-      $(CC) $(CFLAGS) -DWAVETYPE_SAWTOOTH wavedata.c
+      $(CC) $(CFLAGS) -DWAVETYPE_SAWTOOTH -c wavedata.c
       mv wavedata.o sawtooth.o

 square.o: square_data.h wavedata.h wavedata.c
-      $(CC) $(CFLAGS) -DWAVETYPE_SQUARE wavedata.c
+      $(CC) $(CFLAGS) -DWAVETYPE_SQUARE -c wavedata.c
       mv wavedata.o square.o

 parabola.o: parabola_data.h wavedata.h wavedata.c
-      $(CC) $(CFLAGS) -DWAVETYPE_PARABOLA wavedata.c
+      $(CC) $(CFLAGS) -DWAVETYPE_PARABOLA -c wavedata.c
       mv wavedata.o parabola.o


 sawtooth.so.o: ladspa.h avltree.h wavedata.h sawtooth.so.c
-      $(CC) $(CFLAGS) sawtooth.so.c
+      $(CC) $(CFLAGS) -c sawtooth.so.c

 square.so.o: ladspa.h avltree.h wavedata.h square.so.c
-      $(CC) $(CFLAGS) square.so.c
+      $(CC) $(CFLAGS) -c square.so.c

 triangle.so.o: ladspa.h avltree.h wavedata.h triangle.so.c
-      $(CC) $(CFLAGS) triangle.so.c
+      $(CC) $(CFLAGS) -c triangle.so.c

 pulse.so.o: ladspa.h avltree.h wavedata.h pulse.so.c
-      $(CC) $(CFLAGS) pulse.so.c
+      $(CC) $(CFLAGS) -c pulse.so.c


 sawtooth_data.h: wavegen
@@ -91,4 +87,4 @@


 wavegen: wdatutil.h wdatutil.c wavegen.c
-      $(CC) -Iinclude wdatutil.c wavegen.c -lm -o wavegen
+      $(CC) ${CFLAGS} ${LDFLAGS} wdatutil.c wavegen.c -o wavegen
