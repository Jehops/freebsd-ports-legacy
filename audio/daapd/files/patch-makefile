--- ./makefile.orig	Sun Mar  5 14:39:37 2006
+++ ./makefile	Thu Jul 20 14:04:28 2006
@@ -1,21 +1,18 @@
 # configure daapd here
 
-HOWL_ENABLE = 1
 ZLIB_ENABLE = 1
-MPEG4_ENABLE = 0
 
 
 # no need to touch anything below this line
 # -----------------------------------------
 
-CC = g++
+CC = ${CXX}
 MAKE = $(MAKE_COMMAND)
 TARGET = daapd
-DEPS = daaplib_ libhttpd_
 OBJS = daapd.o db.o dboutput.o songcache.o parsemp3.o util.o
 LIBS = -ldaaplib -lhttpd-persistent -lid3tag -lz
-LIBPATH = -L. -L./daaplib/src -L./libhttpd/src  -L/usr/local/lib
-INCPATH = -I. -I./daaplib/include -I./libhttpd/src  -I/usr/local/include
+LIBPATH = -L. -L%%LOCALBASE%%/lib
+INCPATH = -I. -I%%LOCALBASE%%/include
-DEPLOY = /usr/local
+DEPLOY = %%PREFIX%%
 CFLAGS = -Wall -Wno-multichar
 
@@ -60,28 +57,17 @@
 .cc.o:
 	$(CC) $(CFLAGS) $(INCPATH) -c $<
 
-all: $(DEPS) $(TARGET)
+all: $(TARGET)
 
 $(TARGET): $(OBJS)
 	$(CC) $(CFLAGS) $(LIBPATH) -o $(TARGET) $(OBJS) $(LIBS)
 
 $(OBJS): types.h dboutput.h songcache.h parsemp3.h
 
-daaplib_:
-	cd daaplib/src && $(MAKE)
-
-libhttpd_:
-	if test ! -e libhttpd/Site.mm; then cd libhttpd && ./configure; fi
-	cd libhttpd && $(MAKE)
-
 clean:
-	if test -e libhttpd/Site.mm; then cd libhttpd && $(MAKE) very-clean; fi
-	cd daaplib/src && $(MAKE) clean
 	rm $(OBJS) $(TARGET)
 
-install: $(DEPS) $(TARGET)
-	cd libhttpd && $(MAKE) install
-	cd daaplib/src && $(MAKE) install
-	cp $(TARGET) $(DEPLOY)/bin
-	chmod a+rx $(DEPLOY)/bin/$(TARGET)
+install: $(TARGET)
+	cp $(TARGET) $(DEPLOY)/sbin
+	chmod a+rx $(DEPLOY)/sbin/$(TARGET)
 	cp $(TARGET).8 $(DEPLOY)/man/man8
