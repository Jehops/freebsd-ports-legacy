#!/bin/sh

# $FreeBSD$

# PROVIDE: ventrilo
# REQUIRE: NETWORKING
# KEYWORD: shutdown

[ -z "${ventrilo_enable}" ] && ventrilo_enable="NO"
[ -z "${ventrilo_port}" ] && ventrilo_port="3784"
[ -z "${ventrilo_srv}" ] && ventrilo_srv="localhost"

. %%RC_SUBR%%

prefix=%%PREFIX%%

name=ventrilo
homedir="${prefix}/ventrilo-server"
pidfile="${homedir}/ventrilo_srv.pid"
ventrilo_user=${name}
command="${homedir}/ventrilo_srv"
command_args="'-f${homedir}/ventrilo_srv' -d >/dev/null"
extra_commands="info"
info_cmd="ventrilo_info"

rcvar=`set_rcvar`

load_rc_config $name

ventrilo_info()
{
	if [ "$1" != "" ]; then
		ventrilo_srv="$1"
	fi
	if [ "$2" != "" ]; then
		ventrilo_port="$2"
	fi
	echo -n "Password []: "
	oldttymodes=`stty -g`
	stty -echo
	read ventrilo_passwd
	stty $oldttymodes
	${homedir}/ventrilo_status -c2 "-t${ventrilo_srv}:${ventrilo_port}:${ventrilo_passwd}"
}

run_rc_command $*
