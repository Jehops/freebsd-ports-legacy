--- configure.orig	Sun May 16 03:59:17 2004
+++ configure	Tue Jun 14 18:53:43 2005
@@ -9690,9 +9690,9 @@
 
 have_solaris=no
 arch_type=ix86
-SSE_RES=`cat /proc/cpuinfo|grep sse`
-SSE2_RES=`cat /proc/cpuinfo|grep sse2`
-MMX_RES=`cat /proc/cpuinfo|grep mmx`
+SSE_RES=`grep 'Features=.*[<,]SSE[>,]' /var/run/dmesg.boot`
+SSE2_RES=`grep 'Features=.*[<,]SSE2[>,]' /var/run/dmesg.boot`
+MMX_RES=`grep 'Features=.*[<,]MMX[>,]' /var/run/dmesg.boot`
 ARCH_DEFINES=""
 
 if test "x$mmx" = xyes; then
@@ -9708,27 +9708,6 @@
 if test "x$debug" = xno; then
     case "$host" in
         i386-*-* | i86pc-*-*)
-        ;;
-	    i486-*-*)
-            ARCH_DEFINES="-march=i486"
-	    ;;
-	    i586-*-*)
-            ARCH_DEFINES="-march=i586"
-		    if test "x$benchmark" = xyes; then
-			    XF_CFLAGS="$XF_CFLAGS -DBENCHMARK"
-		    fi
-            if test "x$autodetect" = xyes; then
-                if test "x$MMX_RES" != x; then
-                    mmx=yes
-                fi
-            fi
-		    if test "x$mmx" = xyes; then
-                autodetect=no
-                ARCH_DEFINES="$ARCH_DEFINES -m3dnow -mmmx"
-            fi
-	    ;;
-	    i686-*-*)
-            ARCH_DEFINES="-march=i686"
 		    if test "x$benchmark" = xyes; then
 			    XF_CFLAGS="$XF_CFLAGS -DBENCHMARK"
 		    fi
@@ -9775,6 +9754,9 @@
             ARCH_DEFINES_DEFAULT="-O3"
             have_solaris=yes
         ;;
+	*)
+	    arch_type="unknown"
+	;;
     esac
 fi
 
