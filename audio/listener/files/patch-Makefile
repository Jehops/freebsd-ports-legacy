--- Makefile.old	Wed Jan 19 09:19:02 2005
+++ Makefile	Wed Jan 19 09:21:43 2005
@@ -1,8 +1,8 @@
 VERSION=0.8
 
-INSTALL_PREFIX=/usr/local
+INSTALL_PREFIX=${PREFIX}
 
-CFLAGS=-O2 -Wall -DVERSION=\"$(VERSION)\"
+CFLAGS+=-L${LOCALBASE}/lib -I${LOCALBASE}/include -Wall -DVERSION=\"$(VERSION)\"
 
 OBJSsl=sl.o snd_dev.o error.o utils.o
 OBJSli=listener.o snd_dev.o error.o utils.o lib.o
@@ -11,10 +11,10 @@
 all: setlistener listener listenersoundpipe
 
 setlistener: $(OBJSsl)
-	$(CC) -g -Wall -W $(OBJSsl) -ldl -lncurses -o setlistener
+	$(CC) $(CFLAGS) -g -Wall -W $(OBJSsl) -lncurses -o setlistener
 
 listener: $(OBJSli)
-	$(CC) -g -Wall -W $(OBJSli) -ldl -lsndfile -o listener -DCONFIGFILE=$(INSTALL_PREFIX)/etc/listener.conf
+	$(CC) $(CFLAGS) -g -Wall -W $(OBJSli) -lsndfile -o listener -DCONFIGFILE=$(INSTALL_PREFIX)/etc/listener.conf
 
 listenersoundpipe: $(OBJSsp)
 	$(CC) -g -Wall -W $(OBJSsp) -o listenersoundpipe
@@ -23,7 +23,7 @@
 	cp setlistener $(INSTALL_PREFIX)/bin
 	cp listenersoundpipe $(INSTALL_PREFIX)/bin
 	cp listener $(INSTALL_PREFIX)/bin
-	cp listener.conf $(INSTALL_PREFIX)/etc/
+	cp listener.conf $(INSTALL_PREFIX)/etc/listener.conf.sample
 
 uninstall: clean
 	rm -f $(INSTALL_PREFIX)/bin/setlistener
