--- Makefile.orig	Fri Dec 24 07:40:45 2004
+++ Makefile	Thu Jan 13 17:50:56 2005
@@ -232,8 +232,8 @@
 #
 # Compiler configuration
 #
-CC=gcc
-CXX=g++
+CC?=gcc
+CXX?=g++
 
 ifdef MORPHOS
 CC += -noixemul -pipe
@@ -274,7 +274,7 @@
 BUILDDATE=`date +%d.%m.%y`
 
 # AMD64 needs a little more settings to work
-ifeq ($(shell uname -m), x86_64)
+ifeq ($(shell uname -m), amd64)
 endwarnings:=endwarnings
 64_bit_warnings:=64_bit_warnings
 BASECFLAGS += -m64
@@ -371,11 +371,11 @@
 # SDL config
 ifdef WITH_SDL
 CDEFS += -DWITH_SDL
-CFLAGS += `$(SDL-CONFIG) --cflags`
+CFLAGS += $(shell $(SDL-CONFIG) --cflags)
 ifdef STATIC
-LIBS += `$(SDL-CONFIG) --static-libs`
+LIBS += $(shell $(SDL-CONFIG) --static-libs)
 else
-LIBS += `$(SDL-CONFIG) --libs`
+LIBS += $(shell $(SDL-CONFIG) --libs)
 endif
 endif
 
@@ -420,7 +420,8 @@
 CDEFS += -DWITH_PNG
 # FreeBSD doesn't use libpng-config
 ifdef FREEBSD
-LIBS += -lpng
+LIBS += -lpng -L$(PREFIX)/lib
+CFLAGS += -I$(PREFIX)/include/libpng
 else
 CFLAGS += `libpng-config --cflags`
 
