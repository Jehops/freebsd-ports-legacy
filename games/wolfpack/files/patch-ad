--- src/doconfig/doconfig.c.orig	Thu Jun 19 03:24:48 2003
+++ src/doconfig/doconfig.c	Wed Oct 22 16:02:33 2003
@@ -90,12 +90,18 @@
 #endif
 
 int
-main()
+main(int argc, char **argv)
 {
     char buf[256];
     char *cp;
 	char *pathname;
 
+    if (argc != 2) {
+               printf("Bad usage");
+               exit(-1);
+    }
+
+
     if ((pathname = getcwd(NULL, 255)) == NULL) {
 		printf("Can't get current path!\n");
 		exit(-1);
@@ -112,30 +118,16 @@
     cp = (char *)rindex(pathname, '\\');
     *cp = '\0';
 #endif
+    if (!strcasecmp(argv[1], "config")) {
     printf("Configuring...\n");
     wrmakesrc(pathname);
     sprintf(buf, "%s/include/gamesdef.h", pathname);
     wrgamesdef(buf);
     sprintf(buf, "%s/src/client/ipglob.c", pathname);
     wripglob(buf);
-
-    if (access(EP, 0)) {
-		printf("making directory %s\n", EP);
-		if (mkdir(EP, 493)) {
-			printf("mkdir failed on %s, exiting.\n", EP);
-			exit(-1);
-		}
-    }
-    sprintf(buf, "%s/data", EP);
-    if (access(buf, 0)) {
-		printf("making directory %s\n", buf);
-		if (mkdir(buf, 493)) {
-			printf("mkdir failed on %s, exiting.\n", buf);
-			exit(-1);
-		}
-    }
-    sprintf(buf, "%s/data/auth", EP);
+    sprintf(buf, "%s/data/auth", pathname);
     wrauth(buf);
+    }
     exit(0);
 }
 
