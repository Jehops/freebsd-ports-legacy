--- Makefile.orig	Sat Jan 20 15:02:46 1996
+++ Makefile	Sun Sep 27 03:06:34 1998
@@ -12,33 +12,30 @@
 # for conditions under which this file may be redistributed.
 #
 
-CC=gcc
-CFLAGS=-O2
-
-INCLUDES=
+#CC=gcc
+CFLAGS+= -I${X11BASE}/include -DX11BASE=\"${X11BASE}\"
 
 LIB=
 
-XLIB=-L/usr/X11R6/lib -lXaw -lXmu -lXt -lX11
-
-COMPILE=$(CC) -c $(CFLAGS)
+XLIB=-L${X11BASE}/lib -lXaw -lXmu -lXt -lX11 -lcompat
+.if ${PORTOBJFORMAT} == "elf"
+XLIB+=	-Wl,-rpath,${X11BASE}/lib
+.endif
 
 LINK=$(CC)
 
 OBJ=xbomb.o xwindow.o hiscore.o
 
-INSTDIR=/usr/local
+INSTDIR=${PREFIX}
 
 ########
+all: xbomb
 
 xbomb : $(OBJ)
 	$(LINK) $(OBJ) -o $@ $(LIB) $(XLIB)
 
 ########
 
-%.o : %.c
-	$(COMPILE) $< -o $@ $(INCLUDES)
-
 xbomb.o   : xbomb.c   xbomb.h
 xwindow.o : xwindow.c xbomb.h icon.h
 hiscore.o : hiscore.c xbomb.h
@@ -54,7 +51,7 @@
 	strip xbomb
 	install -d $(INSTDIR)/bin
 	install -d $(INSTDIR)/man/man6
-	install -d $(INSTDIR)/lib/app-defaults
-	install -m 755 xbomb $(INSTDIR)/bin
-	install -m 644 xbomb.6 $(INSTDIR)/man/man6
-	install -m 644 xbomb.ad $(INSTDIR)/lib/app-defaults/XBomb
+	install -d $(INSTDIR)/lib/X11/app-defaults
+	${BSD_INSTALL_PROGRAM} xbomb $(INSTDIR)/bin
+	${BSD_INSTALL_MAN} xbomb.6 $(INSTDIR)/man/man6
+	${BSD_INSTALL_SCRIPT} xbomb.ad $(INSTDIR)/lib/X11/app-defaults/XBomb
