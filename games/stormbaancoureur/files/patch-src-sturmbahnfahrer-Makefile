--- src-sturmbahnfahrer/Makefile.orig	Thu May 17 20:02:03 2007
+++ src-sturmbahnfahrer/Makefile	Thu Aug  9 02:28:39 2007
@@ -6,19 +6,17 @@
 
 PLIBPREFIX=$(HOME)
 ODEPREFIX=$(HOME)
-CXX=g++
+CXX?=g++
 
 # END OF CUSTOM SETTINGS
 
 CXXFLAGS=\
-  -I$(ODEPREFIX)/include \
-  -I$(PLIBPREFIX)/include \
+  -I$(LOCALBASE)/include \
   -I../src-common \
-  -O2 -g -Wall
+  -g -Wall
 
 LFLAGS=\
-  -L$(PLIBPREFIX)/lib \
-  -L/usr/X11R6/lib
+  -L$(LOCALBASE)/lib
 
 
 OBJS=\
@@ -37,9 +35,9 @@
 
 
 LIBS=\
-  $(ODEPREFIX)/lib/libode.a \
+  $(LOCALBASE)/lib/libode.a \
   -lplibssgaux -lplibssg -lplibsg -lplibpu -lplibfnt -lplibul \
-  -lglut -lGLU -lGL -lasound
+  -lglut -lGLU -lGL
 
 
 all: sturmbahnfahrer
@@ -94,44 +92,43 @@
 GAMEDIR=$(DESTDIR)/usr/share/games/sturmbahnfahrer
 install: sturmbahnfahrer
 	# Directories
-	mkdir -p $(DESTDIR)/usr/games/
-	mkdir -p $(GAMEDIR)/images/
-	mkdir -p $(GAMEDIR)/sounds/
-	mkdir -p $(GAMEDIR)/models/
+	mkdir -p $(DATADIR)/images/
+	mkdir -p $(DATADIR)/sounds/
+	mkdir -p $(DATADIR)/models/
 	# Binary
-	install sturmbahnfahrer $(DESTDIR)/usr/games/sturmbahnfahrer
+	${BSD_INSTALL_PROGRAM} sturmbahnfahrer $(PREFIX)/bin/sturmbahnfahrer
 	# Images
-	install -m 644 images/engine.tga $(GAMEDIR)/images/engine.tga
-	install -m 644 images/info_carpet_smooth.rgb $(GAMEDIR)/images/info_carpet_smooth.rgb
-	install -m 644 images/info_door_smooth.rgb $(GAMEDIR)/images/info_door_smooth.rgb
-	install -m 644 images/info_jump_smooth.rgb $(GAMEDIR)/images/info_jump_smooth.rgb
+	${BSD_INSTALL_DATA} -m 644 images/engine.tga $(DATADIR)/images/engine.tga
+	${BSD_INSTALL_DATA} -m 644 images/info_carpet_smooth.rgb $(DATADIR)/images/info_carpet_smooth.rgb
+	${BSD_INSTALL_DATA} -m 644 images/info_door_smooth.rgb $(DATADIR)/images/info_door_smooth.rgb
+	${BSD_INSTALL_DATA} -m 644 images/info_jump_smooth.rgb $(DATADIR)/images/info_jump_smooth.rgb
 	# Sounds
-	install -m 644 sounds/rpm_graph.txt $(GAMEDIR)/sounds/rpm_graph.txt
-	install -m 644 sounds/camaro_s16_le.wav $(GAMEDIR)/sounds/camaro_s16_le.wav
-	install -m 644 sounds/detonationnorm_s16_le.wav $(GAMEDIR)/sounds/detonationnorm_s16_le.wav
+	${BSD_INSTALL_DATA} -m 644 sounds/rpm_graph.txt $(DATADIR)/sounds/rpm_graph.txt
+	${BSD_INSTALL_DATA} -m 644 sounds/camaro_s16_le.wav $(DATADIR)/sounds/camaro_s16_le.wav
+	${BSD_INSTALL_DATA} -m 644 sounds/detonationnorm_s16_le.wav $(DATADIR)/sounds/detonationnorm_s16_le.wav
 	# Models
-	install -m 644 models/baseplate.3ds $(GAMEDIR)/models/baseplate.3ds
-	install -m 644 models/car.3ds $(GAMEDIR)/models/car.3ds
-	install -m 644 models/carpet.3ds $(GAMEDIR)/models/carpet.3ds
-	install -m 644 models/crate.3ds $(GAMEDIR)/models/crate.3ds
-	install -m 644 models/cratejump.3ds $(GAMEDIR)/models/cratejump.3ds
-	install -m 644 models/crate_low.3ds $(GAMEDIR)/models/crate_low.3ds
-	install -m 644 models/door.3ds $(GAMEDIR)/models/door.3ds
-	install -m 644 models/doorstand.3ds $(GAMEDIR)/models/doorstand.3ds
-	install -m 644 models/ferriswheelcart.3ds $(GAMEDIR)/models/ferriswheelcart.3ds
-	install -m 644 models/ferriswheelstand.3ds $(GAMEDIR)/models/ferriswheelstand.3ds
-	install -m 644 models/ferriswheelwheel.3ds $(GAMEDIR)/models/ferriswheelwheel.3ds
-	install -m 644 models/finishdoor.3ds $(GAMEDIR)/models/finishdoor.3ds
-	install -m 644 models/finishplank.3ds $(GAMEDIR)/models/finishplank.3ds
-	install -m 644 models/grid.3ds $(GAMEDIR)/models/grid.3ds
-	install -m 644 models/jumpboard.3ds $(GAMEDIR)/models/jumpboard.3ds
-	install -m 644 models/licplate.ac $(GAMEDIR)/models/licplate.ac
-	install -m 644 models/licplate.bmp $(GAMEDIR)/models/licplate.bmp
-	install -m 644 models/ramp.3ds $(GAMEDIR)/models/ramp.3ds
-	install -m 644 models/spikegate.3ds $(GAMEDIR)/models/spikegate.3ds
-	install -m 644 models/track.3ds $(GAMEDIR)/models/track.3ds
-	install -m 644 models/truck.3ds $(GAMEDIR)/models/truck.3ds
-	install -m 644 models/wheel.3ds $(GAMEDIR)/models/wheel.3ds
+	${BSD_INSTALL_DATA} -m 644 models/baseplate.3ds $(DATADIR)/models/baseplate.3ds
+	${BSD_INSTALL_DATA} -m 644 models/car.3ds $(DATADIR)/models/car.3ds
+	${BSD_INSTALL_DATA} -m 644 models/carpet.3ds $(DATADIR)/models/carpet.3ds
+	${BSD_INSTALL_DATA} -m 644 models/crate.3ds $(DATADIR)/models/crate.3ds
+	${BSD_INSTALL_DATA} -m 644 models/cratejump.3ds $(DATADIR)/models/cratejump.3ds
+	${BSD_INSTALL_DATA} -m 644 models/crate_low.3ds $(DATADIR)/models/crate_low.3ds
+	${BSD_INSTALL_DATA} -m 644 models/door.3ds $(DATADIR)/models/door.3ds
+	${BSD_INSTALL_DATA} -m 644 models/doorstand.3ds $(DATADIR)/models/doorstand.3ds
+	${BSD_INSTALL_DATA} -m 644 models/ferriswheelcart.3ds $(DATADIR)/models/ferriswheelcart.3ds
+	${BSD_INSTALL_DATA} -m 644 models/ferriswheelstand.3ds $(DATADIR)/models/ferriswheelstand.3ds
+	${BSD_INSTALL_DATA} -m 644 models/ferriswheelwheel.3ds $(DATADIR)/models/ferriswheelwheel.3ds
+	${BSD_INSTALL_DATA} -m 644 models/finishdoor.3ds $(DATADIR)/models/finishdoor.3ds
+	${BSD_INSTALL_DATA} -m 644 models/finishplank.3ds $(DATADIR)/models/finishplank.3ds
+	${BSD_INSTALL_DATA} -m 644 models/grid.3ds $(DATADIR)/models/grid.3ds
+	${BSD_INSTALL_DATA} -m 644 models/jumpboard.3ds $(DATADIR)/models/jumpboard.3ds
+	${BSD_INSTALL_DATA} -m 644 models/licplate.ac $(DATADIR)/models/licplate.ac
+	${BSD_INSTALL_DATA} -m 644 models/licplate.bmp $(DATADIR)/models/licplate.bmp
+	${BSD_INSTALL_DATA} -m 644 models/ramp.3ds $(DATADIR)/models/ramp.3ds
+	${BSD_INSTALL_DATA} -m 644 models/spikegate.3ds $(DATADIR)/models/spikegate.3ds
+	${BSD_INSTALL_DATA} -m 644 models/track.3ds $(DATADIR)/models/track.3ds
+	${BSD_INSTALL_DATA} -m 644 models/truck.3ds $(DATADIR)/models/truck.3ds
+	${BSD_INSTALL_DATA} -m 644 models/wheel.3ds $(DATADIR)/models/wheel.3ds
 
 
 deb:
