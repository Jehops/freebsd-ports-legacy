
$FreeBSD$

--- fbsd_vid.c.orig	Mon Apr  3 23:42:44 2000
+++ fbsd_vid.c	Sat Sep 22 22:18:25 2001
@@ -1,4 +1,18 @@
-#include <machine/console.h>
+/*
+ * ---------------------------------------------------------------------------
+ * "THE BEER-WARE LICENSE" (Revision 42, (c) Poul-Henning Kamp): Maxim
+ * Sobolev <sobomax@altavista.net> wrote this file. As long as you retain
+ * this  notice you can  do whatever you  want with this stuff. If we meet
+ * some day, and you think this stuff is worth it, you can buy me a beer in
+ * return.
+ *
+ * Maxim Sobolev
+ * ---------------------------------------------------------------------------
+ */
+
+#include <sys/fbio.h>
+#include <sys/kbio.h>
+#include <sys/consio.h>
 #include <vgl.h>
 #include <signal.h>
 #include <osreldate.h>
@@ -272,6 +286,8 @@
     Sint4           w = 3, h = 12, size;
     Sint4           i;
 
+    if(((ch - 32) >= 0x5f) || (ch < 32))
+	return;
     tmp = ch2bmap(alphas[ch - 32], w, h);
     size = tmp->Xsize * tmp->Ysize;
     copy = malloc(size);
