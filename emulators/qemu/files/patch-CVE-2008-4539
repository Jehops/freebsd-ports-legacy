Index: qemu/hw/cirrus_vga.c
===================================================================
--- trunk/hw/cirrus_vga.c	2008-11-01 00:53:30 UTC (rev 5586)
+++ trunk/hw/cirrus_vga.c	2008-11-01 00:53:39 UTC (rev 5587)
@@ -785,15 +785,14 @@
 
 static int cirrus_bitblt_videotovideo_copy(CirrusVGAState * s)
 {
+    if (BLTUNSAFE(s))
+        return 0;
+
     if (s->ds->dpy_copy) {
 	cirrus_do_copy(s, s->cirrus_blt_dstaddr - s->start_addr,
 		       s->cirrus_blt_srcaddr - s->start_addr,
 		       s->cirrus_blt_width, s->cirrus_blt_height);
     } else {
-
-    if (BLTUNSAFE(s))
-        return 0;
-
 	(*s->cirrus_rop) (s, s->vram_ptr +
                 (s->cirrus_blt_dstaddr & s->cirrus_addr_mask),
 			  s->vram_ptr +




