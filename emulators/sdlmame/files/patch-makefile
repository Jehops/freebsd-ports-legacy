--- makefile.orig	Sat Oct 20 16:33:18 2007
+++ makefile	Wed Nov  7 18:22:11 2007
@@ -72,11 +72,13 @@
 # uncomment next line to include the internal profiler
 # PROFILER = 1
 
+ifeq ($(ARCH),i386)
 # uncomment next line to use DRC MIPS3 engine
 X86_MIPS3_DRC = 1
 
 # uncomment next line to use DRC PowerPC engine
 X86_PPC_DRC = 1
+endif
 
 # uncomment next line to use DRC Voodoo rasterizers
 # X86_VOODOO_DRC = 1
@@ -99,7 +101,9 @@
 # CELL = 1
 
 # uncomment next line if you are building for a 64-bit target
-# PTR64 = 1
+ifeq ($(ARCH),amd64)
+PTR64 = 1
+endif
 
 # uncomment next line to build expat as part of MAME build
 BUILD_EXPAT = 1
@@ -168,8 +172,8 @@
 
 # compiler, linker and utilities
 AR = @ar
-CC = @gcc
-LD = @gcc
+CC := @$(CC)
+LD = @$(CC)
 MD = -mkdir$(EXE)
 RM = @rm -f
 
@@ -248,7 +252,7 @@
 endif
 
 # fullname is prefix+name+suffix
-FULLNAME = $(PREFIX)$(NAME)$(SUFFIX)
+FULLNAME = $(NAME)
 
 # add an EXE suffix to get the final emulator name
 EMULATOR = $(FULLNAME)$(EXE)
@@ -318,7 +322,7 @@
 #-------------------------------------------------
 
 # we compile to C89 standard with GNU extensions
-CFLAGS = -std=gnu89
+CFLAGS += -std=gnu89
 
 # add -g if we need symbols
 ifdef SYMBOLS
@@ -352,11 +356,11 @@
 # if we are optimizing, include optimization options
 # and make all errors into warnings
 ifneq ($(OPTIMIZE),0)
-CFLAGS += $(ARCH) -fno-strict-aliasing
+CFLAGS += -fno-strict-aliasing
 
 # only -Werror if not PTR64 and not DEBUG
 ifndef DEBUG
-CFLAGS += $(ARCH) -fno-strict-aliasing
+CFLAGS += -fno-strict-aliasing
 endif	# !DEBUG
 endif	# neq OPTIMIZE
 
@@ -376,6 +380,7 @@
 	-I$(SRC)/lib/util \
 	-I$(SRC)/osd \
 	-I$(SRC)/osd/$(OSD) \
+	-I$(LOCALBASE)/include
 
 
 
@@ -385,7 +390,7 @@
 
 # LDFLAGS are used generally; LDFLAGSEMULATOR are additional
 # flags only used when linking the core emulator
-LDFLAGS = 
+LDFLAGS += -L$(LOCALBASE)/lib
 LDFLAGSEMULATOR =
 
 # add profiling information for the linker
