--- vmblock-fuse/Makefile.am.orig	2009-02-18 17:00:54.000000000 +0900
+++ vmblock-fuse/Makefile.am	2009-03-01 16:41:24.000000000 +0900
@@ -17,13 +17,13 @@
 
 bin_PROGRAMS = vmware-vmblock-fuse
 
-# _XOPEN_SOURCE needs to be defined to at least 500 when compiling
-# vmblock-fuse's os.h to get pthread_rwlock_t.
+# _XOPEN_SOURCE needs to be defined to at least 600 when compiling
+# vmblock-fuse's fsops.c to get lstat.
 # -D_FILE_OFFSET_BITS=64 required for fuse.
 
 AM_CFLAGS =
 AM_CFLAGS += -Dvmblock_fuse
-AM_CFLAGS += -D_XOPEN_SOURCE=500
+AM_CFLAGS += -D_XOPEN_SOURCE=600
 AM_CFLAGS += -DUSERLEVEL
 AM_CFLAGS += -D_FILE_OFFSET_BITS=64
 AM_CFLAGS += @FUSE_CPPFLAGS@
--- vmblock-fuse/Makefile.in.orig	2009-02-18 17:03:18.000000000 +0900
+++ vmblock-fuse/Makefile.in	2009-03-01 16:50:47.000000000 +0900
@@ -263,10 +263,10 @@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 
-# _XOPEN_SOURCE needs to be defined to at least 500 when compiling
-# vmblock-fuse's os.h to get pthread_rwlock_t.
+# _XOPEN_SOURCE needs to be defined to at least 600 when compiling
+# vmblock-fuse's fsops.c to get lstat.
 # -D_FILE_OFFSET_BITS=64 required for fuse.
-AM_CFLAGS = -Dvmblock_fuse -D_XOPEN_SOURCE=500 -DUSERLEVEL \
+AM_CFLAGS = -Dvmblock_fuse -D_XOPEN_SOURCE=600 -DUSERLEVEL \
 	-D_FILE_OFFSET_BITS=64 @FUSE_CPPFLAGS@ @VMWARE_USER_CPPFLAGS@
 vmware_vmblock_fuse_LDADD = ../lib/misc/libMisc.la @FUSE_LIBS@ \
 	$(am__append_1)
