--- Makefile.orig	Mon Oct  2 03:36:11 2000
+++ Makefile	Sun Nov 19 01:59:35 2000
@@ -3,7 +3,6 @@
 #SPC700ASM=1
 NETPLAY=1
 UNZIP=1
-GLIDE=1
 #GUI=1
 THREAD_SOUND=1
 
@@ -60,11 +59,6 @@
 UNZIPDEFINES=-DUNZIP_SUPPORT
 endif
 
-ifdef THREAD_SOUND
-CPUDEFINES += -DUSE_THREADS
-EXTRALIBS += -lpthread
-endif
-
 ifdef GLIDE
 GLIDEOBJS = unix/glide.o
 GLIDEDEFINES = -DUSE_GLIDE -I/usr/include/glide
@@ -77,28 +71,26 @@
 endif
 
 MOC = $(QTDIR)/bin/moc
-CCC = g++ -fno-rtti
+CCC = $(CXX) -fno-rtti
 CC = gcc
 NASM = nasm
 
-INCLUDES=-I/usr/X11R6/include -I/usr/local/include
-
-OPTIMISE=-O6 -mpentium -fno-exceptions -Wall -W -pedantic -pipe -fomit-frame-pointer 
+INCLUDES= -I$(X11BASE)/include -I$(LOCALBASE)/include
 
 #OPTIMISE=-g -fno-exceptions
 #-DMITSHM 
 
-CCFLAGS = $(OPTIMISE) -DMITSHM \
+CCFLAGS = -fomit-frame-pointer -DMITSHM \
 -Ii386 \
 -I. \
 -Iunzip \
--DJOYSTICK_SUPPORT \
 -DZLIB \
 -DNO_INLINE_SET_GET \
 -DVAR_CYCLES \
 -DDEBUGGER \
 -DCPU_SHUTDOWN \
 -DSPC700_SHUTDOWN \
+-DSOUND \
 $(LINUXDEFINES) \
 $(FXDEFINES) \
 $(CPUDEFINES) \
@@ -108,6 +100,11 @@
 $(GLIDEDEFINES) \
 $(GUIDEFINES)
 
+ifdef USB_JOYSTICK_SUPPORT
+CCFLAGS += -DJOYSTICK_SUPPORT
+EXTRALIBS += -lusb
+endif
+
 #-DSOUND
 #-DDEBUGGER
 #-DNO_INLINE_SET_GET
@@ -115,12 +112,12 @@
 #-DCPU_SHUTDOWN
 #-DSPC700_SHUTDOWN
 
-CFLAGS=$(CCFLAGS)
+CFLAGS+=$(CCFLAGS)
 
 .SUFFIXES: .o .cpp .c .cc .h .m .i .S .asm
-LDLIBS = -L/usr/X11R6/lib frame.o
+LDLIBS = -L$(X11BASE)/lib
 
-all: offsets snes9x ssnes9x
+all: offsets snes9x
 
 #ggisnes9x
 #xf86snes9x
