--- vmmon-only/freebsd/driver.c.orig Sat Apr 10 16:52:28 2004
+++ vmmon-only/freebsd/driver.c Sat Apr 10 16:54:39 2004
@@ -73,6 +73,24 @@
 #include "private.h"
 #endif
 
+#if __FreeBSD_version >= 500013
+enum intr_type {
+    INTR_TYPE_TTY = 1,
+    INTR_TYPE_BIO = 2,
+    INTR_TYPE_NET = 4,
+    INTR_TYPE_CAM = 8,
+    INTR_TYPE_MISC = 16,
+    INTR_HEAVY = 32,			/* heavyweight interrupt process */
+    INTR_LIGHT = 64,			/* light weight interrupt thread */
+    INTR_THREADED = INTR_LIGHT | INTR_HEAVY, /* any kind of interrupt thread */
+    INTR_FAST = 128,
+    INTR_EXCL =	256,			/* exclusive interrupt */
+    INTR_MPSAFE = 512			/* this interrupt is SMP safe */
+};
+
+typedef void driver_intr_t(void*);
+#endif
+
 #ifdef SUPPORT_PASSTHROUGH
 #include "passthrough.h"	// _driver_ version of passthrough.h 
 #endif
@@ -256,7 +274,9 @@
 
 #include <machine/md_var.h>
 #include <machine/segments.h>
+#if __FreeBSD_version < 501114
 #include <i386/isa/intr_machep.h>
+#endif
 
 static int
 vmmon_modeevent(module_t mod, int cmd, void *arg)
