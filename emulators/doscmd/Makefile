# $FreeBSD$

PORTNAME=	doscmd
PORTVERSION=	20110826
CATEGORIES=	emulators
MASTER_SITES=	SF/${PORTNAME}

MAINTAINER=	ports@FreeBSD.org
COMMENT=	DOS emulator

ONLY_FOR_ARCHS=	i386

FONTFILES=	cp437-8x8.pcf.gz cp437-8x14.pcf.gz cp437-8x16.pcf.gz
PORTDOCS=	PROBLEMS README*

OPTIONS_DEFINE=	X11
OPTIONS_DEFAULT=	X11
OPTIONS_SUB=	yes

X11_USE=	XORG=x11
X11_MAKE_ARGS=	X11BASE=${LOCALBASE}
X11_MAKE_ARGS_OFF=	-DNO_X

.include <bsd.port.options.mk>

.if ${OPSYS} == FreeBSD && ${OSVERSION} >= 1000012
# files/extra-patch-cwd.c will fix this, see inside
BROKEN=		does not build (accesses field of opaque structure)
.endif

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/${PORTNAME} ${STAGEDIR}${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/${PORTNAME}.1 ${STAGEDIR}${PREFIX}/man/man1
	@${MKDIR} ${STAGEDIR}${DATADIR}
	${INSTALL_DATA} ${WRKSRC}/emsdriv.sys ${WRKSRC}/redir.com \
		${STAGEDIR}${DATADIR}
	@${MKDIR} ${STAGEDIR}${DOCSDIR}
	${INSTALL_DATA} ${PORTDOCS:S,^,${WRKSRC}/,} ${STAGEDIR}${DOCSDIR}
.if ${PORT_OPTIONS:MX11}
	@${MKDIR} ${STAGEDIR}${DATADIR}/fonts
	${INSTALL_DATA} ${FONTFILES:S,^,${WRKSRC}/,} ${WRKSRC}/fonts.dir \
		${STAGEDIR}${DATADIR}/fonts
.endif

.include <bsd.port.mk>
