# ex:ts=8
# Ports collection makefile for:  dlx
# Version required:		  2.0
# Date created:			  Mon Dec 23, 1998
# Whom:				  David O'Brien (obrien@NUXI.com)
#
# $FreeBSD$
#

DISTNAME=	dlx
PKGNAME=	dlx-2.0
CATEGORIES=	emulators
MASTER_SITES=	ftp://max.stanford.edu/pub/hennessy-patterson.software/
EXTRACT_SUFX=	.tar.Z

MAINTAINER=	obrien@FreeBSD.org

.if ${MACHINE_ARCH} == alpha
BROKEN=		will not build on alpha
.endif

MAN1=		dlxcc.1

do-configure:
	cd ${WRKSRC}/gcc ; ./config.gcc dlx

do-build:
	cd ${WRKSRC}/dlxsim ; make install
	cd ${WRKSRC}/gcc ; make prefix=${PREFIX} INSTALLDIR=${PREFIX}/bin

do-install:
	@cd ${WRKSRC}/gcc ; make prefix=${PREFIX} INSTALLDIR=${PREFIX}/bin install
	@strip ${PREFIX}/bin/dlxcc ${PREFIX}/bin/dlx-gcc-cc1 \
		${PREFIX}/bin/dlx-gcc-cpp
	${INSTALL_PROGRAM} ${WRKSRC}/bin/dlxsim ${PREFIX}/bin
	@cd ${WRKSRC}/man ; ${INSTALL_MAN} ${MAN1} ${PREFIX}/man/man1
.if !defined(NOPORTDOCS)
	@${MKDIR} ${PREFIX}/share/doc/dlx
	@${INSTALL_DATA} ${WRKSRC}/dlxsim/doc/* ${PREFIX}/share/doc/dlx
.endif

.include <bsd.port.mk>
