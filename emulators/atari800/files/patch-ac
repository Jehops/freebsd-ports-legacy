--- monitor.c.orig	Sun Feb 22 02:19:59 1998
+++ monitor.c	Thu Jun 18 21:05:50 1998
@@ -94,10 +94,13 @@
 
 		printf("> ");
 		fflush(stdout);
-		if (gets(s) == NULL) {
+		if (fgets(s,256,stdin) == NULL) {
 			printf("\n> CONT\n");
 			strcpy(s, "CONT");
 		}
+
+		s[strlen(s)-1]='\0';                /* fgets provision */
+
 		t = get_token(s);
 		if (t == NULL) {
 			continue;
@@ -179,7 +182,7 @@
 					char gash[4];
 
 					printf("Press return to continue: ");
-					gets(gash);
+					fgets(gash,4,stdin);
 					nlines = 0;
 				}
 			}
