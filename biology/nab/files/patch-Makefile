--- Makefile.orig	Mon Aug 21 11:16:05 2006
+++ Makefile	Fri Dec 15 16:06:57 2006
@@ -2,31 +2,32 @@
 
 include config.h
 
+all: install
+
 install:
 	-mkdir $(BINDIR) $(LIBDIR) $(INCDIR)
-	(cd ucpp-1.3; make $(UCPP) )
-	(cd byacc; make install )
-
-#   here are the Fortran versions:
-#	(cd lapack; make $(LAPACK) )
-#	(cd blas; make $(BLAS) )
-
-#   here are the C versions:
-	(cd clapack; make $(LAPACK) )
-	(cd cblas; make $(BLAS) )
-	(cd f2c;  make $(F2C)  )
-
-	(cd cifparse; make install )
-	(cd src; make install )
-	(cd nss; make install )
-	(cd tleap; make install )
+	(cd clapack; env NABHOME=.. make $(LAPACK) )
+	(cd cblas; env NABHOME=.. make $(BLAS) )
+	(cd f2c; env NABHOME=.. make $(F2C) )
+	(cd cifparse; env NABHOME=.. make install )
+	(cd src; env NABHOME=.. make install )
+	(cd nss; env NABHOME=.. make install )
+	(cd tleap; env NABHOME=.. make install )
+#	(cd peptide && \
+#		env NABHOME=.. ../bin/nab $(CFLAGS) -o peptide peptide.nab )
+#	cp -p peptide/README doc/README-peptide
+#	mv peptide/peptide bin
+#	@echo
+#	@echo "Ignore conflicting types warnings"
+#	@echo
+#	(cd suppose; env NABHOME=.. make all )
+#	cp -p suppose/suppose.1 doc
+#	mv suppose/suppose suppose/PCA_suppose bin
 	@echo
-	@echo "completed installation of NAB version 5"
+	@echo "completed installation of NAB version 5.1"
 	@echo
 
 clean:
-	(cd ucpp-1.3; make clean )
-	(cd byacc; make clean )
 	(cd cifparse; make clean )
 	(cd src; make clean )
 	(cd nss; make clean )
@@ -34,10 +35,12 @@
 	(cd cblas; make clean )
 	(cd clapack; make clean )
 	(cd f2c; make clean )
-	
+	(cd suppose; make clean )
+	(cd peptide && rm -f peptide.c peptide )
+
 #   note:  "make test" needs to follow "make", since it is very hard to
 #          tell if the compiler is completely "made" or not.
 
 test::
-	(cd test; make test)
-	(cd nss; make test)
+	(cd test; env NABHOME=.. make test)
+	(cd nss; env NABHOME=.. make test)
