# Created by: Wen Heping <wenheping@gmail.com>
# $FreeBSD$

PORTNAME=	libsbml
PORTVERSION=	5.19.0
CATEGORIES=	biology devel
MASTER_SITES=	SF/sbml/libsbml/${PORTVERSION}/stable
DISTNAME=	libSBML-${PORTVERSION}-core-src

MAINTAINER=	sunpoet@FreeBSD.org
COMMENT=	API Library for Working with SBML File

LICENSE=	LGPL21
LICENSE_FILE=	${WRKSRC}/COPYING.txt

USES=		cmake iconv:build pathfix

USE_CXXSTD=	c++98
USE_LDCONFIG=	yes
WRKSRC=		${WRKDIR}/libsbml-${PORTVERSION}

PLIST_SUB=	PORTVERSION=${PORTVERSION}

OPTIONS_DEFINE=	EXAMPLES PYTHON RUBY
OPTIONS_SINGLE=	XML
OPTIONS_SINGLE_XML=	EXPAT LIBXML XERCES
OPTIONS_DEFAULT=LIBXML PYTHON
OPTIONS_SUB=	yes
LIBXML_DESC=	XML parser support via libxml2

EXPAT_CMAKE_BOOL=	WITH_EXPAT
EXPAT_LIB_DEPENDS=	libexpat.so:textproc/expat2
LIBXML_CMAKE_BOOL=	WITH_LIBXML
LIBXML_USE=		GNOME=libxml2
LIBXML_USES=		gnome
PYTHON_BUILD_DEPENDS=	swig:devel/swig
PYTHON_CMAKE_BOOL=	WITH_PYTHON
PYTHON_USES=		python
PYTHON_CMAKE_ON=	WITH_SWIG
RUBY_BUILD_DEPENDS=	swig:devel/swig
RUBY_CMAKE_BOOL=	WITH_RUBY
RUBY_USE=		ruby=yes
XERCES_CMAKE_BOOL=	WITH_XERCES
XERCES_LIB_DEPENDS=	libxerces-c.so:textproc/xerces-c3

post-patch:
	@${REINPLACE_CMD} -e 's|/usr/local|${LOCALBASE}|g' ${WRKSRC}/CMakeLists.txt

post-install-EXAMPLES-on:
	${MKDIR} ${STAGEDIR}${EXAMPLESDIR}
	cd ${WRKSRC}/examples && ${COPYTREE_SHARE} . ${STAGEDIR}${EXAMPLESDIR} '! -name *Makefile*'

.include <bsd.port.mk>
