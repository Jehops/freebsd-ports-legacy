--- src/Makefile.orig	Mon Jun  2 23:09:02 2003
+++ src/Makefile	Mon Jun 30 22:53:43 2003
@@ -1,12 +1,12 @@
 
 
-CFLAGS=-O2 -ffast-math -fomit-frame-pointer -Wall
+CFLAGS=-O2 -ffast-math -fomit-frame-pointer -Wall -I${LOCALBASE}/include
 # CFLAGS=-g -Wall
 # CFLAGS=-g -Wall -DROADMAP_DEBUG_HEAP
 # CFLAGS=-g -Wall -pg -fprofile-arcs -g
 
 RDMLIBS=libroadmap.a unix/libosroadmap.a
-LIBS=$(RDMLIBS) -lpopt -lm
+LIBS=$(RDMLIBS) -lpopt -lm -L${LOCALBASE}/lib
 
 # LDFLAGS=-pg $(LDFLAGS)
 
@@ -98,7 +98,7 @@
 SCRIPTS=rdmdownload rdmgetall rdmgenmaps rdmcompare
 RUNTIME=libroadmap.a libguiroadgps.a libguiroadmap.a
 
-INSTALLDIR=/usr/local
+INSTALLDIR=${LOCALBASE}
 
 
 # --- Conventional targets ----------------------------------------
@@ -114,10 +114,10 @@
 	strip -s $(BUILD)
 
 clean: cleanone
-	make -C qt cleanone
-	make -C gtk cleanone
-	make -C gtk2 cleanone
-	make -C unix cleanone
+#	${MAKE} -C qt cleanone
+	${MAKE} -C gtk cleanone
+#	${MAKE} -C gtk2 cleanone
+	${MAKE} -C unix cleanone
 
 cleanone:
 	rm -f *.o *.a *.da $(BUILD)
@@ -138,14 +138,14 @@
 	rm -f /usr/lib/menu/roadmap
 
 everything: build
-	cd gtk ; make STDCFLAGS="$(CFLAGS)" all
-	cd gtk2 ; make STDCFLAGS="$(CFLAGS)" all
-	cd qt ; make STDCFLAGS="$(CFLAGS)" all
+	cd gtk ; ${MAKE} STDCFLAGS="$(CFLAGS)" all
+#	cd gtk2 ; make STDCFLAGS="$(CFLAGS)" all
+#	cd qt ; make STDCFLAGS="$(CFLAGS)" all
 
 cleanall:
 	cd gtk ; make clean
-	cd gtk2 ; make clean
-	cd qt ; make clean
+#	cd gtk2 ; make clean
+#	cd qt ; make clean
 
 rebuild: cleanall everything
 
@@ -161,7 +161,7 @@
 	ar rf libguiroadgps.a $(RGGUIOBJS)
 
 unix/libosroadmap.a:
-	cd unix; make "CFLAGS=$(CFLAGS) -I.."
+	cd unix; ${MAKE} "CFLAGS=$(CFLAGS) -I.."
 
 dumpmap: $(DMOBJS) $(RDMLIBS)
 	$(CC) $(LDFLAGS) $(DMOBJS) -o dumpmap $(LIBS)
