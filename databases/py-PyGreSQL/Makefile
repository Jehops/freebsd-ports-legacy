# Ports collection Makefile for:	PyGreSQL
# Date created:				2/22/1999
# Whom:					nectar@FreeBSD.org
#
# $FreeBSD$
#

PORTNAME=	PyGreSQL
PORTREVISION=	0
CATEGORIES=	databases python
PKGNAMEPREFIX=	${PYTHON_PKGNAMEPREFIX}

MAINTAINER=	girgen@pingpong.net
COMMENT=	A Python interface to PostgreSQL, including a DP-API 2.0 wrapper

BUILD_DEPENDS=	${DATETIME_DEP}:${PORTSDIR}/lang/py-mx-base
RUN_DEPENDS=	${DATETIME_DEP}:${PORTSDIR}/lang/py-mx-base
LIB_DEPENDS=	pq.3:${PORTSDIR}/${POSTGRESQL_PORT}

POSTGRESQL_PORT?=	databases/postgresql7
POSTGRESQL_SUBPORT=YES

WRKSRC=		${WRKDIR}/postgresql-${PORTVERSION}

# The PyGreSQL distfile is nowhere to be found, but exists in
# postgresql-7.3 distribution so do not be alarmed if you use
# a newer version of postgresql
.include <${.CURDIR}/../postgresql73/Makefile>

USE_PYTHON=	yes
CONFIGURE_ARGS=	--with-python --prefix=${PREFIX}
MAKE_ARGS+=	-C src/interfaces/python
CFLAGS+=	-L${LOCALBASE}/lib
MAKEFILE=	GNUmakefile

DATETIME_DEP=	${PYTHON_SITELIBDIR}/mx/DateTime/__init__.py

post-install:
	@ ${PYTHON_CMD} ${PYTHON_LIBDIR}/compileall.py -lf \
	  ${PYTHONPREFIX_SITELIBDIR}
	@ ${PYTHON_CMD} -O ${PYTHON_LIBDIR}/compileall.py -lf \
	  ${PYTHONPREFIX_SITELIBDIR}
.if !defined(NOPORTDOCS)
.for docfile in Announce ChangeLog README
	@ ${MKDIR} ${DOCSDIR}
	  ${INSTALL_DATA} ${WRKSRC}/src/interfaces/python/${docfile} \
	  ${DOCSDIR}
.endfor
.endif

.include <bsd.port.mk>
