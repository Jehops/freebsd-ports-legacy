--- doc/Makefile	Tue Apr 12 08:17:04 2005
+++ doc/Makefile	Fri Dec  9 23:36:05 2005
@@ -1,11 +1,14 @@
 COMMONOPTS = -f docbook -b html -e no-valid
 
+include ../Makefile.config
+include $(top_srcdir)/src/Makefile.shlib
+
 # fetch version numbers from central repository
 include ../Version.config
 
 LAST_RELEASE_VERSION = $(SO_MAJOR_VERSION).$(SO_MINOR_VERSION).$(SO_MICRO_VERSION)
 
-XSLBASE?=/usr/share/sgml/docbook/xsl-stylesheets
+XSLBASE?=/usr/local/share/xsl/docbook
 #XSLBASE = /usr/share/xml/docbook/stylesheet/nwalsh
 
 all: html
@@ -16,14 +19,13 @@
 chunked-html: postgis-out.xml
 	xsltproc \
 		--output html/ \
-		--param shade.verbatim 1 \
 		--param chunk.section.depth 0 \
 		--param section.autolabel 1 \
 		--param section.label.includes.component.label 1 \
 		--stringparam html.stylesheet style.css \
 		--stringparam saxon.character.representation decimal \
 		$(XSLBASE)/html/chunk.xsl \
-		$<
+		$< && touch chunked-html
 
 html/postgis.html: postgis-out.xml
 	xsltproc \
@@ -67,6 +69,16 @@
 maintainer-clean: clean
 	@rm -f html/*.html
 
-install: html/postgis.html man/shp2pgsql.1 man/pgsql2shp.1
-
+install: chunked-html
+	$(mkinstalldirs) $(DOCSDIR)
+	$(INSTALL_DATA)	html/index.html $(DOCSDIR)/index.html
+	$(INSTALL_DATA)	html/ch01.html $(DOCSDIR)/ch01.html
+	$(INSTALL_DATA)	html/ch02.html $(DOCSDIR)/ch02.html
+	$(INSTALL_DATA)	html/ch03.html $(DOCSDIR)/ch03.html
+	$(INSTALL_DATA)	html/ch04.html $(DOCSDIR)/ch04.html
+	$(INSTALL_DATA)	html/ch05.html $(DOCSDIR)/ch05.html
+	$(INSTALL_DATA)	html/ch06.html $(DOCSDIR)/ch06.html
+	$(INSTALL_DATA)	html/ch07.html $(DOCSDIR)/ch07.html
+	$(INSTALL_DATA)	html/apa.html $(DOCSDIR)/apa.html
+ 
 .PHONY: html 
