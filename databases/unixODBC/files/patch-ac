--- configure.in.orig	Wed Mar 21 22:15:36 2001
+++ configure.in	Thu Mar 22 07:09:08 2001
@@ -143,12 +143,13 @@
     ])
 
     if test "x$gotthread" = "xno"; then
-      AC_CHECK_LIBPT(pthread, pthread_mutex_lock, 
+      AC_CHECK_LIBPT(c_r, pthread_mutex_lock, 
       [
         AC_DEFINE(HAVE_LIBPTHREAD,1)
         if test "x$ac_cv_prog_gcc"="xyes"; then
           dnl Check if the compiler will build with -pthread as a option
           AC_CHECK_COMP_OPT(pthread)
+          AC_DEFINE(_THREAD_SAFE,1)
         else
           dnl Check if the compiler will build with -mt as a option
           AC_CHECK_COMP_OPT(mt)
@@ -156,16 +157,16 @@
       ])
     fi
 
-    AC_CHECK_LIB(c, localtime_r, [AC_DEFINE(HAVE_LOCALTIME_R, 1)] )
+    AC_CHECK_FUNC(localtime_r, [AC_DEFINE(HAVE_LOCALTIME_R, 1)] )
   fi
 fi
 
 if test "x$stats" = "xtrue"; then
-  AC_CHECK_LIB( c, ftok,[],[stats=false] )
-  AC_CHECK_LIB( c, semget,[],[stats=false] )
-  AC_CHECK_LIB( c, shmget,[],[stats=false] )
-  AC_CHECK_LIB( c, semop,[],[stats=false] )
-  AC_CHECK_LIB( c, snprintf, [AC_DEFINE(HAVE_SNPRINTF)],[stats=false] )
+  AC_CHECK_FUNC(ftok,[],[stats=false] )
+  AC_CHECK_FUNC(semget,[],[stats=false] )
+  AC_CHECK_FUNC(shmget,[],[stats=false] )
+  AC_CHECK_FUNC(semop,[],[stats=false] )
+  AC_CHECK_FUNC(snprintf, [AC_DEFINE(HAVE_SNPRINTF)],[stats=false] )
 fi
 
 if test "x$stats" = "xtrue"; then
