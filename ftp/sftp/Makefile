# New ports collection makefile for:	sftp
# Version required:	0.7
# Date created:		30 December 1999
# Whom:			Cy Shubert <Cy.Shubert@uumail.gov.bc.ca>
#
# $FreeBSD$
#

DISTNAME=	sftp-0.7
CATEGORIES=	ftp security
MASTER_SITES=	ftp://ftp.xbill.org/pub/sftp/

MAINTAINER=	Cy.Schubert@uumail.gov.bc.ca

RUN_DEPENDS=	ssh:${PORTSDIR}/security/openssh

RESTRICTED=	"Calls external cryptographic routines."

GNU_CONFIGURE=  yes

CONFIGURE_ARGS+=	--prefix=${PREFIX} \
			--enable-remotepath=${PREFIX}/libexec

MAN1=		secftp.1

PLIST=		${WRKDIR}/.PLIST

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/sftp ${PREFIX}/bin/secftp
	${LN} -s ${PREFIX}/bin/secftp ${PREFIX}/bin/rsftp
	${INSTALL_PROGRAM} ${WRKSRC}/sftpserv ${PREFIX}/libexec/sftpserv
	${INSTALL_MAN} ${WRKSRC}/sftp.1 ${PREFIX}/man/man1/secftp.1
	${CP} ${PKGDIR}/PLIST.in ${PLIST}.unsorted
	@if [ ! -f ${PREFIX}/bin/sftp ]; then \
		${ECHO} "No other sftp found, linking sftp to secftp"; \
		${LN} -s ${PREFIX}/bin/secftp ${PREFIX}/bin/sftp; \
		${LN} -s ${PREFIX}/man/man1/secftp.1.gz ${PREFIX}/man/man1/sftp.1.gz; \
		${ECHO} bin/sftp >> ${PLIST}.unsorted; \
		${ECHO} man/man1/sftp.1.gz >> ${PLIST}.unsorted; \
	else \
		${ECHO} "Other sftp found, not linking sftp to secftp"; \
	fi
	@sort -u ${PLIST}.unsorted > ${PLIST}

.include <bsd.port.mk>
