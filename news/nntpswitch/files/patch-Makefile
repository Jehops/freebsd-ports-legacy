--- Makefile.orig	Mon Mar  8 11:37:11 2004
+++ Makefile	Wed Mar 24 00:53:21 2004
@@ -1,7 +1,3 @@
- 
-PREFIX   = /usr/local
-PERL	 = /usr/bin/perl
-
 PROG     = nntpswitchd
 INSTUTILS= nsstats.pl nsstats.sh updategroups
 
@@ -13,10 +9,8 @@
 
 DISTNAME = nntpswitch
 VERSION  = `/bin/sh version.sh`
-CC       = gcc
-CFLAGS   = -pipe -g -O3 -Wall -D_VERSION=\"$(VERSION)\"
-LDFLAGS  = 
-LIBS     = -lm -ldl 
+CFLAGS  += -D_VERSION=\"$(VERSION)\"
+LIBS    += -lm
 _DIRNAME = $(DISTNAME)
 
 all:		protos config aconfig.o $(PROG) $(MODULES) updategroups
@@ -33,6 +27,10 @@
 updategroups:	$(UGOBJS)
 		$(CC) $(LDFLAGS) $(CFLAGS) $(LIBS) $(UGOBJS) -o updategroups
 
+$(OBJS):	\
+%.o:		%.c
+		$(CC) $(LDFLAGS) $(CFLAGS) -fPIC $< -c -o $@
+
 $(PROG):	$(OBJS)
 		$(CC) $(LDFLAGS) $(CFLAGS) $(OBJS) aconfig.o $(LIBS) -o $(PROG) 
 
@@ -82,7 +80,6 @@
 		@if [ -f acct_radius.so ]; then cp acct_radius.so $(PREFIX)/lib/libacct_radius.so; fi
 		@if [ -f auth_postgres.so ]; then cp auth_postgres.so $(PREFIX)/lib/libauth_postgres.so; fi
 		@if [ -f auth_mysql.so ]; then cp auth_mysql.so $(PREFIX)/lib/libauth_mysql.so; fi
-		ldconfig
 
 help:
 		@echo "Choose one of the following targets:"
