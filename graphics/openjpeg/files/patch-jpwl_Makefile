--- jpwl/Makefile.orig	2007-02-23 13:24:49.000000000 -0500
+++ jpwl/Makefile	2007-07-18 07:13:51.000000000 -0400
@@ -1,10 +1,7 @@
 # Makefile for the main JPWL OpenJPEG codecs: JPWL_ j2k_to_image and JPWL_image_to_j2k
 
 # General configuration variables:
-CC = gcc
-AR = ar
-
-CFLAGS = -O3 -DUSE_JPWL # -g -p -pg -DUSE_JPWL
+CFLAGS += -DUSE_JPWL # -g -p -pg -DUSE_JPWL
 
 OPJ_SRCS = ../libopenjpeg/bio.c ../libopenjpeg/cio.c ../libopenjpeg/dwt.c ../libopenjpeg/event.c ../libopenjpeg/image.c ../libopenjpeg/j2k.c ../libopenjpeg/j2k_lib.c ../libopenjpeg/jp2.c ../libopenjpeg/jpt.c ../libopenjpeg/mct.c ../libopenjpeg/mqc.c ../libopenjpeg/openjpeg.c ../libopenjpeg/pi.c ../libopenjpeg/raw.c ../libopenjpeg/t1.c ../libopenjpeg/t2.c ../libopenjpeg/tcd.c ../libopenjpeg/tgt.c
 JPWL_SRCS = crc.c jpwl.c jpwl_lib.c rs.c
@@ -23,10 +20,10 @@
 	$(AR) r $@ $(MODULES)
 
 JPWL_j2k_to_image: ../codec/j2k_to_image.c $(STATICLIB)
-	gcc $(CFLAGS) ../codec/convert.c ../codec/j2k_to_image.c -o JPWL_j2k_to_image -I ../libopenjpeg/ -L . -lopenjpeg_JPWL -lm -lstdc++ 
+	$(CC) $(CFLAGS) ../codec/convert.c ../codec/j2k_to_image.c -o JPWL_j2k_to_image -I ../libopenjpeg/ -ltiff -L$(LOCALBASE)/lib -L . -lopenjpeg_JPWL -lm -lstdc++ 
 
 JPWL_image_to_j2k: ../codec/image_to_j2k.c $(STATICLIB)
-	gcc $(CFLAGS) ../codec/convert.c ../codec/image_to_j2k.c -o JPWL_image_to_j2k -I ../libopenjpeg/ -L . -lopenjpeg_JPWL -lm -lstdc++ 
+	$(CC) $(CFLAGS) ../codec/convert.c ../codec/image_to_j2k.c -o JPWL_image_to_j2k -I ../libopenjpeg/ -ltiff -L$(LOCALBASE)/lib -L . -lopenjpeg_JPWL -lm -lstdc++ 
 
 clean:
 	rm -f JPWL_j2k_to_image JPWL_image_to_j2k *.o *.a
