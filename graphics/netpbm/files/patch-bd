--- pbm/Makefile.orig	Sat Sep  2 12:59:29 2000
+++ pbm/Makefile	Fri Dec  8 00:00:00 2000
@@ -5,7 +5,7 @@
 include $(BUILDDIR)/Makefile.config
 
 
-INCLUDE = -I$(SRCDIR) -I$(SRCDIR)/shhopt
+INCLUDE = -I$(SRCDIR)
 
 # Shared library naming
 LIBROOT = pbm
@@ -16,6 +16,8 @@
 LIBLIBS = 
 NETPBMLIBS = $(LIBPBM)
 
+SOVER = 1
+
 PORTBINARIES =	atktopbm brushtopbm cmuwmtopbm g3topbm \
 		icontopbm macptopbm mdatopbm mgrtopbm \
 		pbmclean pbmlife pbmmake pbmmask pbmpscale \
@@ -38,11 +40,10 @@
 
 # Library objects to be built and linked by Makefile.common:
 LIBOBJECTS = libpbm1.o libpbm2.o libpbm3.o libpbm4.o libpbm5.o 
+SHLIBOBJECTS = $(patsubst %.o, %.lo, $(LIBOBJECTS))
 ifneq (${VMS}x,x)
 LIBOBJECTS += libpbmvms.o
 endif
-# Library objects to be linked but not built by Makefile.common:
-LIBOBJECTS_X = $(BUILDDIR)/shhopt/shhopt.o
 
 MANUALS1 =	$(BINARIES)
 MANUALS3 =	libpbm
@@ -80,11 +81,6 @@
 # Don't use $(SRCDIR) in the target below because Makefile.dep doesn't !
 ../compile.h: 
 	$(MAKE) -C $(SRCDIR) compile.h
-
-$(BUILDDIR)/shhopt/shhopt.o:
-	cd ../shhopt; $(MAKE) shhopt.o
-$(BUILDDIR)/shhopt/libshhopt.a:
-	cd ../shhopt; $(MAKE) libshhopt.a
 
 .PHONY: clean
 clean: clean.common
