--- pbm/Makefile.orig	Sat May  6 16:16:53 2000
+++ pbm/Makefile	Mon May  8 00:00:00 2000
@@ -9,11 +9,12 @@
 # Shared library naming
 LIBROOT = pbm
 LIBPBM = lib$(LIBROOT).$(NETPBMLIBSUFFIX)
-MAJ = 9
+MAJ = 1
 MIN = 1
 
 LIBLIBS = 
 NETPBMLIBS = $(LIBPBM)
+NETPBMLD = -L. -lpbm
 
 PORTBINARIES =	atktopbm brushtopbm cmuwmtopbm g3topbm \
 		icontopbm macptopbm mdatopbm mgrtopbm \
@@ -36,8 +37,7 @@
 
 # Library objects to be built and linked by Makefile.common:
 LIBOBJECTS = libpbm1.o libpbm2.o libpbm3.o libpbm4.o libpbm5.o 
-# Library objects to be linked but not built by Makefile.common:
-LIBOBJECTS_X = $(SRCDIR)/shhopt/shhopt.o
+LIBSOBJECTS = libpbm1.so libpbm2.so libpbm3.so libpbm4.so libpbm5.so 
 
 MANUALS1 =	$(BINARIES)
 MANUALS3 =	libpbm
@@ -45,7 +45,7 @@
 
 MERGENAME = pbmmerge
 
-INTERFACE_HEADERS = pbm.h
+INTERFACE_HEADERS = pbm.h $(SRCDIR)/pbmplus.h
 
 .PHONY: all
 all:		$(BINARIES)
@@ -55,11 +55,11 @@
 
 # Rules for plain programs.
 $(PORTBINARIES): %: %.o $(NETPBMLIBS)
-	$(LD) $(LDFLAGS) -o $@ $@.o $(NETPBMLIBS) $(CDEBUG)
+	$(LD) $(LDFLAGS) -o $@ $@.o $(NETPBMLD) $(CDEBUG)
 
 # Rule for math-dependent programs.
 $(MATHBINARIES): %: %.o $(NETPBMLIBS)
-	$(LD) $(LDFLAGS) -o $@ $@.o -lm $(NETPBMLIBS) $(CDEBUG)
+	$(LD) $(LDFLAGS) -o $@ $@.o -lm $(NETPBMLD) $(CDEBUG)
 
 .PHONY: install.bin
 install.bin: install.bin.common
@@ -72,11 +72,6 @@
 # Don't use $(SRCDIR) in the target below because Makefile.dep doesn't !
 ../compile.h: 
 	$(MAKE) -C $(SRCDIR) compile.h
-
-$(SRCDIR)/shhopt/shhopt.o:
-	cd ../shhopt; $(MAKE) shhopt.o
-$(SRCDIR)/shhopt/libshhopt.a:
-	cd ../shhopt; $(MAKE) libshhopt.a
 
 .PHONY: clean
 clean:
