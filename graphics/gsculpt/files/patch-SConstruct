--- SConstruct.orig	Wed Feb 28 16:48:01 2007
+++ SConstruct	Wed Feb 28 16:48:47 2007
@@ -1,6 +1,6 @@
 import os
 import sys
-
+import re
 
 PLATFORM_WIN32 = 0
 PLATFORM_LINUX = 1
@@ -117,7 +117,7 @@
 	pyExtSuffix = '.pyd'
 elif platform == PLATFORM_LINUX:
 	localIncPaths = [ 'cpp' ]
-	pyIncPaths = [ '/usr/include/python2.4' ]
+	pyIncPaths = [ '/usr/local/include/python2.4' ]
 	boostPyIncPaths = []
 	standardIncPaths = []
 	localLibPaths = [ '.' ]
@@ -140,9 +140,24 @@
 
 extLibs = pyLibs + boostPyLibs + glLibs
 
+env = Environment( ENV=os.environ )
+
+s = re.compile( '(-O2|-O3|-Os|-O)' )
+os.environ['CXXFLAGS'] = s.sub('', env['ENV']['CXXFLAGS'])
+os.environ['CCFLAGS'] = s.sub('', env['ENV']['CCFLAGS'])
+
+for key in [ 'CC', 'CXX', 'CCACHE_DIR' ]:
+  if os.environ.has_key(key):
+    env.Replace( **{key: os.environ[key]})
+ 
+for key in [ 'CCFLAGS', 'CXXFLAGS', 'CPPPATH', 'LINKFLAGS', 'LIBPATH',]:
+  if os.environ.has_key(key):
+    env.Append( **{key: os.environ[key].split(' ')} )
 
+env.Append(CPPPATH = incPaths)
+env.Append(CCFLAGS = ccFlags)
+libPaths = libPaths + env['LIBPATH']
 
-env = Environment( CCFLAGS=' '.join( ccFlags ), CPPPATH=incPaths, LINKFLAGS=linkFlags )
 if envPath is not None:
 	env['ENV']['PATH'] = envPath
 
