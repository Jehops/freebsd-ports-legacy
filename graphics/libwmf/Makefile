# New ports collection makefile for:	libwmf
# Date Created:		22 May 1999
# Whom:			Chris Piazza <cpiazza@FreeBSD.org>
#
# $FreeBSD$
#

PORTNAME=	libwmf
PORTVERSION=	0.2.2
CATEGORIES=	graphics
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE}
MASTER_SITE_SUBDIR=	wvware

MAINTAINER=	ports@FreeBSD.org

BUILD_DEPENDS=	freetype-config:${PORTSDIR}/print/freetype2     # XXX
LIB_DEPENDS=	jpeg:${PORTSDIR}/graphics/jpeg \
		png:${PORTSDIR}/graphics/png \
		freetype:${PORTSDIR}/print/freetype2 \
		xml2.5:${PORTSDIR}/textproc/libxml2

.ifndef (WITHOUT_X11)
USE_XLIB=	yes
PLIST_SUB+=	X11=''
.else
PKGNAMESUFFIX=	-nox11
PLIST_SUB+=	X11='@comment '
.endif

GNU_CONFIGURE=	yes
CONFIGURE_TARGET=	# none
CONFIGURE_ARGS=	--build=${ARCH}-portbld-freebsd${OSREL} \
		--enable-magick --with-sys-gd=no \
		--with-png=${LOCALBASE} --with-jpeg=${LOCALBASE} \
		--with-gsfontdir=${LOCALBASE}/share/ghostscript/fonts
INSTALLS_SHLIB=	yes

pre-patch:
	@${PERL} -pi -e 's|src include fonts doc|src include fonts|g' \
		${WRKSRC}/Makefile.in
	@${PERL} -pi -e 's|\@LT_CURRENT\@|2|g ; \
		 s|-release \$$\(LT_RELEASE\)||g' ${WRKSRC}/src/Makefile.in

post-install:
.if !defined(NOPORTDOCS)
	@${MKDIR} ${DOCSDIR}
	${TAR} -C ${WRKSRC}/doc --exclude '*Makefile*' -cf - . | \
		${TAR} -C ${DOCSDIR} --unlink -xf -
	@${CHOWN} -R ${SHAREOWN}:${SHAREGROUP} ${DOCSDIR}
.endif

.include <bsd.port.mk>
