--- libtiff/Makefile.in.orig	Mon Nov 29 05:15:36 1999
+++ libtiff/Makefile.in	Sat Apr  1 00:00:00 2000
@@ -62,7 +62,7 @@
 #
 CONF_LIBRARY=@CONF_JPEG@ @CONF_ZIP@
 COPTS	= @GCOPTS@
-OPTIMIZER=-O
+#OPTIMIZER=-O
 CFLAGS	= @ENVOPTS@ @LIBCOPTS@ ${COPTS} ${OPTIMIZER} ${IPATH} ${CONF_LIBRARY}
 #
 SRCS	= \
@@ -197,8 +197,8 @@
 	${AR} ${AROPTS} libtiff.@DSOSUF@ shr.o
 	rm -f shr.o
 	touch $@
-# NetBSD 1.1 or FreeBSD
-NETBSDdso FREEBSDdso: ${OBJS}
+# NetBSD 1.1
+NETBSDdso: ${OBJS}
 	@rm -f libtiff_pic.a
 	@${AR} cq libtiff_pic.a `lorder ${OBJS} | tsort -q`
 	${RANLIB} libtiff_pic.a
@@ -215,7 +215,12 @@
 # OSF/1 3.2 shared lib rule
 OSFdso: ${OBJS}
 	${LD} -o libtiff.@DSOSUF@ -shared -error_unresolved ${OBJS} @LIBJPEG@ @LIBGZ@ -lc -lm
-
+# FreeBSD shared lib rule
+FREEBSDdso: ${OBJS}
+	${CC} -shared -Wl,-soname,libtiff.@DSOSUF_VERSION@ -o libtiff.@DSOSUF_VERSION@ \
+		${OBJS} @LIBJPEG@ @LIBGZ@
+	@LN@ @LN_S@ libtiff.@DSOSUF_VERSION@ libtiff.@DSOSUF@
+	touch $@
 
 ${OBJS}: ${SRCDIR}/tiffio.h ${SRCDIR}/tiff.h ${SRCDIR}/tif_dir.h
 ${OBJS}: ${SRCDIR}/tiffcomp.h ${SRCDIR}/tiffiop.h ${SRCDIR}/tiffconf.h
@@ -319,22 +324,20 @@
 	${INSTALL} -idb tiff.sw.dev -m 755 -dir @DIR_INC@
 	for i in ${INCS}; do						\
 	    f=`basename $$i`;						\
-	    ${INSTALL} -idb tiff.sw.dev -m 444 -F @DIR_INC@		\
-		-src $$i -O $$f;					\
+	    ${BSD_INSTALL_DATA} $$i @DIR_INC@/$$f;			\
 	done
 installDSO: @DSO@dso
 	if [ @DSOSUF_VERSION@ != @DSOSUF@ ]; then			\
-	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @DIR_LIB@		\
-		-O libtiff.@DSOSUF_VERSION@;				\
+	    ${BSD_INSTALL_DATA} libtiff.@DSOSUF_VERSION@ @DIR_LIB@;	\
 	    ${INSTALL} -idb tiff.sw.tools -F @DIR_LIB@			\
-		-ln libtiff.@DSOSUF_VERSION@ -O libtiff.@DSOSUF@;	\
+		-lns libtiff.@DSOSUF_VERSION@ -O libtiff.@DSOSUF@;	\
 	else								\
 	    ${INSTALL} -idb tiff.sw.tools -m 555 -F @DIR_LIB@		\
 		-O libtiff.@DSOSUF@;					\
 	fi
 install: all installHdrs
 	${INSTALL} -idb tiff.sw.dev -m 755 -dir @DIR_LIB@
-	${INSTALL} -idb tiff.sw.dev -m 444 -F @DIR_LIB@ -O libtiff.a
+	${BSD_INSTALL_DATA} libtiff.a @DIR_LIB@
 	if [ @DSO@dso != nodso ]; then					\
 	    ${MAKE} installDSO;						\
 	else								\
