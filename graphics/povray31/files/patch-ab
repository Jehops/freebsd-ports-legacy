*** source/unix/makefile.orig	Sun Feb  2 13:20:44 1997
--- source/unix/makefile	Wed Mar 17 23:26:51 1999
***************
*** 28,44 ****
  # Use libXXX.a if you want to force static linking of the libraries.
  #   Use -Llibdir -lXXX if you want to use shared libraries (if they are
  #   available).  It doesn't matter if you only have libXXX.a libraries.
! PNGDIR = $(SRCDIR)/libpng
  LIBPNGINC = -I$(PNGDIR)
  #LIBPNGLIB = $(PNGDIR)/libpng.a
! LIBPNGLIB = -L$(PNGDIR) -lpng
! #LIBPNGLIB = -L/usr/local/lib -lpng
  
  ZLIBDIR = $(SRCDIR)/zlib
  ZLIBINC = -I$(ZLIBDIR)
  #ZLIBLIB = $(ZLIBDIR)/libz.a
! ZLIBLIB = -L$(ZLIBDIR) -lz
! #ZLIBLIB = -L/usr/local/lib -lz
  
  # This is the suffix for object files.
  OBJ     = .o
--- 28,44 ----
  # Use libXXX.a if you want to force static linking of the libraries.
  #   Use -Llibdir -lXXX if you want to use shared libraries (if they are
  #   available).  It doesn't matter if you only have libXXX.a libraries.
! PNGDIR = $(SRCDIR)/lpng101
  LIBPNGINC = -I$(PNGDIR)
  #LIBPNGLIB = $(PNGDIR)/libpng.a
! #LIBPNGLIB = -L$(PNGDIR) -lpng
! LIBPNGLIB = -L/usr/local/lib -lpng
  
  ZLIBDIR = $(SRCDIR)/zlib
  ZLIBINC = -I$(ZLIBDIR)
  #ZLIBLIB = $(ZLIBDIR)/libz.a
! #ZLIBLIB = -L$(ZLIBDIR) -lz
! ZLIBLIB = -L/usr/local/lib -lz
  
  # This is the suffix for object files.
  OBJ     = .o
***************
*** 55,61 ****
  #X11 = /usr/local/X11R6
  #X11 = /usr/openwin        # for some SunOS systems
  #X11 = /usr/lpp/X11        # for some AIX systems
! X11 = /usr/X11
  
  # You probably won't need to change these if you have the X11 variable
  #   above set properly...
--- 55,61 ----
  #X11 = /usr/local/X11R6
  #X11 = /usr/openwin        # for some SunOS systems
  #X11 = /usr/lpp/X11        # for some AIX systems
! X11 = /usr/X11R6
  
  # You probably won't need to change these if you have the X11 variable
  #   above set properly...
***************
*** 79,85 ****
  #   for compiles unless you are debugging new code, as it slows things down.
  # The option -DPOV_COMMENTS enables informational comments in PNG and PPM
  #   format output files (see png_pov.c and ppm.c for more info).
! CFLAGS      = -O2 -ansi -c -DCOMPILER_VER=\".`uname`.$(CC)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC) $(XLIBINC)
  LFLAGS      = $(LIBPNGLIB) $(ZLIBLIB) -lm
  
  # Linux compiler flags
--- 79,86 ----
  #   for compiles unless you are debugging new code, as it slows things down.
  # The option -DPOV_COMMENTS enables informational comments in PNG and PPM
  #   format output files (see png_pov.c and ppm.c for more info).
! CFLAGS      ?= -O6
! CFLAGS      += -finline-functions -ansi -c -DCOMPILER_VER=\".`uname`.$(CC)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC) $(XLIBINC)
  LFLAGS      = $(LIBPNGLIB) $(ZLIBLIB) -lm
  
  # Linux compiler flags
***************
*** 89,99 ****
  #CFLAGS      = +O2 -finline-functions -c -Aa -D_HPUX_SOURCE -DCOMPILER_VER=\".`uname`.$(CC)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
  
  # Your compiler
! CC          = gcc
  
  # This decides which version of the executable you will get, either the
  # Unix text-only version, the X-Windows version, or the SVGAlib version.
! default: config.h unix
  #default: unix
  #default: xwin
  #default: svga
--- 90,100 ----
  #CFLAGS      = +O2 -finline-functions -c -Aa -D_HPUX_SOURCE -DCOMPILER_VER=\".`uname`.$(CC)\" $(SRCINC) $(LIBPNGINC) $(ZLIBINC)
  
  # Your compiler
! CC          = cc
  
  # This decides which version of the executable you will get, either the
  # Unix text-only version, the X-Windows version, or the SVGAlib version.
! default: comment unix
  #default: unix
  #default: xwin
  #default: svga
***************
*** 119,133 ****
            $(ODIR)/fractal$(OBJ)  \
            $(ODIR)/gif$(OBJ)      \
            $(ODIR)/gifdecod$(OBJ) \
-           $(ODIR)/halos$(OBJ)    \
            $(ODIR)/hcmplx$(OBJ)   \
            $(ODIR)/hfield$(OBJ)   \
            $(ODIR)/iff$(OBJ)      \
            $(ODIR)/image$(OBJ)    \
            $(ODIR)/lathe$(OBJ)    \
            $(ODIR)/lbuffer$(OBJ)  \
            $(ODIR)/lighting$(OBJ) \
            $(ODIR)/matrices$(OBJ) \
            $(ODIR)/mem$(OBJ)      \
            $(ODIR)/mesh$(OBJ)     \
            $(ODIR)/normal$(OBJ)   \
--- 120,135 ----
            $(ODIR)/fractal$(OBJ)  \
            $(ODIR)/gif$(OBJ)      \
            $(ODIR)/gifdecod$(OBJ) \
            $(ODIR)/hcmplx$(OBJ)   \
            $(ODIR)/hfield$(OBJ)   \
            $(ODIR)/iff$(OBJ)      \
            $(ODIR)/image$(OBJ)    \
+           $(ODIR)/interior$(OBJ) \
            $(ODIR)/lathe$(OBJ)    \
            $(ODIR)/lbuffer$(OBJ)  \
            $(ODIR)/lighting$(OBJ) \
            $(ODIR)/matrices$(OBJ) \
+           $(ODIR)/media$(OBJ)    \
            $(ODIR)/mem$(OBJ)      \
            $(ODIR)/mesh$(OBJ)     \
            $(ODIR)/normal$(OBJ)   \
***************
*** 183,188 ****
--- 185,191 ----
                            config.h             \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/lighting.h \
+                           $(SRCDIR)/media.h    \
                            $(SRCDIR)/objects.h  \
                            $(SRCDIR)/pattern.h  \
                            $(SRCDIR)/pigment.h  \
***************
*** 212,223 ****
                            $(SRCDIR)/warps.h
  
  bcylDEP                 = $(SRCDIR)/bcyl.c     \
-                           $(SRCDIR)/bbox.h     \
                            $(SRCDIR)/bcyl.h     \
-                           $(SRCDIR)/frame.h    \
-                           $(SRCDIR)/vector.h   \
                            config.h             \
                            $(SRCDIR)/povproto.h \
  
  bezierDEP               = $(SRCDIR)/bezier.c   \
                            $(SRCDIR)/atmosph.h  \
--- 215,226 ----
                            $(SRCDIR)/warps.h
  
  bcylDEP                 = $(SRCDIR)/bcyl.c     \
                            $(SRCDIR)/bcyl.h     \
                            config.h             \
+                           $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/mem.h      \
                            $(SRCDIR)/povproto.h \
+                           $(SRCDIR)/vector.h   \
  
  bezierDEP               = $(SRCDIR)/bezier.c   \
                            $(SRCDIR)/atmosph.h  \
***************
*** 372,377 ****
--- 375,381 ----
                            config.h             \
                            $(SRCDIR)/express.h  \
                            $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/matrices.h \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/parse.h    \
***************
*** 430,456 ****
                            $(SRCDIR)/gifdecod.h \
                            $(SRCDIR)/povproto.h
  
- halosDEP                = $(SRCDIR)/halos.c    \
-                           $(SRCDIR)/atmosph.h  \
-                           $(SRCDIR)/bbox.h     \
-                           $(SRCDIR)/camera.h   \
-                           $(SRCDIR)/colour.h   \
-                           config.h             \
-                           $(SRCDIR)/frame.h    \
-                           $(SRCDIR)/halos.h    \
-                           $(SRCDIR)/lighting.h \
-                           $(SRCDIR)/matrices.h \
-                           $(SRCDIR)/objects.h  \
-                           $(SRCDIR)/pattern.h  \
-                           $(SRCDIR)/point.h    \
-                           $(SRCDIR)/povproto.h \
-                           $(SRCDIR)/povray.h   \
-                           $(SRCDIR)/render.h   \
-                           $(SRCDIR)/texture.h  \
-                           $(SRCDIR)/vector.h   \
-                           $(SRCDIR)/vlbuffer.h \
-                           $(SRCDIR)/warps.h
- 
  hcmplxDEP               = $(SRCDIR)/hcmplx.c   \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
--- 434,439 ----
***************
*** 518,523 ****
--- 501,532 ----
                            $(SRCDIR)/vlbuffer.h \
                            $(SRCDIR)/warps.h
  
+ interiorDEP             = $(SRCDIR)/interior.c \
+                           $(SRCDIR)/atmosph.h  \
+                           $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/camera.h   \
+                           $(SRCDIR)/chi2.h     \
+                           $(SRCDIR)/colour.h   \
+                           config.h             \
+                           $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/interior.h \
+                           $(SRCDIR)/lighting.h \
+                           $(SRCDIR)/matrices.h \
+                           $(SRCDIR)/media.h    \
+                           $(SRCDIR)/mem.h      \
+                           $(SRCDIR)/objects.h  \
+                           $(SRCDIR)/pattern.h  \
+                           $(SRCDIR)/pigment.h  \
+                           $(SRCDIR)/point.h    \
+                           $(SRCDIR)/povproto.h \
+                           $(SRCDIR)/povray.h   \
+                           $(SRCDIR)/ray.h      \
+                           $(SRCDIR)/render.h   \
+                           $(SRCDIR)/texture.h  \
+                           $(SRCDIR)/vector.h   \
+                           $(SRCDIR)/vlbuffer.h \
+                           $(SRCDIR)/warps.h
+ 
  quaternDEP              = $(SRCDIR)/quatern.c  \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
***************
*** 538,543 ****
--- 547,553 ----
  latheDEP                = $(SRCDIR)/lathe.c    \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/bcyl.h     \
                            $(SRCDIR)/camera.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
***************
*** 580,589 ****
                            $(SRCDIR)/colour.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
-                           $(SRCDIR)/halos.h    \
                            $(SRCDIR)/image.h    \
                            $(SRCDIR)/lbuffer.h  \
                            $(SRCDIR)/lighting.h \
                            $(SRCDIR)/mesh.h     \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/objects.h  \
--- 590,600 ----
                            $(SRCDIR)/colour.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/image.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/lbuffer.h  \
                            $(SRCDIR)/lighting.h \
+                           $(SRCDIR)/media.h    \
                            $(SRCDIR)/mesh.h     \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/objects.h  \
***************
*** 608,613 ****
--- 619,649 ----
                            $(SRCDIR)/povproto.h \
                            $(SRCDIR)/vector.h
  
+ mediaDEP                = $(SRCDIR)/media.c    \
+                           $(SRCDIR)/atmosph.h  \
+                           $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/camera.h   \
+                           $(SRCDIR)/chi2.h     \
+                           $(SRCDIR)/colour.h   \
+                           config.h             \
+                           $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/lighting.h \
+                           $(SRCDIR)/matrices.h \
+                           $(SRCDIR)/media.h    \
+                           $(SRCDIR)/mem.h      \
+                           $(SRCDIR)/objects.h  \
+                           $(SRCDIR)/pattern.h  \
+                           $(SRCDIR)/pigment.h  \
+                           $(SRCDIR)/point.h    \
+                           $(SRCDIR)/povproto.h \
+                           $(SRCDIR)/povray.h   \
+                           $(SRCDIR)/ray.h      \
+                           $(SRCDIR)/render.h   \
+                           $(SRCDIR)/texture.h  \
+                           $(SRCDIR)/vector.h   \
+                           $(SRCDIR)/vlbuffer.h \
+                           $(SRCDIR)/warps.h
+ 
  memDEP                  = $(SRCDIR)/mem.c      \
                            config.h             \
                            $(SRCDIR)/frame.h    \
***************
*** 661,666 ****
--- 697,703 ----
                            $(SRCDIR)/camera.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/objects.h  \
                            $(SRCDIR)/pattern.h  \
                            $(SRCDIR)/point.h    \
***************
*** 707,712 ****
--- 744,750 ----
  optoutDEP               = $(SRCDIR)/optout.c   \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/bcyl.h     \
                            $(SRCDIR)/bezier.h   \
                            $(SRCDIR)/blob.h     \
                            $(SRCDIR)/boxes.h    \
***************
*** 759,764 ****
--- 797,803 ----
  parseDEP                = $(SRCDIR)/parse.c    \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/bcyl.h     \
                            $(SRCDIR)/bezier.h   \
                            $(SRCDIR)/blob.h     \
                            $(SRCDIR)/boxes.h    \
***************
*** 773,782 ****
                            $(SRCDIR)/fractal.h  \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/gif.h      \
-                           $(SRCDIR)/halos.h    \
                            $(SRCDIR)/hfield.h   \
                            $(SRCDIR)/iff.h      \
                            $(SRCDIR)/image.h    \
                            $(SRCDIR)/lathe.h    \
                            $(SRCDIR)/matrices.h \
                            $(SRCDIR)/mesh.h     \
--- 812,821 ----
                            $(SRCDIR)/fractal.h  \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/gif.h      \
                            $(SRCDIR)/hfield.h   \
                            $(SRCDIR)/iff.h      \
                            $(SRCDIR)/image.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/lathe.h    \
                            $(SRCDIR)/matrices.h \
                            $(SRCDIR)/mesh.h     \
***************
*** 822,831 ****
                            $(SRCDIR)/express.h  \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/gif.h      \
-                           $(SRCDIR)/halos.h    \
                            $(SRCDIR)/iff.h      \
                            $(SRCDIR)/image.h    \
                            $(SRCDIR)/matrices.h \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/parse.h    \
                            $(SRCDIR)/parstxtr.h \
--- 861,871 ----
                            $(SRCDIR)/express.h  \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/gif.h      \
                            $(SRCDIR)/iff.h      \
                            $(SRCDIR)/image.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/matrices.h \
+                           $(SRCDIR)/media.h    \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/parse.h    \
                            $(SRCDIR)/parstxtr.h \
***************
*** 910,916 ****
                            config.h             \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/optout.h   \
-                           $(PNGDIR)/png.h      \
                            $(SRCDIR)/png_pov.h  \
                            $(SRCDIR)/point.h    \
                            $(SRCDIR)/povproto.h \
--- 950,955 ----
***************
*** 988,993 ****
--- 1027,1033 ----
  povrayDEP               = $(SRCDIR)/povray.c   \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/bcyl.h     \
                            $(SRCDIR)/bezier.h   \
                            $(SRCDIR)/blob.h     \
                            $(SRCDIR)/boxes.h    \
***************
*** 1000,1008 ****
--- 1040,1050 ----
                            $(SRCDIR)/fractal.h  \
                            $(SRCDIR)/frame.h    \
                            $(SRCDIR)/hfield.h   \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/lathe.h    \
                            $(SRCDIR)/lbuffer.h  \
                            $(SRCDIR)/lighting.h \
+                           $(SRCDIR)/media.h    \
                            $(SRCDIR)/mem.h      \
                            $(SRCDIR)/mesh.h     \
                            $(SRCDIR)/objects.h  \
***************
*** 1131,1136 ****
--- 1173,1179 ----
                            $(SRCDIR)/colour.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
+                           $(SRCDIR)/interior.h \
                            $(SRCDIR)/lighting.h \
                            $(SRCDIR)/normal.h   \
                            $(SRCDIR)/objects.h  \
***************
*** 1154,1159 ****
--- 1197,1203 ----
  sorDEP                  = $(SRCDIR)/sor.c      \
                            $(SRCDIR)/atmosph.h  \
                            $(SRCDIR)/bbox.h     \
+                           $(SRCDIR)/bcyl.h     \
                            $(SRCDIR)/camera.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
***************
*** 1229,1235 ****
                            $(SRCDIR)/camera.h   \
                            config.h             \
                            $(SRCDIR)/frame.h    \
-                           $(SRCDIR)/halos.h    \
                            $(SRCDIR)/image.h    \
                            $(SRCDIR)/matrices.h \
                            $(SRCDIR)/normal.h   \
--- 1273,1278 ----
***************
*** 1470,1476 ****
  $(ODIR)/bbox$(OBJ)     : $(bboxDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/bbox.c -o $@
  
! $(ODIR)/bcyl$(OBJ)     : $(bcylDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/bcyl.c -o $@
  
  $(ODIR)/bezier$(OBJ)   : $(bezierDEP)
--- 1513,1519 ----
  $(ODIR)/bbox$(OBJ)     : $(bboxDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/bbox.c -o $@
  
! $(ODIR)/bcyl$(OBJ)    : $(bcylDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/bcyl.c -o $@
  
  $(ODIR)/bezier$(OBJ)   : $(bezierDEP)
***************
*** 1515,1523 ****
  $(ODIR)/gifdecod$(OBJ) : $(gifdecodDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/gifdecod.c -o $@
  
- $(ODIR)/halos$(OBJ)    : $(halosDEP)
- 	$(CC) $(CFLAGS) $(SRCDIR)/halos.c -o $@
- 
  $(ODIR)/hcmplx$(OBJ)   : $(hcmplxDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/hcmplx.c -o $@
  
--- 1558,1563 ----
***************
*** 1530,1535 ****
--- 1570,1578 ----
  $(ODIR)/image$(OBJ)    : $(imageDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/image.c -o $@
  
+ $(ODIR)/interior$(OBJ)    : $(interiorDEP)
+ 	$(CC) $(CFLAGS) $(SRCDIR)/interior.c -o $@
+ 
  $(ODIR)/lathe$(OBJ)    : $(latheDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/lathe.c -o $@
  
***************
*** 1541,1546 ****
--- 1584,1592 ----
  
  $(ODIR)/matrices$(OBJ) : $(matricesDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/matrices.c -o $@
+ 
+ $(ODIR)/media$(OBJ)    : $(mediaDEP)
+ 	$(CC) $(CFLAGS) $(SRCDIR)/media.c -o $@
  
  $(ODIR)/mem$(OBJ)      : $(memDEP)
  	$(CC) $(CFLAGS) $(SRCDIR)/mem.c -o $@
