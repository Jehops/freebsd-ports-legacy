--- Makefile.orig	Tue May  4 23:57:09 2004
+++ Makefile	Thu May  6 04:12:47 2004
@@ -1,39 +1,36 @@
-PREFIX = /usr/local
-INSTALL = install
-
 BINDIR = $(PREFIX)/bin
 
 VERSION = 0.9
 
 #DEBUG = -g
-OPTIMIZE = -O2
+#OPTIMIZE = -O2
 #PROFILE = -pg
 
-MACOS_LDOPTS = -L/sw/lib
-MACOS_CCOPTS = -I/sw/include
+#MACOS_LDOPTS = -L/sw/lib
+#MACOS_CCOPTS = -I/sw/include
 
-LDOPTS = $(MACOS_LDOPTS) -L/usr/X11R6/lib $(PROFILE) $(DEBUG)
-CCOPTS = $(MACOS_CCOPTS) -I/usr/X11R6/include -I/usr/X11R6/include/X11 -I. -Wall $(OPTIMIZE) $(DEBUG) $(PROFILE) -DMETAPIXEL_VERSION=\"$(VERSION)\"
-CC = gcc
+LDOPTS = ${LDFLAGS} $(PROFILE) $(DEBUG)
+CCOPTS = ${CFLAGS} ${CPPFLAGS} -Wall $(DEBUG) $(PROFILE) -DMETAPIXEL_VERSION=\"$(VERSION)\"
+#CC = gcc
 #LIBFFM = -lffm
 
-OBJS = metapixel.o vector.o zoom.o rwpng.o rwjpeg.o readimage.o writeimage.o lispreader.o getopt.o getopt1.o
-CONVERT_OBJS = convert.o lispreader.o getopt.o getopt1.o
+OBJS = metapixel.o vector.o zoom.o rwpng.o rwjpeg.o readimage.o writeimage.o lispreader.o
+CONVERT_OBJS = convert.o lispreader.o
 IMAGESIZE_OBJS = imagesize.o rwpng.o rwjpeg.o readimage.o
 
-all : metapixel convert imagesize
+all : metapixel metapixel-convert metapixel-imagesize metapixel-zoom
 
 metapixel : $(OBJS)
 	$(CC) $(LDOPTS) -o metapixel $(OBJS) -lpng -ljpeg $(LIBFFM) -lm -lz
 
-convert : $(CONVERT_OBJS)
-	$(CC) $(LDOPTS) -o convert $(CONVERT_OBJS)
+metapixel-convert : $(CONVERT_OBJS)
+	$(CC) $(LDOPTS) -o metapixel-convert $(CONVERT_OBJS)
 
-imagesize : $(IMAGESIZE_OBJS)
-	$(CC) $(LDOPTS) -o imagesize $(IMAGESIZE_OBJS) -lpng -ljpeg -lm -lz
+metapixel-imagesize : $(IMAGESIZE_OBJS)
+	$(CC) $(LDOPTS) -o metapixel-imagesize $(IMAGESIZE_OBJS) -lpng -ljpeg -lm -lz
 
-zoom : zoom.c rwjpeg.c rwpng.c readimage.c writeimage.c
-	$(CC) -o zoom $(OPTIMIZE) $(PROFILE) $(MACOS_CCOPTS) -DTEST_ZOOM zoom.c rwjpeg.c rwpng.c readimage.c writeimage.c $(MACOS_LDOPTS) -lpng -ljpeg -lm -lz
+metapixel-zoom : zoom.c rwjpeg.c rwpng.c readimage.c writeimage.c
+	$(CC) $(CCOPTS) $(LDFLAGS) -o metapixel-zoom -DTEST_ZOOM zoom.c rwjpeg.c rwpng.c readimage.c writeimage.c -lpng -ljpeg -lm -lz
 
 %.o : %.c
 	$(CC) $(CCOPTS) -c $<
