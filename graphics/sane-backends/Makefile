# New ports collection makefile for:	sane-backends
# Date created:			Sat Jul 19 16:23:10 MET DST 1997
# Whom:				gary@hotlava.com
#
# $FreeBSD$
#

PORTNAME=	sane-backends
PORTVERSION=	1.0.7
PORTREVISION=	1
CATEGORIES=	graphics
MASTER_SITES=	ftp://ftp.mostang.com/pub/sane/%SUBDIR%/ \
		ftp://ftp.de.mostang.com/pub/sane/%SUBDIR%/ \
		ftp://ftp.no.mostang.com/pub/sane/%SUBDIR%/
MASTER_SITE_SUBDIR=	sane-${PORTVERSION}

MAINTAINER=	ports@FreeBSD.org

LIB_DEPENDS=	usb-0.1.5:${PORTSDIR}/devel/libusb \
		jpeg.9:${PORTSDIR}/graphics/jpeg

USE_GMAKE=	yes
USE_LIBTOOL=	yes
CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include -DHAVE_UNION_SEMUN" \
		LIBS="-L${LOCALBASE}/lib"
MAKE_ENV=	NOPORTDOCS=${NOPORTDOCS}
INSTALLS_SHLIB=	yes

MAN1=	sane-find-scanner.1 saned.1 scanimage.1
MAN5=	sane-abaton.5 sane-agfafocus.5 sane-apple.5 sane-artec.5 sane-as6e.5 \
	sane-avision.5 sane-bh.5 sane-canon.5 sane-coolscan.5 sane-dc210.5 \
	sane-dc240.5 sane-dc25.5 sane-dll.5 sane-dmc.5 sane-epson.5 \
	sane-fujitsu.5 sane-gphoto2.5 sane-hp.5 sane-microtek.5 \
	sane-microtek2.5 sane-mustek.5 sane-mustek_pp.5 sane-mustek_usb.5 \
	sane-nec.5 sane-net.5 sane-pie.5 sane-pint.5 sane-plustek.5 \
	sane-pnm.5 sane-qcam.5 sane-ricoh.5 sane-s9036.5 sane-scsi.5 \
	sane-sharp.5 sane-sm3600.5 sane-snapscan.5 sane-st400.5 \
	sane-tamarack.5 sane-umax.5 sane-umax1220u.5 sane-umax_pp.5 \
	sane-usb.5 sane-v4l.5
MAN7=	sane.7

.if defined(WITH_GPHOTO2)
LIB_DEPENDS+=	gphoto2.2:${PORTSDIR}/graphics/gphoto2
CONFIGURE_ARGS+=	--with-gphoto2=yes
PLIST_SUB+=	GPHOTO2=""
.else
PLIST_SUB+=	GPHOTO2="@comment "
.endif

pre-everything::
.if !defined(WITH_GPHOTO2)
	@${ECHO_MSG}
	@${ECHO_MSG} "If you want to compile with gPhoto2 support,"
	@${ECHO_MSG} "hit Ctrl-C right now and use \"make WITH_GPHOTO2=yes\""
	@${ECHO_MSG}
.endif

post-patch:
	@${PERL} -pi -e 's| -I/usr/local/include||g ; \
		 s|2.0beta5dev1|2.0|g' ${WRKSRC}/configure

.include <bsd.port.mk>
