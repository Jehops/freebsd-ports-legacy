--- makefile.orig	Sat Nov  4 02:49:46 2000
+++ makefile	Tue Jul 17 01:42:30 2001
@@ -2,8 +2,8 @@
 GDC_LIB  = .
 
 # GDChart requires the gd library - www.boutell.com/gd/
-GD_INCL  = ../gd-1.8.3
-GD_LIB   = ../gd-1.8.3
+GD_INCL  = $(LOCALBASE)/include/gd
+GD_LIB   = $(LOCALBASE)/lib
 
 # libgd requires libpng
 # PNG_INCL = ../libpng-1.0.8
@@ -23,6 +23,8 @@
 # if not installed in standard paths (/lib, /usr/lib), or LD_LIBRARY_PATH
 # LIB_PATHS   = -L$(GD_LIB) -L$(PNG_LIB) -L$(ZLIB_LIB) -L$(JPEG_LIB)
 
+LIB_OBJS    = gdc.o gdc_pie.o gdchart.o price_conv.o gifencode.o
+
 # NOTE:
 # libpng, libz, etc. are usually linked in as dynamic libs
 # either use a link line similar to one of these, or set environment LD_LIBRARY_PATH
@@ -30,62 +32,66 @@
 # LIB_PATHS = $(LIB_PATHS) -R$(PNG_LIB) -R$(ZLIB_LIB)
 # LIB_PATHS = $(LIB_PATHS) -Xlinker -rpath -Xlinker $(PNG_LIB) -Xlinker -rpath -Xlinker $(ZLIB_LIB)
 
-CC=gcc
-
-all: gdc_samp1 gdc_samp2 gdc_pie_samp
+all: libgdchart.a
 
 # --- compile the samples ---
-gdc_pie_samp.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdcpie.h gdc_pie_samp.c
-	$(CC) -I$(GDC_INCL) -c gdc_pie_samp.c
+#gdc_pie_samp.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdcpie.h gdc_pie_samp.c
+#	$(CC) $(CFLAGS) -I$(GDC_INCL) -c gdc_pie_samp.c
 
-gdc_samp1.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdchart.h gdc_samp1.c
-	$(CC) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_samp1.c
+#gdc_samp1.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdchart.h gdc_samp1.c
+#	$(CC) $(CFLAGS) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_samp1.c
 
-gdc_samp2.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdchart.h gdc_samp2.c
-	$(CC) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_samp2.c
+#gdc_samp2.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gdchart.h gdc_samp2.c
+#	$(CC) $(CFLAGS) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_samp2.c
 
 # --- link the samples ---
-gdc_samp1: gdc.o gdchart.o price_conv.o gdc_samp1.o gifencode.o $(GD_LIB)/libgd.a
-	$(CC) -o gdc_samp1 \
-			 gdc.o gdchart.o price_conv.o gifencode.o \
-			 gdc_samp1.o \
-			 $(LIB_PATHS) \
-			 -lgd -lz -lpng $(JPEG_LK) -lm
-
-gdc_samp2: gdc.o gdchart.o price_conv.o gdc_samp2.o gifencode.o $(GD_LIB)/libgd.a
-	$(CC) -o gdc_samp2 \
-			 gdc.o gdchart.o price_conv.o gifencode.o \
-			 gdc_samp2.o \
-			 $(LIB_PATHS) \
-			 -lgd -lz -lpng $(JPEG_LK) -lm
-
-gdc_pie_samp: gdc.o gdc_pie.o price_conv.o gdc_pie_samp.o gifencode.o $(GD_LIB)/libgd.a
-	$(CC) -o gdc_pie_samp \
-			 gdc.o gdc_pie.o price_conv.o gifencode.o \
-			 gdc_pie_samp.o \
-			 $(LIB_PATHS) \
-			 -lgd -lz -lpng $(JPEG_LK) -lm
+#gdc_samp1: gdc.o gdchart.o price_conv.o gdc_samp1.o gifencode.o $(GD_LIB)/libgd.a
+#	$(CC) $(CFLAGS) -o gdc_samp1 \
+#			 gdc.o gdchart.o price_conv.o gifencode.o \
+#			 gdc_samp1.o \
+#			 $(LIB_PATHS) \
+#			 -lgd -lz -lpng $(JPEG_LK) -lm
+
+#gdc_samp2: gdc.o gdchart.o price_conv.o gdc_samp2.o gifencode.o $(GD_LIB)/libgd.a
+#	$(CC) $(CFLAGS) -o gdc_samp2 \
+#			 gdc.o gdchart.o price_conv.o gifencode.o \
+#			 gdc_samp2.o \
+#			 $(LIB_PATHS) \
+#			 -lgd -lz -lpng $(JPEG_LK) -lm
+
+#gdc_pie_samp: gdc.o gdc_pie.o price_conv.o gdc_pie_samp.o gifencode.o $(GD_LIB)/libgd.a
+#	$(CC) $(CFLAGS) -o gdc_pie_samp \
+#			 gdc.o gdc_pie.o price_conv.o gifencode.o \
+#			 gdc_pie_samp.o \
+#			 $(LIB_PATHS) \
+#			 -lgd -lz -lpng $(JPEG_LK) -lm
 
 # --- compile the lib ---
 gifencode.o: gifencode.c gifencode.h
-	$(CC) -I$(GD_INCL) -c gifencode.c
+	$(CC) $(CFLAGS) -I$(GD_INCL) -c gifencode.c
 
 price_conv.o: price_conv.c
-	$(CC) -c price_conv.c
+	$(CC) $(CFLAGS) -c price_conv.c
 
 gdc.o: gdc.c $(GDC_INCL)/gdc.h $(GDC_INCL)/gifencode.h
-	$(CC) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdc.c
+	$(CC) $(CFLAGS) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdc.c
 
 gdc_pie.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gifencode.h $(GDC_INCL)/gdcpie.h gdc_pie.c
-	$(CC) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_pie.c
+	$(CC) $(CFLAGS) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdc_pie.c
 
 gdchart.o: $(GDC_INCL)/gdc.h $(GDC_INCL)/gifencode.h $(GDC_INCL)/gdchart.h gdchart.c
-	$(CC) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdchart.c
+	$(CC) $(CFLAGS) -I$(GD_INCL) -I$(GDC_INCL) $(JPEG_DEF) -c gdchart.c
 
 # --- supporting libraries ---
 # should be compile & installed separately
 # $(GD_LIB)/libgd.a:
 # 	cd $(GD_LIB) ; make -f Makefile libgd.a
+
+libgdchart.a: $(LIB_OBJS)
+	$(AR) rc libgdchart.a $(LIB_OBJS)
+	@if [ -x $(RANLIB) ] ; then \
+	  $(RANLIB) libgdchart.a; \
+	fi;
 
 # --- clean ---
 clean:
