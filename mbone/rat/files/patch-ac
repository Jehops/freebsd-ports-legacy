--- rat/configure.in.orig	Thu Sep 21 10:50:51 2000
+++ rat/configure.in	Thu Sep 21 10:51:20 2000
@@ -1,5 +1,5 @@
 dnl UCL RAT configure script.
-dnl $Header: /cs/research/mice/starship/src/local/CVS_repository/rat/configure.in,v 1.38 2000/03/23 10:00:53 ucacoxh Exp $
+dnl $Header: /cs/research/mice/starship/src/local/CVS_repository/rat/configure.in,v 1.39 2000/09/16 17:43:25 ucacoxh Exp $
 dnl
 dnl Process this file with GNU autoconf to generate a configure script.
 
@@ -195,9 +195,12 @@
 		AU_OBJ="$AU_OBJ auddev_pca.o"
 		AC_DEFINE(HAVE_PCA_AUDIO)
 	fi
-	# Luigi's driver
-	AU_OBJ="$AU_OBJ auddev_luigi.o"
-	AC_DEFINE(HAVE_LUIGI_AUDIO)
+	# Note luigi and newpcm have compatible soundcard.h files but
+	# mixer behaves differently under both systems.  During runtime
+	# only one of these modules will be used.
+	AU_OBJ="$AU_OBJ auddev_luigi.o auddev_newpcm.o"
+	AC_DEFINE(HAVE_LUIGI_AUDIO) 
+  	AC_DEFINE(HAVE_NEWPCM_AUDIO) 
 	;;
 *netbsd*)
 	AU_OBJ="$AUDIOBJ auddev_netbsd.o"
@@ -277,12 +280,12 @@
 # We could be dealing with a source installation or a full installation.
 # Expect a source installation to have headers in TCL8_HOME/generic and libs in
 # TCL8_HOME/unix.  A full installation should have headers in 
-# INSTDIR/include/tcl8.0, or INSTDIR/include, and have libraries be in 
+# INSTDIR/include/tcl8.2, or INSTDIR/include, and have libraries be in 
 # INSTDIR/lib.
 #------------------------------------------------------------------------------
 PARENT=`echo $PWD | sed -e 's%/[[^/]]*$%%'`
-TCL_INC=${PARENT}/tcl-8.0
-TCL_LIB=${PARENT}/tcl-8.0
+TCL_INC=${PARENT}/tcl-8.2
+TCL_LIB=${PARENT}/tcl-8.2
 
 AC_ARG_WITH(tcl,           
 	[  --with-tcl=DIR          specify location of Tcl installation],
@@ -292,7 +295,7 @@
 #-----------------------------------------------------------------------------
 # Depending on config expect tcl.h to be tcl source dir or include path
 #-----------------------------------------------------------------------------
-for i in $TCL_INC/generic $TCL_INC/include/tcl8.0 $TCL_INC/include $TCL_INC
+for i in $TCL_INC/generic $TCL_INC/include/tcl8.2 $TCL_INC/include $TCL_INC
 do
 	if test -d $i ; then
 		TCL_INC=$i
@@ -327,7 +330,7 @@
 SAVED_LIBS=$LIBS
 LIBS=""
 FOUND_TCL_LIB=no
-AC_SEARCH_LIBS(Tcl_Init, tcl8.0 tcl80, 
+AC_SEARCH_LIBS(Tcl_Init, tcl8.2 tcl82, 
 	FOUND_TCL_LIB=yes,
 	, 
 	-L${TCL_LIB} ${SAVED_LIBS} -lm)
@@ -343,8 +346,8 @@
 	exit
 fi
 
-TK_INC=${PARENT}/tk-8.0
-TK_LIB=${PARENT}/tk-8.0
+TK_INC=${PARENT}/tk-8.2
+TK_LIB=${PARENT}/tk-8.2
 
 AC_ARG_WITH(tk,           
 	[  --with-tk=DIR           specify location of Tk installation],
@@ -356,7 +359,7 @@
 # include tcl.h, Xlib.h, Xutil.h before tk.h.
 #-----------------------------------------------------------------------------
 FOUND_TK_INC=0
-for i in $TK_INC/generic $TK_INC/include/tk8.0 $TK_INC/include $TK_INC
+for i in $TK_INC/generic $TK_INC/include/tk8.2 $TK_INC/include $TK_INC
 do
 	AC_MSG_CHECKING(for $i/tk.h)
 	if test -r $i/tk.h ; then
@@ -388,7 +391,7 @@
 SAVED_LIBS=$LIBS
 LIBS=""
 FOUND_TK_LIB=no
-AC_SEARCH_LIBS(Tk_Init, tk8.0 tk80,
+AC_SEARCH_LIBS(Tk_Init, tk8.2 tk82,
 	FOUND_TK_LIB=yes,
 	,
 	-L${TK_LIB} ${TCL_LIB} $X_LIBS $X_PRE_LIBS  -lXext -lX11 $X_EXTRA_LIBS ${SAVED_LIBS} -lm)
@@ -419,7 +422,7 @@
                 AC_DEFINE(HAVE_IPv6)
                 case "$host_os" in
                 # FreeBSD Kame uses seperate libinet6
-                freebsd*)       
+                freebsd[23]*)       
                         LIBS="$LIBS -L/usr/local/v6/lib -linet6"
                         ;;
                 *)      ;;
@@ -463,20 +466,8 @@
 	COMMON_LIB=${COMMON_LIB}/lib
 fi
 
-AC_CHECK_LIB(uclmmbase,
-	mbus_init,
-	[
-		EXTERNAL_DEP="${EXTERNAL_DEP} ${COMMON_LIB}/libuclmmbase.a"
-		COMMON_LIB="-L${COMMON_LIB} -luclmmbase"
-	],
-	[
-		echo "Could not find libuclmmbase.a.  One of the following halted progess:"
-		echo "   (a) Library is not installed."
-		echo "   (b) Library is not built or not in expected location (--with-common=DIR)."
-		echo "   (c) this script failed to see it (please inform rat-trap@cs.ucl.ac.uk)."
-		exit
-	],
-	-L${COMMON_LIB})
+EXTERNAL_DEP="${EXTERNAL_DEP} ${COMMON_LIB}/libuclmmbase.a"
+COMMON_LIB="-L${COMMON_LIB} -luclmmbase"
 
 AC_SUBST(COMMON_INC)
 AC_SUBST(COMMON_LIB)
