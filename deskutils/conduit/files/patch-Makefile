--- Makefile.orig	Wed Sep 20 05:08:31 2006
+++ Makefile	Tue Oct 10 21:01:22 2006
@@ -2,13 +2,13 @@
 VERSION=`cat conduit/__init__.py | grep 'APPVERSION=\"' | sed -e 's/APPVERSION=//' -e 's/\"//g'`
 
 #Install prefix, can be overridden by setting DESTDIR
-PREFIX=/usr
+PREFIX=%%PREFIX%%
 CWD=`pwd`
 
 #Python version for installation into python dir
 PYTHON_VERSION=2.4
 #PYTHON_VERSION=`python -V 2>&1 | sed -e "s/Python //" | cut --bytes=1-3`
-PYTHON_PATH=$(DESTDIR)$(PREFIX)/lib/python$(PYTHON_VERSION)/site-packages
+PYTHON_PATH=%%PYTHON_SITELIBDIR%%
 
 #Source Files
 SRC=conduit/*.py conduit/dataproviders/*.py conduit/datatypes/*.py
@@ -40,8 +40,8 @@
 	mkdir -p $(DESTDIR)$(PREFIX)/share/conduit/dataproviders
 	mkdir -p $(PYTHON_PATH)/conduit
 	mkdir -p $(PYTHON_PATH)/conduit/datatypes
-	mkdir -p ~/.conduit
-	mkdir -p ~/.conduit/modules
+	mkdir -p .conduit
+	mkdir -p .conduit/modules
 	@for i in `ls contrib`; do \
 		( mkdir -p $(DESTDIR)$(PREFIX)/share/conduit/contrib/$$i ) \
 	done
@@ -52,14 +52,14 @@
 	install -m 644 conduit/data/conduit-icon.png $(DESTDIR)$(PREFIX)/share/pixmaps
 	install -m 644 conduit/data/conduit.glade $(DESTDIR)$(PREFIX)/share/conduit/data
 	install -m 644 conduit/dataproviders/*.py $(DESTDIR)$(PREFIX)/share/conduit/dataproviders
-	install -m 644 conduit.desktop $(DESTDIR)$(PREFIX)/share/applications/
+#	install -m 644 conduit.desktop $(DESTDIR)$(PREFIX)/share/applications/
 	install -m 644 conduit/*.py $(PYTHON_PATH)/conduit
 	install -m 644 conduit/datatypes/*.py $(PYTHON_PATH)/conduit/datatypes
 	install -m 755 conduit/start_conduit.py $(DESTDIR)$(PREFIX)/bin/conduit
 	@for i in `ls contrib`; do \
 		( install -m 644 contrib/$$i/*.py $(DESTDIR)$(PREFIX)/share/conduit/contrib/$$i ) \
 	done
-	ln -sf $(CWD)/doc/ExampleModule.py ~/.conduit/modules/MoinModule.py
+	ln -sf $(CWD)/doc/ExampleModule.py .conduit/modules/MoinModule.py
 
 clean: clean-bin
 	-rm dist-stamp
@@ -101,4 +101,4 @@
 	rm -r $(DESTDIR)$(PREFIX)/share/applications/conduit.desktop
 	rm -r $(PYTHON_PATH)/conduit
 	rm -r $(DESTDIR)$(PREFIX)/bin/conduit
-	rm ~/.conduit/modules/MoinModule.py
+	rm .conduit/modules/MoinModule.py
