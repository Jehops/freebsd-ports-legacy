--- plugins/org.eclipse.swt.gtk.freebsd.amd64/build.xml.orig	2008-08-02 20:56:10.950055571 -0400
+++ plugins/org.eclipse.swt.gtk.freebsd.amd64/build.xml	2008-08-02 20:58:39.830970324 -0400
@@ -273,6 +273,9 @@
 	<target name="build.cfiles" depends="build.jars">
 		<!-- generate the C code from the (64 bit) SWT PI java classes -->
 		<!-- assumes the swt.jar has already been built  -->
+		<!-- <ant antfile="build.xml" dir="${toolsplugindir}" inheritAll="false" target="build.jars" />-->
+		<!-- assumes the swttools.jar has already been built  -->
+		<echo message="Generating jni C files"/>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.C"/><arg value="${basedir}/src/Eclipse SWT PI/common/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.gtk.OS"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.accessibility.gtk.ATK"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
@@ -287,21 +290,27 @@
 		<!-- since this is the structure assumed by the native makefile and given that     -->
 		<!-- this script needs to work outside of the Eclipse workspace without modifying  -->
 		<!-- the content of the org.eclipse.swt project.                                   -->
-		<mkdir dir="${basedir}/src/bin/library"/>
-		<copy todir="${basedir}/src/bin/library">
-			<fileset dir="${basedir}/src/Eclipse SWT/common/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT AWT/gtk/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT Mozilla/common/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT OpenGL/glx/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT PI/cairo/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT PI/gtk/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT PI/common/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT Program/cde/library"/>
-			<fileset dir="${basedir}/src/Eclipse SWT Program/gnome/library"/>
+		<echo message="${build.result.folder}"/>
+		<mkdir dir="${basedir}/gtk/library"/>
+		<copy todir="${basedir}/gtk/library">
+			<fileset dir="${basedir}/src/Eclipse SWT/common/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT AWT/gtk/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT Mozilla/common/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT OpenGL/glx/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT PI/common/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT PI/cairo/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT PI/gtk/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT PI/common/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT Program/cde/library/"/>
+			<fileset dir="${basedir}/src/Eclipse SWT Program/gnome/library/"/>
 		</copy>
 	</target>
 
+	<target name="build.jnilibs" depends="build.nativeLibraries"/>
+
 	<target name="build.nativeLibraries" depends="build.cfiles" description="Build 64 bit native libraries without changing the content of org.eclipse.swt">
+	<echo message="Building Native Libraries"/>
+	<!--
 		<property name="sourcedir" value="${basedir}/src/bin/library" />
 	    <property name="lib_destdir" value="${sourcedir}/../../../../${fragment}" />
 		<tstamp/>
@@ -317,6 +326,12 @@
 		<copy todir="${lib_destdir}">
 			<fileset dir="${sourcedir}/" includes="*.so"/>
 		</copy>
+	-->
+		<exec dir="${build.result.folder}/gtk/library" executable="sh">
+			<env key="OUTPUT_DIR" value="${build.result.folder}"/>
+			<arg line="${build.result.folder}/gtk/library/build.sh"/>
+			<arg line="install"/>
+		</exec>
 	</target>
 
 	<target name="build.zips" depends="init">
