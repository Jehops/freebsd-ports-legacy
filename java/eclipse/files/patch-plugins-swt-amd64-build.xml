--- plugins/org.eclipse.swt.gtk.freebsd.amd64/build.xml.orig	Mon Dec 11 01:10:05 2006
+++ plugins/org.eclipse.swt.gtk.freebsd.amd64/build.xml	Mon Dec 11 01:20:33 2006
@@ -39,18 +39,17 @@
 
 	<target name="properties" if="eclipse.running">
 		<property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
-		<!--compile the jar in org.eclipse.swt.tools-->
 	</target>
 
 	<target name="build.update.jar" depends="init">
-		<delete dir="${temp.folder}"/>
+		<!-- <delete dir="${temp.folder}"/>
 		<mkdir dir="${temp.folder}"/>
 		<antcall target="build.jars"/>
 		<antcall target="gather.bin.parts">
 			<param name="destination.temp.folder" value="${temp.folder}/"/>
 		</antcall>
 		<zip zipfile="${plugin.destination}/${full.name}.jar" basedir="${temp.folder}/${full.name}" filesonly="false"/>
-		<delete dir="${temp.folder}"/>
+		<delete dir="${temp.folder}"/> -->
 	</target>
 
 	<target name="@dot" depends="init" unless="@dot" description="Create jar: @dot.">
@@ -222,8 +221,11 @@
 	</target>
 
 	<target name="build.cfiles" depends="build.jars">
+		<!-- compile the jar in org.eclipse.swt.tools -->
+		<ant antfile="build.xml" dir="${toolsplugindir}" inheritAll="false" target="build.jars" />		
+
 		<!-- generate the C code from the (64 bit) SWT PI java classes -->
-		<!-- assumes the swt.jar has already been built  -->
+		<!-- assumes the swttools.jar has already been built  -->
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.gtk.OS"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.accessibility.gtk.ATK"/><arg value="${basedir}/src/Eclipse SWT PI/gtk/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
 		<java classname="org.eclipse.swt.tools.internal.JNIGeneratorApp" classpath="${toolsplugindir}/bin:${toolsplugindir}/swttools.jar:${basedir}/swt.jar"><arg value="org.eclipse.swt.internal.cairo.Cairo"/><arg value="${basedir}/src/Eclipse SWT PI/cairo/library/"/><arg value="${build.result.folder}/swt.jar"/></java>
@@ -325,6 +327,8 @@
 		<delete file="${plugin.destination}/${full.name}.jar"/>
 		<delete file="${plugin.destination}/${full.name}.zip"/>
 		<delete dir="${temp.folder}"/>
+		<!-- delete swttools.jar so that it will be compiled in the build.jars target -->
+		<ant antfile="build.xml" dir="${toolsplugindir}" inheritAll="false" target="clean" />
 	</target>
 
 	<target name="refresh" depends="init" if="eclipse.running">
