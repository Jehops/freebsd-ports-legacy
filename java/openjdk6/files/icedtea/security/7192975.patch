# HG changeset patch
# User asaha
# Date 1349309813 25200
# Node ID d77bc9151c1dea1a4a396fb59d58ba7c8d77fd88
# Parent  aa1fa3f96d77541a3bafd767001f3100fe6b8a5a
7192975: Conditional usage check is wrong
Reviewed-by: dsamersoff
Contributed-by: andreas.eriksson@oracle.com

diff --git a/src/share/classes/javax/management/modelmbean/DescriptorSupport.java b/src/share/classes/javax/management/modelmbean/DescriptorSupport.java
--- jdk/src/share/classes/javax/management/modelmbean/DescriptorSupport.java
+++ jdk/src/share/classes/javax/management/modelmbean/DescriptorSupport.java
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2000, 2007, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
@@ -1239,13 +1239,12 @@
             return s.substring(1, s.length() - 1);
         }
         final String className = s.substring(1, slash);
+        
         final Constructor<?> constr;
         try {
+            ReflectUtil.checkPackageAccess(className);
             final ClassLoader contextClassLoader =
                 Thread.currentThread().getContextClassLoader();
-            if (contextClassLoader == null) {
-                ReflectUtil.checkPackageAccess(className);
-            }
             final Class<?> c =
                 Class.forName(className, false, contextClassLoader);
             constr = c.getConstructor(new Class[] {String.class});
