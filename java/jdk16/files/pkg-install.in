#!/bin/sh

# System preference location
JRE_HOME=%%JRE_HOME%%

# Post-install actions
if [ "$2" = "POST-INSTALL" ]; then
	# Set up system preferences
	if [ ! -d "${JRE_HOME}/.systemPrefs" ] ; then
		mkdir -m 755 "${JRE_HOME}/.systemPrefs"
	fi
	if [ ! -f "${JRE_HOME}/.systemPrefs/.system.lock" ] ; then
		touch "${JRE_HOME}/.systemPrefs/.system.lock"
		chmod 644 "${JRE_HOME}/.systemPrefs/.system.lock"
	fi
	if [ ! -f "${JRE_HOME}/.systemPrefs/.systemRootModFile" ] ; then
		touch "${JRE_HOME}/.systemPrefs/.systemRootModFile"
		chmod 644 "${JRE_HOME}/.systemPrefs/.systemRootModFile"
	fi

	# Set up class data sharing
	if [ -x "${JRE_HOME}/bin/java" ]; then
		"${JRE_HOME}/bin/java" -client -Xshare:dump
	fi
fi
