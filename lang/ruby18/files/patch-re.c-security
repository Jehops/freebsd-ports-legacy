--- re.c.orig	Thu Jul 13 01:48:12 2006
+++ re.c	Thu Jul 13 01:49:45 2006
@@ -1330,6 +1330,8 @@
 {
     struct RRegexp *re = RREGEXP(obj);
 
+    if (!OBJ_TAINTED(obj) && rb_safe_level() >= 4)
+	rb_raise(rb_eSecurityError, "Insecure: can't modify regexp");
     if (re->ptr) re_free_pattern(re->ptr);
     if (re->str) free(re->str);
     re->ptr = 0;
