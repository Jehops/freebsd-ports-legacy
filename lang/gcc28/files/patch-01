--- config/i386/freebsd.h.orig	Sun Oct 19 09:31:05 1997
+++ config/i386/freebsd.h	Thu May 21 14:10:11 1998
@@ -35,10 +35,19 @@
 #include "i386/perform.h"
 
 #undef CPP_PREDEFINES
-#define CPP_PREDEFINES "-Dunix -Di386 -D__FreeBSD__ -D__386BSD__ -Asystem(unix) -Asystem(FreeBSD) -Acpu(i386) -Amachine(i386)"
+#define CPP_PREDEFINES "-Dunix -Di386 -D__FreeBSD__=2 -Asystem(unix) -Asystem(FreeBSD) -Acpu(i386) -Amachine(i386)"
+
+/* need "-fsjlj-exceptions" (use setjmp/longjmp for exceptions) the default.
+   The standard exception implementation reliably
+   dumps core under FreeBSD.  Users can put "-fno-sjlj-exceptions" on
+   the command line if they really want to override the new default. */
+#ifdef CC1PLUS_SPEC
+#error "CC1PLUS_SPEC needs ``-fsjlj-exceptions'', but is already defined."
+#endif
+#define CC1PLUS_SPEC "-fsjlj-exceptions"
 
 /* Like the default, except no -lg.  */
-#define LIB_SPEC "%{!p:%{!pg:-lc}}%{p:-lc_p}%{pg:-lc_p}"
+#define LIB_SPEC "%{!shared:%{!pg:-lc}%{pg:-lc_p}}"
 
 #undef SIZE_TYPE
 #define SIZE_TYPE "unsigned int"
@@ -215,7 +224,15 @@
 
 #define ASM_SPEC   " %| %{fpic:-k} %{fPIC:-k}"
 #define LINK_SPEC \
-  "%{!nostdlib:%{!r*:%{!e*:-e start}}} -dc -dp %{static:-Bstatic} %{assert*}"
+  "%{p:%e`-p' not supported; use `-pg' and gprof(1)} \
+  %{shared:-Bshareable} \
+  %{!shared:%{!nostdlib:%{!r:%{!e*:-e start}}} -dc -dp %{static:-Bstatic} \
+  %{pg:-Bstatic} %{Z}} \
+  %{assert*} %{R*}"
+
+#define STARTFILE_SPEC  \
+  "%{shared:c++rt0.o%s} \
+  %{!shared:%{pg:gcrt0.o%s}%{!pg:%{static:scrt0.o%s}%{!static:crt0.o%s}}}"
 
 /* This is defined when gcc is compiled in the BSD-directory-tree, and must
  * make up for the gap to all the stuff done in the GNU-makefiles.
