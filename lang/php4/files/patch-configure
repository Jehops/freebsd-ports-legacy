--- configure.orig	Thu Jun 19 00:06:29 2003
+++ configure	Thu Jun 19 11:27:23 2003
@@ -54325,8 +54325,8 @@
   
   echo $ac_n "checking Oracle version""... $ac_c" 1>&6
 echo "configure:54328: checking Oracle version" >&5
-  if test -s "$ORACLE_DIR/orainst/unix.rgs"; then
-  	ORACLE_VERSION=`grep '"ocommon"' $ORACLE_DIR/orainst/unix.rgs | sed 's/  */:/g' | cut -d: -f 6 | cut -c 2-4`
+  if test -s "$ORACLE_DIR/ocommon/install/partial.prd"; then
+  	ORACLE_VERSION=`grep '"ocommon"' $ORACLE_DIR/ocommon/install/partial.prd | sed 's/  */:/g' | cut -d: -f 6 | cut -c 2-4`
 	test -z "$ORACLE_VERSION" && ORACLE_VERSION=7.3
   elif test -f $ORACLE_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.9.0; then
     ORACLE_VERSION=9.0
@@ -56589,6 +56589,102 @@
 	    
 
   if test "$ext_shared" = "yes"; then
+    ORACLE_SHARED_LIBADD="-lwrap $ORACLE_SHARED_LIBADD"
+    if test -n "$ORACLE_DIR/lib"; then
+      
+  if test "$ORACLE_DIR/lib" != "/usr/lib"; then
+    
+  if test -z "$ORACLE_DIR/lib" || echo "$ORACLE_DIR/lib" | grep '^/' >/dev/null ; then
+    ai_p=$ORACLE_DIR/lib
+  else
+    
+    ep_dir="`echo $ORACLE_DIR/lib|sed 's%/*[^/][^/]*/*$%%'`"
+    
+    ep_realdir="`(cd \"$ep_dir\" && pwd)`"
+    ai_p="$ep_realdir/`basename \"$ORACLE_DIR/lib\"`"
+  fi
+
+    
+      if test "$ext_shared" = "yes"; then
+        ORACLE_SHARED_LIBADD="$ld_runpath_switch$ai_p -L$ai_p $ORACLE_SHARED_LIBADD"
+      else
+        
+  
+  
+  unique=`echo $ai_p|sed 's/[^a-zA-Z0-9]/_/g'`
+  
+  cmd="echo $ac_n \"\$LIBPATH$unique$ac_c\""
+  if test -n "$unique" && test "`eval $cmd`" = "" ; then
+    eval "LIBPATH$unique=set"
+    
+    test -n "$ld_runpath_switch" && LDFLAGS="$LDFLAGS $ld_runpath_switch$ai_p"
+    LDFLAGS="$LDFLAGS -L$ai_p"
+    PHP_RPATHS="$PHP_RPATHS $ai_p"
+  
+  fi
+
+
+      fi
+    
+  fi
+
+    fi
+  else
+    
+
+  if test -n "$ORACLE_DIR/lib"; then
+    
+  if test "$ORACLE_DIR/lib" != "/usr/lib"; then
+    
+  if test -z "$ORACLE_DIR/lib" || echo "$ORACLE_DIR/lib" | grep '^/' >/dev/null ; then
+    ai_p=$ORACLE_DIR/lib
+  else
+    
+    ep_dir="`echo $ORACLE_DIR/lib|sed 's%/*[^/][^/]*/*$%%'`"
+    
+    ep_realdir="`(cd \"$ep_dir\" && pwd)`"
+    ai_p="$ep_realdir/`basename \"$ORACLE_DIR/lib\"`"
+  fi
+
+    
+      
+  
+  
+  unique=`echo $ai_p|sed 's/[^a-zA-Z0-9]/_/g'`
+  
+  cmd="echo $ac_n \"\$LIBPATH$unique$ac_c\""
+  if test -n "$unique" && test "`eval $cmd`" = "" ; then
+    eval "LIBPATH$unique=set"
+    
+    test -n "$ld_runpath_switch" && LDFLAGS="$LDFLAGS $ld_runpath_switch$ai_p"
+    LDFLAGS="$LDFLAGS -L$ai_p"
+    PHP_RPATHS="$PHP_RPATHS $ai_p"
+  
+  fi
+
+
+    
+  fi
+
+  fi
+  
+  
+  case wrap in
+  c|c_r|pthread*) ;;
+  *) 
+      LIBS="-lwrap $LIBS" 
+   ;;
+  esac
+
+
+
+
+  fi
+
+
+	    
+
+  if test "$ext_shared" = "yes"; then
     ORACLE_SHARED_LIBADD="-lnlsrtl3 $ORACLE_SHARED_LIBADD"
     if test -n "$ORACLE_DIR/lib"; then
       
@@ -71130,29 +71226,6 @@
   else
     
   
-  case cs in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lcs $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case cs in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lcs $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
   case ct in
   c|c_r|pthread*) ;;
   *) 
@@ -71176,52 +71249,7 @@
 
     
   
-  case comn in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lcomn $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case comn in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lcomn $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
-  case intl in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lintl $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case intl in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lintl $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-  
-    SYBASE_CT_LIBS="-L$SYBASE_CT_LIBDIR -lcs -lct -lcomn -lintl"
+    SYBASE_CT_LIBS="-L$SYBASE_CT_LIBDIR -lct"
   
     
   save_old_LDFLAGS=$LDFLAGS
@@ -71291,37 +71319,6 @@
 
     
   
-else
-  echo "$ac_t""no" 1>&6
-
-    LDFLAGS=$save_old_LDFLAGS
-    unset ac_cv_func_tcl
-     
-      
-  
-  case sybtcl in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lsybtcl $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case sybtcl in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lsybtcl $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
 fi
 
   
@@ -84252,10 +84249,7 @@
 CXXFLAGS="$CXXFLAGS $standard_libtool_flag"
 
 all_targets='$(OVERALL_TARGET) $(PHP_MODULES) $(PHP_CLI_TARGET)'
-install_targets="install-sapi install-modules $install_pear install-build install-headers install-programs"
-if test "$PHP_SAPI" != "cgi"; then
-  install_targets="$PHP_INSTALL_CLI_TARGET $install_targets"
-fi
+install_targets="install-sapi $PHP_INSTALL_CLI_TARGET install-modules $install_pear install-build install-headers install-programs"
 
 
   PHP_VAR_SUBST="$PHP_VAR_SUBST all_targets"
