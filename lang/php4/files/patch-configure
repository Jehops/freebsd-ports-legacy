--- configure.orig	Thu Jul 31 00:51:41 2003
+++ configure	Thu Jul 31 08:56:35 2003
@@ -616,6 +616,8 @@
 ac_help="$ac_help
   --enable-gd-jis-conv      GD: Enable JIS-mapped Japanese font support."
 ac_help="$ac_help
+  --enable-gd-lzw-gif       GD: Enable LZW-compressed GIF support."
+ac_help="$ac_help
   --with-gettext[=DIR]    Include GNU gettext support."
 ac_help="$ac_help
   --with-gmp              Include GNU MP support"
@@ -29141,6 +29143,31 @@
 
 
 
+echo $ac_n "checking whether to enable LZW-compressed GIF support in GD""... $ac_c" 1>&6
+echo "configure:28220: checking whether to enable LZW-compressed GIF support in GD" >&5
+# Check whether --enable-gd-lzw-gif or --disable-gd-lzw-gif was given.
+if test "${enable_gd_lzw_gif+set}" = set; then
+  enableval="$enable_gd_lzw_gif"
+  PHP_GD_LZW_GIF=$enableval
+else
+  
+  PHP_GD_LZW_GIF=no
+
+  if test "$PHP_ENABLE_ALL" && test "no" = "yes"; then
+    PHP_GD_LZW_GIF=$PHP_ENABLE_ALL
+  fi
+
+fi
+
+
+ext_output=$PHP_GD_LZW_GIF
+echo "$ac_t""$ext_output" 1>&6
+
+
+
+
+
+
 
 
 
@@ -29293,7 +29320,7 @@
                  libgd/gd_io_file.c libgd/gd_ss.c libgd/gd_io_ss.c libgd/gd_png.c libgd/gd_jpeg.c \
                  libgd/gdxpm.c libgd/gdfontt.c libgd/gdfonts.c libgd/gdfontmb.c libgd/gdfontl.c \
                  libgd/gdfontg.c libgd/gdtables.c libgd/gdft.c libgd/gdcache.c libgd/gdkanji.c \
-                 libgd/wbmp.c libgd/gd_wbmp.c libgd/gdhelpers.c libgd/gd_topal.c libgd/gd_gif_in.c \
+                 libgd/wbmp.c libgd/gd_wbmp.c libgd/gdhelpers.c libgd/gd_topal.c libgd/gd_gif_in.c libgd/gd_biggif_out.c libgd/gd_lzw_out.c libgd/gd_gif_out.c \
                  libgd/xbm.c"
 
   for ac_func in fabsf floorf
@@ -29368,6 +29395,11 @@
   fi
 
   
+  if test "$PHP_GD_LZW_GIF" = "yes"; then
+    USE_GD_LZW_GIF=1
+  fi
+
+  
   if test "$PHP_JPEG_DIR" != "no"; then
 
     for i in /usr /usr/local $PHP_JPEG_DIR; do
@@ -31077,6 +31109,9 @@
 
   cat >> confdefs.h <<\EOF
 #define HAVE_GD_BUNDLED 1
+#define HAVE_GD_GIF_CREATE 1
+#define HAVE_GD_GIF_CTX 1
+#define HAVE_GD_GIF_ANIM 1
 EOF
 
   cat >> confdefs.h <<\EOF
@@ -31127,6 +31162,14 @@
     GDLIB_CFLAGS="$GDLIB_CFLAGS -DJISX0208"
   fi
 
+  if test -n "$USE_GD_LZW_GIF"; then
+    cat >> confdefs.h <<\EOF
+#define LZW_LICENCED 1
+EOF
+
+    GDLIB_CFLAGS="$GDLIB_CFLAGS -DLZW_LICENCED"
+  fi
+
 else
 
  if test "$PHP_GD" != "no"; then
@@ -35474,6 +35517,137 @@
     esac
   done
 
+  echo $ac_n "checking for gdImageGifAnimBegin in -lgd""... $ac_c" 1>&6
+echo "configure:32250: checking for gdImageGifAnimBegin in -lgd" >&5
+ac_lib_var=`echo gd'_'gdImageGifAnimBegin | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lgd  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 32258 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char gdImageGifAnimBegin();
+
+int main() {
+gdImageGifAnimBegin()
+; return 0; }
+EOF
+if { (eval echo configure:32269: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+
+    LDFLAGS=$save_old_LDFLAGS
+    ext_shared=$save_ext_shared
+    cat >> confdefs.h <<\EOF
+#define HAVE_GD_GIF_ANIM 1
+EOF
+
+
+else
+  echo "$ac_t""no" 1>&6
+
+    LDFLAGS=$save_old_LDFLAGS
+    ext_shared=$save_ext_shared
+    unset ac_cv_func_gd
+
+
+fi
+
+
+  save_old_LDFLAGS=$LDFLAGS
+  ac_stuff=" -L$GD_LIB $GD_SHARED_LIBADD "
+
+  save_ext_shared=$ext_shared
+  ext_shared=yes
+
+  for ac_i in $ac_stuff; do
+    case $ac_i in
+    -l*)
+      ac_ii=`echo $ac_i|cut -c 3-`
+
+
+  case $ac_ii in
+  c|c_r|pthread*) ;;
+  *)
+    if test "$ext_shared" = "yes"; then
+        LDFLAGS="$LDFLAGS -l$ac_ii"
+    else
+
+
+  case $ac_ii in
+  c|c_r|pthread*) ;;
+  *)
+      LIBS="$LIBS -l$ac_ii"
+   ;;
+  esac
+
+
+    fi
+   ;;
+  esac
+
+
+    ;;
+    -L*)
+      ac_ii=`echo $ac_i|cut -c 3-`
+
+  if test "$ac_ii" != "/usr/lib"; then
+
+  if test -z "$ac_ii" || echo "$ac_ii" | grep '^/' >/dev/null ; then
+    ai_p=$ac_ii
+  else
+
+    ep_dir="`echo $ac_ii|sed 's%/*[^/][^/]*/*$%%'`"
+
+    ep_realdir="`(cd \"$ep_dir\" && pwd)`"
+    ai_p="$ep_realdir/`basename \"$ac_ii\"`"
+  fi
+
+
+      if test "$ext_shared" = "yes"; then
+        LDFLAGS="$ld_runpath_switch$ai_p -L$ai_p $LDFLAGS"
+      else
+
+
+
+  unique=`echo $ai_p|sed 's/[^a-zA-Z0-9]/_/g'`
+
+  cmd="echo $ac_n \"\$LIBPATH$unique$ac_c\""
+  if test -n "$unique" && test "`eval $cmd`" = "" ; then
+    eval "LIBPATH$unique=set"
+
+    test -n "$ld_runpath_switch" && LDFLAGS="$LDFLAGS $ld_runpath_switch$ai_p"
+    LDFLAGS="$LDFLAGS -L$ai_p"
+    PHP_RPATHS="$PHP_RPATHS $ai_p"
+
+  fi
+
+
+      fi
+
+  fi
+
+    ;;
+    esac
+  done
+
   echo $ac_n "checking for gdCacheCreate in -lgd""... $ac_c" 1>&6
 echo "configure:35479: checking for gdCacheCreate in -lgd" >&5
 ac_lib_var=`echo gd'_'gdCacheCreate | sed 'y%./+-%__p_%'`
@@ -58977,8 +59151,8 @@
   
   echo $ac_n "checking Oracle version""... $ac_c" 1>&6
 echo "configure:58980: checking Oracle version" >&5
-  if test -s "$ORACLE_DIR/orainst/unix.rgs"; then
-  	ORACLE_VERSION=`grep '"ocommon"' $ORACLE_DIR/orainst/unix.rgs | sed 's/  */:/g' | cut -d: -f 6 | cut -c 2-4`
+  if test -s "$ORACLE_DIR/ocommon/install/partial.prd"; then
+  	ORACLE_VERSION=`grep '"ocommon"' $ORACLE_DIR/ocommon/install/partial.prd | sed 's/  */:/g' | cut -d: -f 6 | cut -c 2-4`
 	test -z "$ORACLE_VERSION" && ORACLE_VERSION=7.3
   elif test -f $ORACLE_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.9.0; then
     ORACLE_VERSION=9.0
@@ -60270,6 +60444,102 @@
 	    
 
   if test "$ext_shared" = "yes"; then
+    ORACLE_SHARED_LIBADD="-lwrap $ORACLE_SHARED_LIBADD"
+    if test -n "$ORACLE_DIR/lib"; then
+      
+  if test "$ORACLE_DIR/lib" != "/usr/lib"; then
+    
+  if test -z "$ORACLE_DIR/lib" || echo "$ORACLE_DIR/lib" | grep '^/' >/dev/null ; then
+    ai_p=$ORACLE_DIR/lib
+  else
+    
+    ep_dir="`echo $ORACLE_DIR/lib|sed 's%/*[^/][^/]*/*$%%'`"
+    
+    ep_realdir="`(cd \"$ep_dir\" && pwd)`"
+    ai_p="$ep_realdir/`basename \"$ORACLE_DIR/lib\"`"
+  fi
+
+    
+      if test "$ext_shared" = "yes"; then
+        ORACLE_SHARED_LIBADD="$ld_runpath_switch$ai_p -L$ai_p $ORACLE_SHARED_LIBADD"
+      else
+        
+  
+  
+  unique=`echo $ai_p|sed 's/[^a-zA-Z0-9]/_/g'`
+  
+  cmd="echo $ac_n \"\$LIBPATH$unique$ac_c\""
+  if test -n "$unique" && test "`eval $cmd`" = "" ; then
+    eval "LIBPATH$unique=set"
+    
+    test -n "$ld_runpath_switch" && LDFLAGS="$LDFLAGS $ld_runpath_switch$ai_p"
+    LDFLAGS="$LDFLAGS -L$ai_p"
+    PHP_RPATHS="$PHP_RPATHS $ai_p"
+  
+  fi
+
+
+      fi
+    
+  fi
+
+    fi
+  else
+    
+
+  if test -n "$ORACLE_DIR/lib"; then
+    
+  if test "$ORACLE_DIR/lib" != "/usr/lib"; then
+    
+  if test -z "$ORACLE_DIR/lib" || echo "$ORACLE_DIR/lib" | grep '^/' >/dev/null ; then
+    ai_p=$ORACLE_DIR/lib
+  else
+    
+    ep_dir="`echo $ORACLE_DIR/lib|sed 's%/*[^/][^/]*/*$%%'`"
+    
+    ep_realdir="`(cd \"$ep_dir\" && pwd)`"
+    ai_p="$ep_realdir/`basename \"$ORACLE_DIR/lib\"`"
+  fi
+
+    
+      
+  
+  
+  unique=`echo $ai_p|sed 's/[^a-zA-Z0-9]/_/g'`
+  
+  cmd="echo $ac_n \"\$LIBPATH$unique$ac_c\""
+  if test -n "$unique" && test "`eval $cmd`" = "" ; then
+    eval "LIBPATH$unique=set"
+    
+    test -n "$ld_runpath_switch" && LDFLAGS="$LDFLAGS $ld_runpath_switch$ai_p"
+    LDFLAGS="$LDFLAGS -L$ai_p"
+    PHP_RPATHS="$PHP_RPATHS $ai_p"
+  
+  fi
+
+
+    
+  fi
+
+  fi
+  
+  
+  case wrap in
+  c|c_r|pthread*) ;;
+  *) 
+      LIBS="-lwrap $LIBS" 
+   ;;
+  esac
+
+
+
+
+  fi
+
+
+	    
+
+  if test "$ext_shared" = "yes"; then
     ORACLE_SHARED_LIBADD="-lnlsrtl3 $ORACLE_SHARED_LIBADD"
     if test -n "$ORACLE_DIR/lib"; then
       
@@ -76670,29 +76940,6 @@
   else
     
   
-  case cs in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lcs $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case cs in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lcs $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
   case ct in
   c|c_r|pthread*) ;;
   *) 
@@ -76716,52 +76963,7 @@
 
     
   
-  case comn in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lcomn $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case comn in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lcomn $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
-  case intl in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lintl $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case intl in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lintl $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-  
-    SYBASE_CT_LIBS="-L$SYBASE_CT_LIBDIR -lcs -lct -lcomn -lintl"
+    SYBASE_CT_LIBS="-L$SYBASE_CT_LIBDIR -lct"
   
     
   save_old_LDFLAGS=$LDFLAGS
@@ -76907,38 +77109,6 @@
 
     
   
-else
-  echo "$ac_t""no" 1>&6
-
-    LDFLAGS=$save_old_LDFLAGS
-    ext_shared=$save_ext_shared
-    unset ac_cv_func_tcl
-     
-      
-  
-  case sybtcl in
-  c|c_r|pthread*) ;;
-  *) 
-    if test "$ext_shared" = "yes"; then
-        SYBASE_CT_SHARED_LIBADD="-lsybtcl $SYBASE_CT_SHARED_LIBADD" 
-    else
-      
-  
-  case sybtcl in
-  c|c_r|pthread*) ;;
-  *) 
-      LIBS="-lsybtcl $LIBS" 
-   ;;
-  esac
-
-
-    fi
-   ;;
-  esac
-
-
-    
-  
 fi
 
   
@@ -90711,10 +90881,7 @@
 CXXFLAGS="$CXXFLAGS $standard_libtool_flag"
 
 all_targets='$(OVERALL_TARGET) $(PHP_MODULES) $(PHP_CLI_TARGET)'
-install_targets="install-sapi install-modules $install_pear install-build install-headers install-programs"
-if test "$PHP_SAPI" != "cgi"; then
-  install_targets="$PHP_INSTALL_CLI_TARGET $install_targets"
-fi
+install_targets="install-sapi $PHP_INSTALL_CLI_TARGET install-modules $install_pear install-build install-headers install-programs"
 
 
   PHP_VAR_SUBST="$PHP_VAR_SUBST all_targets"
