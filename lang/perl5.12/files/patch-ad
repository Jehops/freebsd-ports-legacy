--- perl.h.ORIG	Mon Apr 28 17:36:10 1997
+++ perl.h	Fri May 23 11:56:49 1997
@@ -223,6 +223,15 @@
 #   include <sys/param.h>
 #endif
 
+/* needed for IAMSUID case for 4.4BSD systems 
+ * XXX there should probably be a Configure variable
+ */
+
+#ifdef I_SYS_PARAM
+#if (defined (BSD) && (BSD >= 199306))
+#   include <sys/mount.h>
+#endif /* !BSD */
+#endif /* !I_SYS_PARAM */
 
 /* Use all the "standard" definitions? */
 #if defined(STANDARD_C) && defined(I_STDLIB)
--- perl5.004/perl.c.ORIG	Fri May 16 00:14:03 1997
+++ perl.c	Fri May 23 11:56:49 1997
@@ -1917,6 +1917,20 @@
 		croak("Can't swap uid and euid");	/* really paranoid */
 	    if (Stat(SvPVX(GvSV(curcop->cop_filegv)),&tmpstatbuf) < 0)
 		croak("Permission denied");	/* testing full pathname here */
+#if (defined(BSD) && (BSD >= 199306))
+#ifdef IAMSUID
+        {
+            struct statfs stfs;
+
+            if (fstatfs(fileno(rsfp),&stfs) < 0)
+                croak("Can't statfs filesystem of script \"%s\"",origfilename);
+
+            if (stfs.f_flags & MNT_NOSUID)
+                croak("Permission denied");
+        }
+#endif /* IAMSUID */
+#endif /* BSD */
+
 	    if (tmpstatbuf.st_dev != statbuf.st_dev ||
 		tmpstatbuf.st_ino != statbuf.st_ino) {
 		(void)PerlIO_close(rsfp);
