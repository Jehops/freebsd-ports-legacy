--- erts/configure.in.orig	Mon Oct  8 10:36:08 2001
+++ erts/configure.in	Sun Jan 20 16:06:23 2002
@@ -436,7 +436,7 @@
 dnl ----------------------------------------------------------------------
 
 AC_CHECK_FUNCS([ieee_handler fpsetmask finite res_gethostbyname dlopen \
-		poll pread pwrite writev memmove strerror strncasecmp \
+		poll pread pwrite writev memmove strerror strerror_r strncasecmp \
 		gethrtime localtime_r gmtime_r mremap memcpy mallopt])
 AC_FUNC_SETVBUF_REVERSED
 AC_FUNC_VFORK
@@ -886,10 +886,13 @@
 # Os mon stuff.
 #--------------------------------------------------------------------
 AC_SUBST(os_mon_programs)
-AC_CHECK_LIB(kstat, kstat_open, [os_mon_programs="$os_mon_programs cpu_sup"])
+AC_SUBST(os_mon_kstat)
+AC_CHECK_LIB(kstat, kstat_open, [os_mon_kstat="-lkstat", os_mon_programs="$os_mon_programs cpu_sup"])
 case $host_os in
 	solaris2*)
 		os_mon_programs="$os_mon_programs ferrule mod_syslog" ;;
+	freebsd*)
+		os_mon_programs="$os_mon_programs cpu_sup ferrule mod_syslog" ;;
 esac
 
 
