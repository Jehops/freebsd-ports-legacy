--- perl.h.ORIG	Thu Jul 30 17:04:42 1998
+++ perl.h	Thu Jul 30 17:06:34 1998
@@ -361,6 +361,15 @@
 #   include <sys/param.h>
 #endif
 
+/* needed for IAMSUID case for 4.4BSD systems 
+ * XXX there should probably be a Configure variable
+ */
+
+#ifdef I_SYS_PARAM
+#if (defined (BSD) && (BSD >= 199306))
+#   include <sys/mount.h>
+#endif /* !BSD */
+#endif /* !I_SYS_PARAM */
 
 /* Use all the "standard" definitions? */
 #if defined(STANDARD_C) && defined(I_STDLIB)
--- perl.c.ORIG	Thu Jul 30 17:04:23 1998
+++ perl.c	Thu Jul 30 17:04:57 1998
@@ -2124,6 +2124,20 @@
 		croak("Can't swap uid and euid");	/* really paranoid */
 	    if (PerlLIO_stat(SvPVX(GvSV(PL_curcop->cop_filegv)),&tmpstatbuf) < 0)
 		croak("Permission denied");	/* testing full pathname here */
+#if (defined(BSD) && (BSD >= 199306))
+#ifdef IAMSUID
+	{
+	    struct statfs stfs;
+
+	    if (fstatfs(fileno(PL_rsfp),&stfs) < 0)
+		croak("Can't statfs filesystem of script \"%s\"",PL_origfilename);
+
+	    if (stfs.f_flags & MNT_NOSUID)
+		croak("Permission denied");
+	}
+#endif /* IAMSUID */
+#endif /* BSD */
+
 	    if (tmpstatbuf.st_dev != PL_statbuf.st_dev ||
 		tmpstatbuf.st_ino != PL_statbuf.st_ino) {
 		(void)PerlIO_close(PL_rsfp);
