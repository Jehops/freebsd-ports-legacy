Index: Defaults.in
diff -c Defaults.in:1.1.1.1 Defaults.in:1.2
*** Defaults.in:1.1.1.1	Sun Sep  7 05:19:36 1997
--- Defaults.in	Thu Jan 22 22:51:58 1998
***************
*** 36,41 ****
  $CPPFLAGS = '-I'.$srcroot.'/d2c/runtime';
  
  if (!$stage2) {
!   $PARSERGEN = "$MINDY -f $buildroot/tools/parsergen/parsergen.dbc";
    $MELANGE = "$MINDY -f $buildroot/tools/melange/melange.dbc";
  };
--- 36,41 ----
  $CPPFLAGS = '-I'.$srcroot.'/d2c/runtime';
  
  if (!$stage2) {
!   $PARSERGEN = "$MINDY -f $buildroot/tools/parsergen/parsergen-lib.dbc";
    $MELANGE = "$MINDY -f $buildroot/tools/melange/melange.dbc";
  };
Index: configure
diff -c configure:1.1.1.1 configure:1.3
*** configure:1.1.1.1	Sun Sep  7 05:19:36 1997
--- configure	Mon Jan 26 20:30:59 1998
***************
*** 603,611 ****
  if test "$PERL" = no; then 
      echo "configure: warning: Cannot build without perl to run gen-makefile" 1>&2
      PERL=perl
- elif test "$PERL" != "/usr/local/bin/perl"; then
-     echo "configure: warning: Perl is not in /usr/local/bin, so you need to fix the script \
- sharp-bang interpreter comments by hand." 1>&2
  fi
  
  #--------------------------------------------------------------------
--- 603,608 ----
***************
*** 665,671 ****
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:669: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
--- 662,668 ----
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:666: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
***************
*** 686,692 ****
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking target system type""... $ac_c" 1>&6
! echo "configure:690: checking target system type" >&5
  
  target_alias=$target
  case "$target_alias" in
--- 683,689 ----
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking target system type""... $ac_c" 1>&6
! echo "configure:687: checking target system type" >&5
  
  target_alias=$target
  case "$target_alias" in
***************
*** 704,710 ****
  echo "$ac_t""$target" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:708: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
--- 701,707 ----
  echo "$ac_t""$target" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:705: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
***************
*** 728,740 ****
  
  
  echo $ac_n "checking system type for d2c target name""... $ac_c" 1>&6
! echo "configure:732: checking system type for d2c target name" >&5
  case $target in
      *pc-linux-gnu) d2c_target=x86-linux ;;
      hppa*-hp-hpux*) d2c_target=hppa-hpux ;;
      sparc*-solaris*) d2c_target=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_target=x86-win32-gcc ;;
      i*86-pc-none) d2c_target=x86-win32-vc ;;
      *) d2c_target=unknown-unix ;;
  esac
  
--- 725,738 ----
  
  
  echo $ac_n "checking system type for d2c target name""... $ac_c" 1>&6
! echo "configure:729: checking system type for d2c target name" >&5
  case $target in
      *pc-linux-gnu) d2c_target=x86-linux ;;
      hppa*-hp-hpux*) d2c_target=hppa-hpux ;;
      sparc*-solaris*) d2c_target=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_target=x86-win32-gcc ;;
      i*86-pc-none) d2c_target=x86-win32-vc ;;
+     i*86-*-freebsd*) d2c_target=x86-freebsd ;;
      *) d2c_target=unknown-unix ;;
  esac
  
***************
*** 748,808 ****
  
  
  echo $ac_n "checking system type for d2c host name""... $ac_c" 1>&6
! echo "configure:752: checking system type for d2c host name" >&5
  case $host in
      *pc-linux-gnu) d2c_host=x86-linux ;;
      hppa*-hp-hpux*) d2c_host=hppa-hpux ;;
      sparc*-solaris*) d2c_host=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_host=x86-win32-gcc ;;
      *) d2c_host=unknown-unix ;;
  esac
  echo "$ac_t""$d2c_host" 1>&6
  
  
  
- if test "$d2c_host" = "$d2c_target"; then
-   # If self compiling, always run mindy out of the build area, since the
-   # installed version might be wrong.
-   MINDY=$builddir/mindy/interp/mindy
-   MC=$builddir/mindy/comp/mindycomp
- 
-   if $stage2; then
-     # We're using the installed compiler, but we want to use the new libraries.
-     # The individual makegens already include the needed -L's, so just use an
-     # empty path to make sure we don't get inconsistent libraries.
-     DYLANPATH=""
-   else
-     # Set DYLANPATH so that we can find the uninstalled libraries.
-     DYLANPATH=""
-     for dir in coll-ext format format-out internal-time matrix print \
- 	regexp standard-io stream-ext streams string-ext table-ext time \
- 	transcendental
-     do DYLANPATH=${DYLANPATH}":"$builddir/common/$dir
-     done
-     for dir in random dylan inspector tk;
-     do DYLANPATH=${DYLANPATH}":"$builddir/mindy/libraries/$dir
-     done
-   fi
- else
-     # If cross compiling, hopefully mindy will be on PATH.  It won't be in the
-     # build area.  Building the mindy stuff is actually unnecessary when
-     # cross-compiling, perhaps undesirable.  But it's easier not to
-     # conditionalize the files.
-     MINDY="mindy"
-     MC="mindycomp"
-     DYLANPATH=0
- fi
- 
- DYLANPATH='"'$DYLANPATH'"'
- 
- 
- 
- 
- 
  #--------------------------------------------------------------------
! # See if we can find an installed d2c.  They might have installed binaries but
! # not set up environment variable yet, so look in the install area as well as on
! # path.  If not found we must bootstrap.
  #--------------------------------------------------------------------
  
  stage2=1
--- 746,768 ----
  
  
  echo $ac_n "checking system type for d2c host name""... $ac_c" 1>&6
! echo "configure:750: checking system type for d2c host name" >&5
  case $host in
      *pc-linux-gnu) d2c_host=x86-linux ;;
      hppa*-hp-hpux*) d2c_host=hppa-hpux ;;
      sparc*-solaris*) d2c_host=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_host=x86-win32-gcc ;;
+     i*86-*-freebsd*) d2c_host=x86-freebsd ;;
      *) d2c_host=unknown-unix ;;
  esac
  echo "$ac_t""$d2c_host" 1>&6
  
  
  
  #--------------------------------------------------------------------
! # See if we can find an installed d2c.  They might have installed
! # binaries but not set up environment variables yet, so look in the
! # install area as well as on the path.  If not found we must bootstrap.
  #--------------------------------------------------------------------
  
  stage2=1
***************
*** 810,816 ****
  # Extract the first word of "d2c", so it can be a program name with args.
  set dummy d2c; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:814: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_D2C'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 770,776 ----
  # Extract the first word of "d2c", so it can be a program name with args.
  set dummy d2c; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:774: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_D2C'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 838,847 ****
  
  
  if test "$D2C" = no; then
      # Extract the first word of "d2c", so it can be a program name with args.
  set dummy d2c; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:845: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_D2C'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 798,808 ----
  
  
  if test "$D2C" = no; then
+     instpath="$bindir:$prefix/bin"
      # Extract the first word of "d2c", so it can be a program name with args.
  set dummy d2c; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:806: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_D2C'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 851,857 ****
    ;;
    *)
    IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
!   for ac_dir in $bindir:$prefix/bin$ac_dummy; do
      test -z "$ac_dir" && ac_dir=.
      if test -f $ac_dir/$ac_word; then
        ac_cv_path_D2C="$ac_dir/$ac_word"
--- 812,818 ----
    ;;
    *)
    IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
!   for ac_dir in $instpath$ac_dummy; do
      test -z "$ac_dir" && ac_dir=.
      if test -f $ac_dir/$ac_word; then
        ac_cv_path_D2C="$ac_dir/$ac_word"
***************
*** 878,886 ****
--- 839,884 ----
  if test "$D2C" = no; then
      echo "configure: warning: d2c executable not found: configuring in bootstrap mode." 1>&2
      stage2=0
+ fi
+ 
+ 
+ 
+ if test "$d2c_host" = "$d2c_target"; then
+   # If self compiling, always run mindy out of the build area, since the
+   # installed version might be wrong.
+   MINDY=$builddir/mindy/interp/mindy
+   MC=$builddir/mindy/comp/mindycomp
+ 
+   if test $stage2 != "0"; then
+     # We're using the installed compiler, but we want to use the new libraries.
+     # The individual makegens already include the needed -L's, so just use an
+     # empty path to make sure we don't get inconsistent libraries.
+     DYLANPATH=""
+   else
      D2C="$MINDY -f $builddir/d2c/compiler/main/d2c.dbc -p$srcdir/d2c/compiler/platforms.descr";
+     # Set DYLANPATH so that we can find the uninstalled libraries.
+     DYLANPATH=""
+     for dir in coll-ext format format-out internal-time matrix print \
+ 	regexp standard-io stream-ext streams string-ext table-ext time \
+ 	transcendental
+     do DYLANPATH=${DYLANPATH}":"$builddir/common/$dir
+     done
+     for dir in random dylan inspector tk;
+     do DYLANPATH=${DYLANPATH}":"$builddir/mindy/libraries/$dir
+     done
+   fi
+ else
+     # If cross compiling, hopefully mindy will be on PATH.  It won't be in the
+     # build area.  Building the mindy stuff is actually unnecessary when
+     # cross-compiling, perhaps undesirable.  But it's easier not to
+     # conditionalize the files.
+     MINDY="mindy"
+     MC="mindycomp"
+     DYLANPATH=0
  fi
  
+ DYLANPATH='"'$DYLANPATH'"'
+ 
  
  
  
***************
*** 902,908 ****
  # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
  # ./install, which can be erroneously created by make from ./install.sh.
  echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
! echo "configure:906: checking for a BSD compatible install" >&5
  if test -z "$INSTALL"; then
  if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 900,906 ----
  # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
  # ./install, which can be erroneously created by make from ./install.sh.
  echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
! echo "configure:904: checking for a BSD compatible install" >&5
  if test -z "$INSTALL"; then
  if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 954,960 ****
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:958: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 952,958 ----
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:956: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 983,989 ****
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:987: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 981,987 ----
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:985: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1031,1037 ****
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:1035: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
--- 1029,1035 ----
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:1033: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
***************
*** 1041,1051 ****
  cross_compiling=$ac_cv_prog_cc_cross
  
  cat > conftest.$ac_ext <<EOF
! #line 1045 "configure"
  #include "confdefs.h"
  main(){return(0);}
  EOF
! if { (eval echo configure:1049: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
--- 1039,1049 ----
  cross_compiling=$ac_cv_prog_cc_cross
  
  cat > conftest.$ac_ext <<EOF
! #line 1043 "configure"
  #include "confdefs.h"
  main(){return(0);}
  EOF
! if { (eval echo configure:1047: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
***************
*** 1065,1076 ****
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:1069: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:1074: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1063,1074 ----
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:1067: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:1072: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1079,1085 ****
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1083: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
--- 1077,1083 ----
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1081: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
***************
*** 1094,1100 ****
    ac_save_CFLAGS="$CFLAGS"
    CFLAGS=
    echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:1098: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1092,1098 ----
    ac_save_CFLAGS="$CFLAGS"
    CFLAGS=
    echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:1096: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1124,1130 ****
  # Extract the first word of "flex", so it can be a program name with args.
  set dummy flex; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1128: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_LEX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1122,1128 ----
  # Extract the first word of "flex", so it can be a program name with args.
  set dummy flex; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1126: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_LEX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1157,1163 ****
    *) ac_lib=l ;;
    esac
    echo $ac_n "checking for yywrap in -l$ac_lib""... $ac_c" 1>&6
! echo "configure:1161: checking for yywrap in -l$ac_lib" >&5
  ac_lib_var=`echo $ac_lib'_'yywrap | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1155,1161 ----
    *) ac_lib=l ;;
    esac
    echo $ac_n "checking for yywrap in -l$ac_lib""... $ac_c" 1>&6
! echo "configure:1159: checking for yywrap in -l$ac_lib" >&5
  ac_lib_var=`echo $ac_lib'_'yywrap | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1165,1171 ****
    ac_save_LIBS="$LIBS"
  LIBS="-l$ac_lib  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1169 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1163,1169 ----
    ac_save_LIBS="$LIBS"
  LIBS="-l$ac_lib  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1167 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1176,1182 ****
  yywrap()
  ; return 0; }
  EOF
! if { (eval echo configure:1180: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1174,1180 ----
  yywrap()
  ; return 0; }
  EOF
! if { (eval echo configure:1178: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1203,1209 ****
  # Extract the first word of "$ac_prog", so it can be a program name with args.
  set dummy $ac_prog; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1207: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_YACC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1201,1207 ----
  # Extract the first word of "$ac_prog", so it can be a program name with args.
  set dummy $ac_prog; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1205: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_YACC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1235,1241 ****
  # Extract the first word of "ranlib", so it can be a program name with args.
  set dummy ranlib; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1239: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1233,1239 ----
  # Extract the first word of "ranlib", so it can be a program name with args.
  set dummy ranlib; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1237: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1301,1312 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for sigaction""... $ac_c" 1>&6
! echo "configure:1305: checking for sigaction" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigaction'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1310 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigaction(); below.  */
--- 1299,1310 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for sigaction""... $ac_c" 1>&6
! echo "configure:1303: checking for sigaction" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigaction'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1308 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigaction(); below.  */
***************
*** 1329,1335 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1333: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigaction=yes"
  else
--- 1327,1333 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1331: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigaction=yes"
  else
***************
*** 1356,1367 ****
  
    LIBOBJS="${LIBOBJS-} sigaction.o"
    echo $ac_n "checking for sigsetmask""... $ac_c" 1>&6
! echo "configure:1360: checking for sigsetmask" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigsetmask'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1365 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigsetmask(); below.  */
--- 1354,1365 ----
  
    LIBOBJS="${LIBOBJS-} sigaction.o"
    echo $ac_n "checking for sigsetmask""... $ac_c" 1>&6
! echo "configure:1358: checking for sigsetmask" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigsetmask'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1363 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigsetmask(); below.  */
***************
*** 1384,1390 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1388: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigsetmask=yes"
  else
--- 1382,1388 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1386: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigsetmask=yes"
  else
***************
*** 1405,1416 ****
  fi
  
    echo $ac_n "checking for sigrelse""... $ac_c" 1>&6
! echo "configure:1409: checking for sigrelse" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigrelse'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1414 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigrelse(); below.  */
--- 1403,1414 ----
  fi
  
    echo $ac_n "checking for sigrelse""... $ac_c" 1>&6
! echo "configure:1407: checking for sigrelse" >&5
  if eval "test \"`echo '$''{'ac_cv_func_sigrelse'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1412 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char sigrelse(); below.  */
***************
*** 1433,1439 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1437: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigrelse=yes"
  else
--- 1431,1437 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1435: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_sigrelse=yes"
  else
***************
*** 1485,1496 ****
  for ac_func in getcwd opendir strerror strstr
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:1489: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1494 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 1483,1494 ----
  for ac_func in getcwd opendir strerror strstr
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:1487: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1492 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 1513,1519 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1517: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 1511,1517 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1515: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 1542,1553 ****
  for ac_func in strtol memmove tmpnam waitpid
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:1546: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1551 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 1540,1551 ----
  for ac_func in strtol memmove tmpnam waitpid
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:1544: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1549 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 1570,1576 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1574: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 1568,1574 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1572: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 1597,1608 ****
  
  
  echo $ac_n "checking for gettimeofday""... $ac_c" 1>&6
! echo "configure:1601: checking for gettimeofday" >&5
  if eval "test \"`echo '$''{'ac_cv_func_gettimeofday'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1606 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char gettimeofday(); below.  */
--- 1595,1606 ----
  
  
  echo $ac_n "checking for gettimeofday""... $ac_c" 1>&6
! echo "configure:1599: checking for gettimeofday" >&5
  if eval "test \"`echo '$''{'ac_cv_func_gettimeofday'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1604 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char gettimeofday(); below.  */
***************
*** 1625,1631 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1629: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_gettimeofday=yes"
  else
--- 1623,1629 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1627: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_gettimeofday=yes"
  else
***************
*** 1649,1660 ****
  fi
  
  echo $ac_n "checking for getwd""... $ac_c" 1>&6
! echo "configure:1653: checking for getwd" >&5
  if eval "test \"`echo '$''{'ac_cv_func_getwd'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1658 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char getwd(); below.  */
--- 1647,1658 ----
  fi
  
  echo $ac_n "checking for getwd""... $ac_c" 1>&6
! echo "configure:1651: checking for getwd" >&5
  if eval "test \"`echo '$''{'ac_cv_func_getwd'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1656 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char getwd(); below.  */
***************
*** 1677,1683 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1681: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_getwd=yes"
  else
--- 1675,1681 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1679: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_getwd=yes"
  else
***************
*** 1701,1712 ****
  fi
  
  echo $ac_n "checking for wait3""... $ac_c" 1>&6
! echo "configure:1705: checking for wait3" >&5
  if eval "test \"`echo '$''{'ac_cv_func_wait3'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1710 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char wait3(); below.  */
--- 1699,1710 ----
  fi
  
  echo $ac_n "checking for wait3""... $ac_c" 1>&6
! echo "configure:1703: checking for wait3" >&5
  if eval "test \"`echo '$''{'ac_cv_func_wait3'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1708 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char wait3(); below.  */
***************
*** 1729,1735 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1733: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_wait3=yes"
  else
--- 1727,1733 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1731: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_wait3=yes"
  else
***************
*** 1764,1770 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:1768: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
--- 1762,1768 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:1766: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
***************
*** 1779,1791 ****
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 1783 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1789: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    :
--- 1777,1789 ----
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 1781 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1787: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    :
***************
*** 1796,1808 ****
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 1800 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1806: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    :
--- 1794,1806 ----
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 1798 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1804: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    :
***************
*** 1826,1842 ****
  
  ac_safe=`echo "unistd.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for unistd.h""... $ac_c" 1>&6
! echo "configure:1830: checking for unistd.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1835 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1840: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 1824,1840 ----
  
  ac_safe=`echo "unistd.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for unistd.h""... $ac_c" 1>&6
! echo "configure:1828: checking for unistd.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1833 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1838: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 1862,1870 ****
  fi
  
  echo $ac_n "checking dirent.h""... $ac_c" 1>&6
! echo "configure:1866: checking dirent.h" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1868 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
--- 1860,1868 ----
  fi
  
  echo $ac_n "checking dirent.h""... $ac_c" 1>&6
! echo "configure:1864: checking dirent.h" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1866 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
***************
*** 1880,1886 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:1884: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    tcl_ok=1
  else
--- 1878,1884 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:1882: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    tcl_ok=1
  else
***************
*** 1891,1897 ****
  fi
  rm -f conftest*
  cat > conftest.$ac_ext <<EOF
! #line 1895 "configure"
  #include "confdefs.h"
  #include <dirent.h>
  EOF
--- 1889,1895 ----
  fi
  rm -f conftest*
  cat > conftest.$ac_ext <<EOF
! #line 1893 "configure"
  #include "confdefs.h"
  #include <dirent.h>
  EOF
***************
*** 1913,1929 ****
  fi
  ac_safe=`echo "errno.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for errno.h""... $ac_c" 1>&6
! echo "configure:1917: checking for errno.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1922 "configure"
  #include "confdefs.h"
  #include <errno.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1927: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 1911,1927 ----
  fi
  ac_safe=`echo "errno.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for errno.h""... $ac_c" 1>&6
! echo "configure:1915: checking for errno.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1920 "configure"
  #include "confdefs.h"
  #include <errno.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1925: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 1950,1966 ****
  
  ac_safe=`echo "float.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for float.h""... $ac_c" 1>&6
! echo "configure:1954: checking for float.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1959 "configure"
  #include "confdefs.h"
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1964: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 1948,1964 ----
  
  ac_safe=`echo "float.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for float.h""... $ac_c" 1>&6
! echo "configure:1952: checking for float.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1957 "configure"
  #include "confdefs.h"
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1962: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 1987,2003 ****
  
  ac_safe=`echo "limits.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for limits.h""... $ac_c" 1>&6
! echo "configure:1991: checking for limits.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1996 "configure"
  #include "confdefs.h"
  #include <limits.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2001: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 1985,2001 ----
  
  ac_safe=`echo "limits.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for limits.h""... $ac_c" 1>&6
! echo "configure:1989: checking for limits.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1994 "configure"
  #include "confdefs.h"
  #include <limits.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1999: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2024,2040 ****
  
  ac_safe=`echo "bstring.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for bstring.h""... $ac_c" 1>&6
! echo "configure:2028: checking for bstring.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2033 "configure"
  #include "confdefs.h"
  #include <bstring.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2038: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2022,2038 ----
  
  ac_safe=`echo "bstring.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for bstring.h""... $ac_c" 1>&6
! echo "configure:2026: checking for bstring.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2031 "configure"
  #include "confdefs.h"
  #include <bstring.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2036: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2061,2077 ****
  
  ac_safe=`echo "stdlib.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for stdlib.h""... $ac_c" 1>&6
! echo "configure:2065: checking for stdlib.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2070 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2075: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2059,2075 ----
  
  ac_safe=`echo "stdlib.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for stdlib.h""... $ac_c" 1>&6
! echo "configure:2063: checking for stdlib.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2068 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2073: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2094,2100 ****
  fi
  
  cat > conftest.$ac_ext <<EOF
! #line 2098 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2092,2098 ----
  fi
  
  cat > conftest.$ac_ext <<EOF
! #line 2096 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2108,2114 ****
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2112 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2106,2112 ----
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2110 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2122,2128 ****
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2126 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2120,2126 ----
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2124 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2136,2142 ****
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2140 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2134,2140 ----
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2138 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2157,2173 ****
  fi
  ac_safe=`echo "string.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for string.h""... $ac_c" 1>&6
! echo "configure:2161: checking for string.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2166 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2171: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2155,2171 ----
  fi
  ac_safe=`echo "string.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for string.h""... $ac_c" 1>&6
! echo "configure:2159: checking for string.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2164 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2169: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2190,2196 ****
  fi
  
  cat > conftest.$ac_ext <<EOF
! #line 2194 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
--- 2188,2194 ----
  fi
  
  cat > conftest.$ac_ext <<EOF
! #line 2192 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
***************
*** 2204,2210 ****
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2208 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
--- 2202,2208 ----
  rm -f conftest*
  
  cat > conftest.$ac_ext <<EOF
! #line 2206 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
***************
*** 2224,2230 ****
  
  fi
  cat > conftest.$ac_ext <<EOF
! #line 2228 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  EOF
--- 2222,2228 ----
  
  fi
  cat > conftest.$ac_ext <<EOF
! #line 2226 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  EOF
***************
*** 2243,2259 ****
  fi
  ac_safe=`echo "sys/time.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for sys/time.h""... $ac_c" 1>&6
! echo "configure:2247: checking for sys/time.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2252 "configure"
  #include "confdefs.h"
  #include <sys/time.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2257: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2241,2257 ----
  fi
  ac_safe=`echo "sys/time.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for sys/time.h""... $ac_c" 1>&6
! echo "configure:2245: checking for sys/time.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2250 "configure"
  #include "confdefs.h"
  #include <sys/time.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2255: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2280,2296 ****
  
  ac_safe=`echo "sys/wait.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for sys/wait.h""... $ac_c" 1>&6
! echo "configure:2284: checking for sys/wait.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2289 "configure"
  #include "confdefs.h"
  #include <sys/wait.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2294: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2278,2294 ----
  
  ac_safe=`echo "sys/wait.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for sys/wait.h""... $ac_c" 1>&6
! echo "configure:2282: checking for sys/wait.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2287 "configure"
  #include "confdefs.h"
  #include <sys/wait.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2292: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2328,2343 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking fd_set""... $ac_c" 1>&6
! echo "configure:2332: checking fd_set" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2334 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  int main() {
  fd_set readMask, writeMask;
  ; return 0; }
  EOF
! if { (eval echo configure:2341: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
--- 2326,2341 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking fd_set""... $ac_c" 1>&6
! echo "configure:2330: checking fd_set" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2332 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  int main() {
  fd_set readMask, writeMask;
  ; return 0; }
  EOF
! if { (eval echo configure:2339: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
***************
*** 2345,2351 ****
    cat conftest.$ac_ext >&5
    rm -rf conftest*
    cat > conftest.$ac_ext <<EOF
! #line 2349 "configure"
  #include "confdefs.h"
  #include <sys/select.h>
  EOF
--- 2343,2349 ----
    cat conftest.$ac_ext >&5
    rm -rf conftest*
    cat > conftest.$ac_ext <<EOF
! #line 2347 "configure"
  #include "confdefs.h"
  #include <sys/select.h>
  EOF
***************
*** 2370,2376 ****
  # On the HP, select is defined in sys/time.h
  #
  cat > conftest.$ac_ext <<EOF
! #line 2374 "configure"
  #include "confdefs.h"
  #include <sys/time.h>
  EOF
--- 2368,2374 ----
  # On the HP, select is defined in sys/time.h
  #
  cat > conftest.$ac_ext <<EOF
! #line 2372 "configure"
  #include "confdefs.h"
  #include <sys/time.h>
  EOF
***************
*** 2395,2401 ****
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2399 "configure"
  #include "confdefs.h"
  
  extern int strstr();
--- 2393,2399 ----
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2397 "configure"
  #include "confdefs.h"
  
  extern int strstr();
***************
*** 2405,2411 ****
  }
  
  EOF
! if { (eval echo configure:2409: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2403,2409 ----
  }
  
  EOF
! if { (eval echo configure:2407: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2425,2436 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for strtoul""... $ac_c" 1>&6
! echo "configure:2429: checking for strtoul" >&5
  if eval "test \"`echo '$''{'ac_cv_func_strtoul'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2434 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char strtoul(); below.  */
--- 2423,2434 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for strtoul""... $ac_c" 1>&6
! echo "configure:2427: checking for strtoul" >&5
  if eval "test \"`echo '$''{'ac_cv_func_strtoul'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2432 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char strtoul(); below.  */
***************
*** 2453,2459 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2457: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_strtoul=yes"
  else
--- 2451,2457 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2455: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_strtoul=yes"
  else
***************
*** 2477,2483 ****
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2481 "configure"
  #include "confdefs.h"
  
  extern int strtoul();
--- 2475,2481 ----
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2479 "configure"
  #include "confdefs.h"
  
  extern int strtoul();
***************
*** 2493,2499 ****
      exit(0);
  }
  EOF
! if { (eval echo configure:2497: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2491,2497 ----
      exit(0);
  }
  EOF
! if { (eval echo configure:2495: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2515,2526 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for strtod""... $ac_c" 1>&6
! echo "configure:2519: checking for strtod" >&5
  if eval "test \"`echo '$''{'ac_cv_func_strtod'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2524 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char strtod(); below.  */
--- 2513,2524 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for strtod""... $ac_c" 1>&6
! echo "configure:2517: checking for strtod" >&5
  if eval "test \"`echo '$''{'ac_cv_func_strtod'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2522 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char strtod(); below.  */
***************
*** 2543,2549 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2547: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_strtod=yes"
  else
--- 2541,2547 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2545: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_strtod=yes"
  else
***************
*** 2567,2573 ****
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2571 "configure"
  #include "confdefs.h"
  
  extern double strtod();
--- 2565,2571 ----
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 2569 "configure"
  #include "confdefs.h"
  
  extern double strtod();
***************
*** 2583,2589 ****
      exit(0);
  }
  EOF
! if { (eval echo configure:2587: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2581,2587 ----
      exit(0);
  }
  EOF
! if { (eval echo configure:2585: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2605,2616 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2609: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2614 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
--- 2603,2614 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2607: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2612 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
***************
*** 2618,2624 ****
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2622: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2616,2622 ----
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2620: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2635,2641 ****
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2639 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
--- 2633,2639 ----
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2637 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
***************
*** 2653,2659 ****
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2657 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2651,2657 ----
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2655 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2674,2680 ****
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2678 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
--- 2672,2678 ----
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2676 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
***************
*** 2685,2691 ****
  exit (0); }
  
  EOF
! if { (eval echo configure:2689: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2683,2689 ----
  exit (0); }
  
  EOF
! if { (eval echo configure:2687: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2709,2720 ****
  fi
  
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:2713: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2718 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 2707,2718 ----
  fi
  
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:2711: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2716 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 2742,2753 ****
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:2746: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2751 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 2740,2751 ----
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:2744: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2749 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 2775,2786 ****
  fi
  
  echo $ac_n "checking for size_t""... $ac_c" 1>&6
! echo "configure:2779: checking for size_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2784 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 2773,2784 ----
  fi
  
  echo $ac_n "checking for size_t""... $ac_c" 1>&6
! echo "configure:2777: checking for size_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2782 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 2808,2819 ****
  fi
  
  echo $ac_n "checking for uid_t in sys/types.h""... $ac_c" 1>&6
! echo "configure:2812: checking for uid_t in sys/types.h" >&5
  if eval "test \"`echo '$''{'ac_cv_type_uid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2817 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  EOF
--- 2806,2817 ----
  fi
  
  echo $ac_n "checking for uid_t in sys/types.h""... $ac_c" 1>&6
! echo "configure:2810: checking for uid_t in sys/types.h" >&5
  if eval "test \"`echo '$''{'ac_cv_type_uid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2815 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  EOF
***************
*** 2850,2861 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for opendir""... $ac_c" 1>&6
! echo "configure:2854: checking for opendir" >&5
  if eval "test \"`echo '$''{'ac_cv_func_opendir'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2859 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char opendir(); below.  */
--- 2848,2859 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for opendir""... $ac_c" 1>&6
! echo "configure:2852: checking for opendir" >&5
  if eval "test \"`echo '$''{'ac_cv_func_opendir'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2857 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char opendir(); below.  */
***************
*** 2878,2884 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2882: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_opendir=yes"
  else
--- 2876,2882 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2880: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_opendir=yes"
  else
***************
*** 2909,2917 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking sys_errlist""... $ac_c" 1>&6
! echo "configure:2913: checking sys_errlist" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2915 "configure"
  #include "confdefs.h"
  
  int main() {
--- 2907,2915 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking sys_errlist""... $ac_c" 1>&6
! echo "configure:2911: checking sys_errlist" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2913 "configure"
  #include "confdefs.h"
  
  int main() {
***************
*** 2922,2928 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2926: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
--- 2920,2926 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2924: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
***************
*** 2946,2954 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking union wait""... $ac_c" 1>&6
! echo "configure:2950: checking union wait" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2952 "configure"
  #include "confdefs.h"
  #include <sys/types.h> 
  #include <sys/wait.h>
--- 2944,2952 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking union wait""... $ac_c" 1>&6
! echo "configure:2948: checking union wait" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2950 "configure"
  #include "confdefs.h"
  #include <sys/types.h> 
  #include <sys/wait.h>
***************
*** 2960,2966 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2964: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
--- 2958,2964 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2962: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
***************
*** 2981,2989 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking matherr support""... $ac_c" 1>&6
! echo "configure:2985: checking matherr support" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2987 "configure"
  #include "confdefs.h"
  #include <math.h>
  int main() {
--- 2979,2987 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking matherr support""... $ac_c" 1>&6
! echo "configure:2983: checking matherr support" >&5
  cat > conftest.$ac_ext <<EOF
! #line 2985 "configure"
  #include "confdefs.h"
  #include <math.h>
  int main() {
***************
*** 2994,3000 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2998: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    LIBOBJS="${LIBOBJS-} matherr.o"
      cat >> confdefs.h <<\EOF
--- 2992,2998 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2996: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    LIBOBJS="${LIBOBJS-} matherr.o"
      cat >> confdefs.h <<\EOF
***************
*** 3020,3026 ****
  
  LIBS="${LIBS-} -lm"
  echo $ac_n "checking for shl_load in -ldld""... $ac_c" 1>&6
! echo "configure:3024: checking for shl_load in -ldld" >&5
  ac_lib_var=`echo dld'_'shl_load | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 3018,3024 ----
  
  LIBS="${LIBS-} -lm"
  echo $ac_n "checking for shl_load in -ldld""... $ac_c" 1>&6
! echo "configure:3022: checking for shl_load in -ldld" >&5
  ac_lib_var=`echo dld'_'shl_load | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 3028,3034 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldld  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3032 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 3026,3032 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldld  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3030 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 3039,3045 ****
  shl_load()
  ; return 0; }
  EOF
! if { (eval echo configure:3043: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 3037,3043 ----
  shl_load()
  ; return 0; }
  EOF
! if { (eval echo configure:3041: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 3069,3080 ****
  for ac_func in rint
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3073: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3078 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3067,3078 ----
  for ac_func in rint
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3071: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3076 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3097,3103 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3101: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3095,3101 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3099: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 3172,3180 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking stdio support""... $ac_c" 1>&6
! echo "configure:3176: checking stdio support" >&5
  cat > conftest.$ac_ext <<EOF
! #line 3178 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
--- 3170,3178 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking stdio support""... $ac_c" 1>&6
! echo "configure:3174: checking stdio support" >&5
  cat > conftest.$ac_ext <<EOF
! #line 3176 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
***************
*** 3184,3190 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3188: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    cat >> confdefs.h <<\EOF
  #define USE_LINUX_FBUFEMPTYP 1
--- 3182,3188 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3186: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    cat >> confdefs.h <<\EOF
  #define USE_LINUX_FBUFEMPTYP 1
***************
*** 3195,3215 ****
    echo "configure: failed program was:" >&5
    cat conftest.$ac_ext >&5
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  fi
  rm -f conftest*
  
  #--------------------------------------------------------------------
  #	Check to see if fsync is available.
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for fsync""... $ac_c" 1>&6
! echo "configure:3208: checking for fsync" >&5
  if eval "test \"`echo '$''{'ac_cv_func_fsync'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3213 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char fsync(); below.  */
--- 3193,3237 ----
    echo "configure: failed program was:" >&5
    cat conftest.$ac_ext >&5
    rm -rf conftest*
+   cat > conftest.$ac_ext <<EOF
+ #line 3198 "configure"
+ #include "confdefs.h"
+ #include <stdio.h>
+ int main() {
+ 
+ FILE f;
+ (f._r <= 0);
+ 
+ ; return 0; }
+ EOF
+ if { (eval echo configure:3208: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+   rm -rf conftest*
+   cat >> confdefs.h <<\EOF
+ #define USE_BSD_FBUFEMPTYP 1
+ EOF
+ 
+    echo "$ac_t""using BSD fbufempty" 1>&6
+ else
+   echo "configure: failed program was:" >&5
+   cat conftest.$ac_ext >&5
+   rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  fi
  rm -f conftest*
+ fi
+ rm -f conftest*
  
  #--------------------------------------------------------------------
  #	Check to see if fsync is available.
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for fsync""... $ac_c" 1>&6
! echo "configure:3230: checking for fsync" >&5
  if eval "test \"`echo '$''{'ac_cv_func_fsync'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3235 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char fsync(); below.  */
***************
*** 3232,3238 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3236: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_fsync=yes"
  else
--- 3254,3260 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3258: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_fsync=yes"
  else
***************
*** 3265,3276 ****
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for select""... $ac_c" 1>&6
! echo "configure:3269: checking for select" >&5
  if eval "test \"`echo '$''{'ac_cv_func_select'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3274 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char select(); below.  */
--- 3287,3298 ----
  #--------------------------------------------------------------------
  
  echo $ac_n "checking for select""... $ac_c" 1>&6
! echo "configure:3291: checking for select" >&5
  if eval "test \"`echo '$''{'ac_cv_func_select'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3296 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char select(); below.  */
***************
*** 3293,3299 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3297: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_select=yes"
  else
--- 3315,3321 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3319: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_select=yes"
  else
***************
*** 3317,3323 ****
  for lib in Xbsd socket nsl; do
    if test $select = 0; then
      echo $ac_n "checking for main in -l$lib""... $ac_c" 1>&6
! echo "configure:3321: checking for main in -l$lib" >&5
  ac_lib_var=`echo $lib'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 3339,3345 ----
  for lib in Xbsd socket nsl; do
    if test $select = 0; then
      echo $ac_n "checking for main in -l$lib""... $ac_c" 1>&6
! echo "configure:3343: checking for main in -l$lib" >&5
  ac_lib_var=`echo $lib'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 3325,3338 ****
    ac_save_LIBS="$LIBS"
  LIBS="-l$lib  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3329 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:3336: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 3347,3360 ----
    ac_save_LIBS="$LIBS"
  LIBS="-l$lib  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3351 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:3358: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 3356,3367 ****
      if test $tryit = 1; then
        LIBS="$LIBS -l$lib"
        echo $ac_n "checking for select""... $ac_c" 1>&6
! echo "configure:3360: checking for select" >&5
  if eval "test \"`echo '$''{'ac_cv_func_select'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3365 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char select(); below.  */
--- 3378,3389 ----
      if test $tryit = 1; then
        LIBS="$LIBS -l$lib"
        echo $ac_n "checking for select""... $ac_c" 1>&6
! echo "configure:3382: checking for select" >&5
  if eval "test \"`echo '$''{'ac_cv_func_select'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3387 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char select(); below.  */
***************
*** 3384,3390 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3388: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_select=yes"
  else
--- 3406,3412 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3410: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_select=yes"
  else
***************
*** 3421,3432 ****
  for ac_func in _setjmp
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3425: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3430 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3443,3454 ----
  for ac_func in _setjmp
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3447: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3452 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3449,3455 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3453: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3471,3477 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3475: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 3476,3487 ****
  for ac_func in _longjmp
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3480: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3485 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3498,3509 ----
  for ac_func in _longjmp
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3502: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3507 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3504,3510 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3508: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3526,3532 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3530: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 3720,3730 ****
  s%@build_os@%$build_os%g
  s%@d2c_target@%$d2c_target%g
  s%@d2c_host@%$d2c_host%g
  s%@DYLANPATH@%$DYLANPATH%g
  s%@MINDY@%$MINDY%g
  s%@MC@%$MC%g
- s%@D2C@%$D2C%g
- s%@stage2@%$stage2%g
  s%@INSTALL_PROGRAM@%$INSTALL_PROGRAM%g
  s%@INSTALL_DATA@%$INSTALL_DATA%g
  s%@CC@%$CC%g
--- 3742,3752 ----
  s%@build_os@%$build_os%g
  s%@d2c_target@%$d2c_target%g
  s%@d2c_host@%$d2c_host%g
+ s%@D2C@%$D2C%g
+ s%@stage2@%$stage2%g
  s%@DYLANPATH@%$DYLANPATH%g
  s%@MINDY@%$MINDY%g
  s%@MC@%$MC%g
  s%@INSTALL_PROGRAM@%$INSTALL_PROGRAM%g
  s%@INSTALL_DATA@%$INSTALL_DATA%g
  s%@CC@%$CC%g
***************
*** 3854,3859 ****
  test "$no_create" = yes || ${CONFIG_SHELL-/bin/sh} $CONFIG_STATUS || exit 1
  
  
! ${INSTALL} -m uog+rx $srcdir/tools/shared-misc/mk-build-tree ./
! ${INSTALL} -m uog+rx $srcdir/tools/shared-misc/gen-makefile ./
  (PATH=`pwd`:${PATH}; export PATH; mk-build-tree -p$srcdir/d2c/compiler/platforms.descr)
--- 3876,3886 ----
  test "$no_create" = yes || ${CONFIG_SHELL-/bin/sh} $CONFIG_STATUS || exit 1
  
  
! rm -f ./mk-build-tree ./gen-makefile
! sed -e "1s|/usr/local/bin/perl|$PERL|" \
! 	$srcdir/tools/shared-misc/mk-build-tree > ./mk-build-tree
! chmod uog+rx ./mk-build-tree
! sed -e "1s|/usr/local/bin/perl|$PERL|" \
! 	$srcdir/tools/shared-misc/gen-makefile > ./gen-makefile
! chmod uog+rx ./gen-makefile
  (PATH=`pwd`:${PATH}; export PATH; mk-build-tree -p$srcdir/d2c/compiler/platforms.descr)
Index: configure.in
diff -c configure.in:1.1.1.1 configure.in:1.3
***************
*** 44,52 ****
  if test "$PERL" = no; then 
      AC_MSG_WARN([Cannot build without perl to run gen-makefile])
      PERL=perl
- elif test "$PERL" != "/usr/local/bin/perl"; then
-     AC_MSG_WARN([Perl is not in /usr/local/bin, so you need to fix the script \
- sharp-bang interpreter comments by hand.])
  fi
  
  #--------------------------------------------------------------------
--- 44,49 ----
***************
*** 68,73 ****
--- 65,71 ----
      sparc*-solaris*) d2c_target=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_target=x86-win32-gcc ;;
      i*86-pc-none) d2c_target=x86-win32-vc ;;
+     i*86-*-freebsd*) d2c_target=x86-freebsd ;;
      *) d2c_target=unknown-unix ;;
  esac
  
***************
*** 86,109 ****
      hppa*-hp-hpux*) d2c_host=hppa-hpux ;;
      sparc*-solaris*) d2c_host=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_host=x86-win32-gcc ;;
      *) d2c_host=unknown-unix ;;
  esac
  AC_MSG_RESULT($d2c_host)
  
  AC_SUBST(d2c_host)
  
  if test "$d2c_host" = "$d2c_target"; then
    # If self compiling, always run mindy out of the build area, since the
    # installed version might be wrong.
    MINDY=$builddir/mindy/interp/mindy
    MC=$builddir/mindy/comp/mindycomp
  
!   if $stage2; then
      # We're using the installed compiler, but we want to use the new libraries.
      # The individual makegens already include the needed -L's, so just use an
      # empty path to make sure we don't get inconsistent libraries.
      DYLANPATH=""
    else
      # Set DYLANPATH so that we can find the uninstalled libraries.
      DYLANPATH=""
      for dir in coll-ext format format-out internal-time matrix print \
--- 84,134 ----
      hppa*-hp-hpux*) d2c_host=hppa-hpux ;;
      sparc*-solaris*) d2c_host=sparc-solaris ;;
      i*86-pc-cygwin32) d2c_host=x86-win32-gcc ;;
+     i*86-*-freebsd*) d2c_host=x86-freebsd ;;
      *) d2c_host=unknown-unix ;;
  esac
  AC_MSG_RESULT($d2c_host)
  
  AC_SUBST(d2c_host)
  
+ #--------------------------------------------------------------------
+ # See if we can find an installed d2c.  They might have installed
+ # binaries but not set up environment variables yet, so look in the
+ # install area as well as on the path.  If not found we must bootstrap.
+ #--------------------------------------------------------------------
+ 
+ stage2=1
+ 
+ AC_CHECK_PROG(D2C, d2c, d2c, no)
+ 
+ if test "$D2C" = no; then
+     instpath="$bindir:$prefix/bin"
+     AC_PATH_PROG(D2C, d2c, no, $instpath)
+     if test "$D2C" != no; then
+         D2C="$D2C -p$sysconfdir/platforms.descr"
+     fi
+ fi
+ 
+ if test "$D2C" = no; then
+     AC_MSG_WARN(d2c executable not found: configuring in bootstrap mode.)
+     stage2=0
+ fi
+ 
+ AC_SUBST(stage2)
+ 
  if test "$d2c_host" = "$d2c_target"; then
    # If self compiling, always run mindy out of the build area, since the
    # installed version might be wrong.
    MINDY=$builddir/mindy/interp/mindy
    MC=$builddir/mindy/comp/mindycomp
  
!   if test $stage2 != "0"; then
      # We're using the installed compiler, but we want to use the new libraries.
      # The individual makegens already include the needed -L's, so just use an
      # empty path to make sure we don't get inconsistent libraries.
      DYLANPATH=""
    else
+     D2C="$MINDY -f $builddir/d2c/compiler/main/d2c.dbc -p$srcdir/d2c/compiler/platforms.descr";
      # Set DYLANPATH so that we can find the uninstalled libraries.
      DYLANPATH=""
      for dir in coll-ext format format-out internal-time matrix print \
***************
*** 131,163 ****
  AC_SUBST(MC)
  
  
- #--------------------------------------------------------------------
- # See if we can find an installed d2c.  They might have installed binaries but
- # not set up environment variable yet, so look in the install area as well as on
- # path.  If not found we must bootstrap.
- #--------------------------------------------------------------------
- 
- stage2=1
- 
- AC_CHECK_PROG(D2C, d2c, d2c, no)
- 
- if test "$D2C" = no; then
-     AC_PATH_PROG(D2C, d2c, no, $bindir:$prefix/bin)
-     if test "$D2C" != no; then
-         D2C="$D2C -p$sysconfdir/platforms.descr"
-     fi
- fi
- 
- if test "$D2C" = no; then
-     AC_MSG_WARN(d2c executable not found: configuring in bootstrap mode.)
-     stage2=0
-     D2C="$MINDY -f $builddir/d2c/compiler/main/d2c.dbc -p$srcdir/d2c/compiler/platforms.descr";
- fi
- 
- 
- 
- AC_SUBST(stage2)
- 
  
  #--------------------------------------------------------------------
  #	These macros find a BSD install, a C compiler, and so on, and
--- 156,161 ----
***************
*** 496,502 ****
  (f._IO_read_ptr >= f._IO_read_end);
  ],[AC_DEFINE(USE_LINUX_FBUFEMPTYP)
     AC_MSG_RESULT(using Linux fbufempty)],
! AC_MSG_RESULT(yes))
  
  #--------------------------------------------------------------------
  #	Check to see if fsync is available.
--- 494,505 ----
  (f._IO_read_ptr >= f._IO_read_end);
  ],[AC_DEFINE(USE_LINUX_FBUFEMPTYP)
     AC_MSG_RESULT(using Linux fbufempty)],
! AC_TRY_COMPILE([#include <stdio.h>], [
! FILE f;
! (f._r <= 0);
! ],[AC_DEFINE(USE_BSD_FBUFEMPTYP)
!    AC_MSG_RESULT(using BSD fbufempty)],
! AC_MSG_RESULT(yes)))
  
  #--------------------------------------------------------------------
  #	Check to see if fsync is available.
***************
*** 570,575 ****
  	mindy/etc/Makefile \
  )
  
! ${INSTALL} -m uog+rx $srcdir/tools/shared-misc/mk-build-tree ./
! ${INSTALL} -m uog+rx $srcdir/tools/shared-misc/gen-makefile ./
  (PATH=`pwd`:${PATH}; export PATH; mk-build-tree -p$srcdir/d2c/compiler/platforms.descr)
--- 573,583 ----
  	mindy/etc/Makefile \
  )
  
! rm -f ./mk-build-tree ./gen-makefile
! sed -e "1s|/usr/local/bin/perl|$PERL|" \
! 	$srcdir/tools/shared-misc/mk-build-tree > ./mk-build-tree
! chmod uog+rx ./mk-build-tree
! sed -e "1s|/usr/local/bin/perl|$PERL|" \
! 	$srcdir/tools/shared-misc/gen-makefile > ./gen-makefile
! chmod uog+rx ./gen-makefile
  (PATH=`pwd`:${PATH}; export PATH; mk-build-tree -p$srcdir/d2c/compiler/platforms.descr)
Index: common/format/Debugger-Format.lid
diff -c /dev/null common/format/Debugger-Format.lid:1.1
*** /dev/null	Mon Jan 26 20:39:08 1998
--- common/format/Debugger-Format.lid	Wed Jan 21 19:47:12 1998
***************
*** 0 ****
--- 1,3 ----
+ library: Debugger-Format
+ 
+ debugger-format.dylan
Index: common/format/Makegen
diff -c common/format/Makegen:1.1.1.1 common/format/Makegen:1.2
*** common/format/Makegen:1.1.1.1	Sun Sep  7 05:19:39 1997
--- common/format/Makegen	Wed Jan 21 19:47:11 1998
***************
*** 2,8 ****
  
  $D2CFLAGS = $D2CFLAGS . ' -L../streams -L../print';
  
! do emit_library_rule(
      'Format', '$(BUILDROOT)/force.timestamp', '', 'compile', 'compile-mindy',
      'install'
  );
--- 2,13 ----
  
  $D2CFLAGS = $D2CFLAGS . ' -L../streams -L../print';
  
! &emit_library_rule(
      'Format', '$(BUILDROOT)/force.timestamp', '', 'compile', 'compile-mindy',
      'install'
+ );
+ 
+ &emit_library_rule(
+     'Debugger-Format', '$(BUILDROOT)/force.timestamp', '', 'no-d2c',
+     'compile-mindy', ''
  );
Index: common/streams/fd-io.dylan
diff -c common/streams/fd-io.dylan:1.1.1.1 common/streams/fd-io.dylan:1.2
*** common/streams/fd-io.dylan:1.1.1.1	Sun Sep  7 05:19:42 1997
--- common/streams/fd-io.dylan	Wed Jan 21 19:12:05 1998
***************
*** 31,37 ****
  //
  
  method () => ();
! #if (compiled-for-win32 | compiled-for-solaris)
    c-include("errno.h");
  #else
    c-include("unistd.h");
--- 31,37 ----
  //
  
  method () => ();
! #if (compiled-for-win32 | compiled-for-solaris | compiled-for-FreeBSD)
    c-include("errno.h");
  #else
    c-include("unistd.h");
Index: common/streams/file-streams.dylan
diff -c common/streams/file-streams.dylan:1.1.1.1 common/streams/file-streams.dylan:1.2
*** common/streams/file-streams.dylan:1.1.1.1	Sun Sep  7 05:19:43 1997
--- common/streams/file-streams.dylan	Wed Jan 21 19:12:06 1998
***************
*** 29,35 ****
  //
  //======================================================================
  
! #if (~mindy & (compiled-for-win32 | compiled-for-solaris))
  // We need this because when fd-open is inlined into this file, the
  // identifier O_BINARY will be undeclared in the C code
  method () => ();
--- 29,35 ----
  //
  //======================================================================
  
! #if (~mindy & (compiled-for-win32 | compiled-for-solaris | compiled-for-FreeBSD))
  // We need this because when fd-open is inlined into this file, the
  // identifier O_BINARY will be undeclared in the C code
  method () => ();
Index: common/streams/unix-fds.c
diff -c common/streams/unix-fds.c:1.1.1.1 common/streams/unix-fds.c:1.2
*** common/streams/unix-fds.c:1.1.1.1	Sun Sep  7 05:19:42 1997
--- common/streams/unix-fds.c	Wed Jan 21 19:16:07 1998
***************
*** 12,17 ****
--- 12,20 ----
  #ifdef __linux__
    #include <sys/time.h> /* We need this to get struct timeval... */
  #endif /* ifdef linux */
+ #ifdef __FreeBSD__
+   #include <sys/time.h>
+ #endif
  #include <sys/wait.h>
  
  int fd_open (const char *filename, int flags, int mode)
Index: common/time/Makegen
diff -c common/time/Makegen:1.1.1.1 common/time/Makegen:1.2
*** common/time/Makegen:1.1.1.1	Sun Sep  7 05:19:45 1997
--- common/time/Makegen	Thu Jan 22 22:23:13 1998
***************
*** 3,12 ****
  $D2CFLAGS = $D2CFLAGS . ' -L../streams -L../standard-io -L../print -L../format -L../string-ext -L../table-ext -L../coll-ext';
  
  # Solaris doesn't support the Time library because it doesn't have the
! # "timezone" variable.  And windows is even more clueless.
  #
  if ((! $features{'compiled_for_solaris'})
!     && (! $features{'compiled_for_win32'})) {
  	&emit_melange_rule('time-intr');
  
  	do emit_library_rule(
--- 3,14 ----
  $D2CFLAGS = $D2CFLAGS . ' -L../streams -L../standard-io -L../print -L../format -L../string-ext -L../table-ext -L../coll-ext';
  
  # Solaris doesn't support the Time library because it doesn't have the
! # "timezone" variable.  Neither does FreeBSD.  And windows is even
! # more clueless.
  #
  if ((! $features{'compiled_for_solaris'})
!     && (! $features{'compiled_for_win32'})
!     && (! $features{'compiled_for_freebsd'})) {
  	&emit_melange_rule('time-intr');
  
  	do emit_library_rule(
Index: d2c/compiler/platforms.descr
diff -c d2c/compiler/platforms.descr:1.1.1.1 d2c/compiler/platforms.descr:1.2
*** d2c/compiler/platforms.descr:1.1.1.1	Sun Sep  7 05:20:06 1997
--- d2c/compiler/platforms.descr	Thu Jan 22 21:51:28 1998
***************
*** 53,58 ****
--- 53,61 ----
  // align-directive: Assembler directive that tells it to align the
  // next structure on an N byte boundary
  //
+ // align-arg-is-power-of-two?: True if the argument to the align-directive
+ // is a power-of-two rather than a byte count.  The default is #f.
+ //
  // word-directive: Assembler directive for outputting a 32-bit word.
  //
  // half-word-directive: Assembler directive for outputting a 16-bit integer.
***************
*** 105,110 ****
--- 108,118 ----
  // the command for linking a library.  Arg1 is the name of the archive
  // (with extension), arg2 is the object files.
  //
+ // randomize-library-command: A format string that describes how to
+ // invoke a command used for making a library linkable.  Arg1 is the
+ // name of the library, with the appropriate extension already added.
+ // There is no default randomize-library-command.
+ //
  // link-executable-command: A format string that gives the beginning
  // of the command for linking an executable file.  Arg1 is the name of
  // the executable (with extension).  Arg2 is the object files.  Arg3
***************
*** 375,380 ****
--- 383,407 ----
  word-directive:			.long
  half-word-directive:		.hword
  make-command:			make
+ supports-debugging?:		#t
+ big-endian?:			#f
+ descriptor-type-string:         .stabs "<unknown>",100,0,0,.Ltext0\n.text\n.Ltext0:\n.stabs "heapptr_t:t34=*35=xsheapobj:",128,0,6,0\n.stabs "descriptor:T36=s8heapptr:34,0,32;dataword:37=u4l:3,0,32;\\\",128,0,0,0\n.stabs "f:12,0,32;ptr:27,0,32;;,32,32;;",128,0,0,0\n.stabs "descriptor_t:t36",128,0,14,0\n
+ descriptor-reference-string:	\t.stabs\t"%s%s:G36",32,0,1,0\n
+ 
+ // FreeBSD on Intel 80386 or higher
+ //
+ platform-name:			x86-freebsd
+ inherit-from:			generic-unix
+ default-features:		compiled-for-unix compiled-for-x86
+ 				compiled-for-FreeBSD C-compiler-is-GCC
+ default-c-compiler-flags:	-I. -I%s -g -O4 -finline-functions
+ mangled-name-prefix:            _
+ word-directive:			.long
+ half-word-directive:		.hword
+ align-arg-is-power-of-two?:	#t
+ make-command:			gmake
+ link-executable-command:        gcc -g -o %s %s %s
+ randomize-library-command:	ranlib %s
  supports-debugging?:		#t
  big-endian?:			#f
  descriptor-type-string:         .stabs "<unknown>",100,0,0,.Ltext0\n.text\n.Ltext0:\n.stabs "heapptr_t:t34=*35=xsheapobj:",128,0,6,0\n.stabs "descriptor:T36=s8heapptr:34,0,32;dataword:37=u4l:3,0,32;\\\",128,0,0,0\n.stabs "f:12,0,32;ptr:27,0,32;;,32,32;;",128,0,0,0\n.stabs "descriptor_t:t36",128,0,14,0\n
Index: d2c/compiler/base/base-exports.dylan
diff -c d2c/compiler/base/base-exports.dylan:1.1.1.1 d2c/compiler/base/base-exports.dylan:1.2
*** d2c/compiler/base/base-exports.dylan:1.1.1.1	Sun Sep  7 05:20:12 1997
--- d2c/compiler/base/base-exports.dylan	Wed Jan 21 20:22:40 1998
***************
*** 449,454 ****
--- 449,455 ----
      default-c-compiler-flags,
      assembler-command,
      link-library-command,
+     randomize-library-command,
      link-executable-command,
      link-executable-flags,
      make-command,
***************
*** 464,470 ****
      descriptor-reference-string,
  
      big-endian?,
!     omit-colon-after-label-declarations?;
  end module platform;
  
  
--- 465,472 ----
      descriptor-reference-string,
  
      big-endian?,
!     omit-colon-after-label-declarations?,
!     align-arg-is-power-of-two?;
  end module platform;
  
  
Index: d2c/compiler/base/platform.dylan
diff -c d2c/compiler/base/platform.dylan:1.1.1.1 d2c/compiler/base/platform.dylan:1.2
*** d2c/compiler/base/platform.dylan:1.1.1.1	Sun Sep  7 05:20:12 1997
--- d2c/compiler/base/platform.dylan	Wed Jan 21 20:22:41 1998
***************
*** 104,109 ****
--- 104,112 ----
      required-init-keyword: #"assembler-command";
    constant /* exported */ slot link-library-command :: <byte-string>,
      required-init-keyword: #"link-library-command";
+   constant /* exported */ slot randomize-library-command
+       :: false-or(<byte-string>) = #f,
+     init-keyword: #"randomize-library-command";
    constant /* exported */ slot link-executable-command :: <byte-string>,
      required-init-keyword: #"link-executable-command";
    constant /* exported */ slot link-executable-flags :: <byte-string>,
***************
*** 161,166 ****
--- 164,171 ----
    constant /* exported */ slot omit-colon-after-label-declarations? 
        :: <boolean> = #f,
      init-keyword: #"omit-colon-after-label-declarations?";
+   constant /* exported */ slot align-arg-is-power-of-two? :: <boolean> = #f,
+     init-keyword: #"align-arg-is-power-of-two?";
  end class <platform>;
  
  define sealed domain make(singleton(<platform>));
***************
*** 248,254 ****
  	#"uses-drive-letters?", #"environment-variables-can-be-exported?",
  	#"use-dbclink?", #"link-doesnt-search-for-libs?",
  	#"import-directive-required?", #"supports-debugging?",
! 	#"omit-colon-after-label-declarations?", #"big-endian?" =>
  	  keyword-values := add!(keyword-values, string-to-boolean(val));
  	#"integer-length" =>
  	  keyword-values := add!(keyword-values, string-to-integer(val));
--- 253,260 ----
  	#"uses-drive-letters?", #"environment-variables-can-be-exported?",
  	#"use-dbclink?", #"link-doesnt-search-for-libs?",
  	#"import-directive-required?", #"supports-debugging?",
! 	#"big-endian?", #"omit-colon-after-label-declarations?",
! 	#"align-arg-is-power-of-two?"  =>
  	  keyword-values := add!(keyword-values, string-to-boolean(val));
  	#"integer-length" =>
  	  keyword-values := add!(keyword-values, string-to-integer(val));
Index: d2c/compiler/cback/heap.dylan
diff -c d2c/compiler/cback/heap.dylan:1.1.1.1 d2c/compiler/cback/heap.dylan:1.2
*** d2c/compiler/cback/heap.dylan:1.1.1.1	Sun Sep  7 05:20:13 1997
--- d2c/compiler/cback/heap.dylan	Wed Jan 21 20:28:07 1998
***************
*** 219,225 ****
  
    spew-objects-in-queue(state);
  
!   format(stream, "\n\n\t%s\t8\n", target.align-directive);
    spew-label(state, "initial_symbols", export: #t);
    spew-reference(state.symbols, *heap-rep*, "Initial Symbols", state);
  end;
--- 219,227 ----
  
    spew-objects-in-queue(state);
  
!   format(stream, "\n\n");
!   align-to-n-bytes(stream, 8, target);
! 
    spew-label(state, "initial_symbols", export: #t);
    spew-reference(state.symbols, *heap-rep*, "Initial Symbols", state);
  end;
***************
*** 293,300 ****
      let object = pop(state.object-queue);
      let info = get-info-for(object, #f);
  
!     format(stream, "\n%s %s\n\t%s\t8\n", target.comment-token, object,
! 	   target.align-directive);
      let labels = info.const-info-heap-labels;
      if (labels.empty?)
        error("Trying to spew %=, but it doesn't have any labels.", object);
--- 295,303 ----
      let object = pop(state.object-queue);
      let info = get-info-for(object, #f);
  
!     format(stream, "\n%s %s\n", target.comment-token, object);
!     align-to-n-bytes(stream, 8, target);
! 
      let labels = info.const-info-heap-labels;
      if (labels.empty?)
        error("Trying to spew %=, but it doesn't have any labels.", object);
***************
*** 370,375 ****
--- 373,399 ----
    end while;
  end method save-n-bytes;
  
+ //------------------------------------------------------------------------
+ //  align-to-n-bytes
+ //
+ // This method emits an align-directive to make sure we are on an n-byte
+ // boundary.  The number of bytes should always be a power of two.
+ //------------------------------------------------------------------------
+ 
+ define method align-to-n-bytes
+     (stream :: <stream>, bytes :: <integer>, target :: <platform>) => ();
+   if (target.align-arg-is-power-of-two?)
+     let power-of-two = for (bytes :: <integer> = bytes then ash(bytes, -1),
+ 			    lg :: <integer> = 0 then lg + 1,
+ 			    while: bytes > 1)
+ 		       finally
+ 			 lg;
+ 		       end for;
+     format(stream, "\t%s\t%d\n", target.align-directive, power-of-two);
+   else
+     format(stream, "\t%s\t%d\n", target.align-directive, bytes);
+   end if;
+ end method align-to-n-bytes;
  
  //------------------------------------------------------------------------
  //  Spew-reference
Index: d2c/compiler/main/main.dylan
diff -c d2c/compiler/main/main.dylan:1.1.1.1 d2c/compiler/main/main.dylan:1.2
*** d2c/compiler/main/main.dylan:1.1.1.1	Sun Sep  7 05:20:14 1997
--- d2c/compiler/main/main.dylan	Wed Jan 21 20:32:38 1998
***************
*** 763,768 ****
--- 763,774 ----
    let link-string = format-to-string(target.link-library-command, 
  				     ar-name, objects);
    format(state.unit-makefile, "\t%s\n", link-string);
+   
+   if (target.randomize-library-command)
+     let randomize-string = format-to-string(target.randomize-library-command,
+ 					    ar-name);
+     format(state.unit-makefile, "\t%s\n", randomize-string);
+   end if;
  end method;
  
  
Index: d2c/dig/Makegen
diff -c d2c/dig/Makegen:1.1.1.1 d2c/dig/Makegen:1.2
*** d2c/dig/Makegen:1.1.1.1	Sun Sep  7 05:20:32 1997
--- d2c/dig/Makegen	Thu Jan 22 23:07:55 1998
***************
*** 18,24 ****
      $dig_lid_file = 'hp-dig';
      &emit_c_file_rule('hp-dig-support', 'hp-dig-support.h');
      &emit_melange_rule('hp-dig-c', 'hp-dig-support.h');
! } elsif ($features{'compiled_for_solaris'} || $features{'compiled_for_linux'}) {
      # dig is unsupported on these platforms because the port is
      # non-trivial.  There's a fair amount of OS-specific work involved
      # in handling interrupts to make sure ^C does what you'd expect.
--- 18,26 ----
      $dig_lid_file = 'hp-dig';
      &emit_c_file_rule('hp-dig-support', 'hp-dig-support.h');
      &emit_melange_rule('hp-dig-c', 'hp-dig-support.h');
! } elsif ($features{'compiled_for_solaris'}
! 	 || $features{'compiled_for_linux'}
! 	 || $features{'compiled_for_freebsd'}) {
      # dig is unsupported on these platforms because the port is
      # non-trivial.  There's a fair amount of OS-specific work involved
      # in handling interrupts to make sure ^C does what you'd expect.
Index: d2c/runtime/runtime.h
diff -c d2c/runtime/runtime.h:1.1.1.1 d2c/runtime/runtime.h:1.2
*** d2c/runtime/runtime.h:1.1.1.1	Sun Sep  7 05:20:17 1997
--- d2c/runtime/runtime.h	Wed Jan 21 18:24:38 1998
***************
*** 34,39 ****
--- 34,40 ----
  extern heapptr_t initial_symbols;
  
  extern void not_reached(void);
+ extern void no_core_dumps(void);
  
  #ifdef WIN32
     double rint(double x);
Index: d2c/runtime/c-code/Makegen
diff -c d2c/runtime/c-code/Makegen:1.1.1.1 d2c/runtime/c-code/Makegen:1.2
*** d2c/runtime/c-code/Makegen:1.1.1.1	Sun Sep  7 05:20:21 1997
--- d2c/runtime/c-code/Makegen	Wed Jan 21 18:26:26 1998
***************
*** 9,15 ****
      # Linux and win32 have different name mangling conventions, so we
      # can't use the same cpu-specific file.
      $cpu_specific = 'linux-ix86';
! } elsif ($features{'compiled_for_win32'} && $features{'compiled_for_x86'}) {
      $cpu_specific = 'i386';
  } elsif ($features{'compiled_for_hppa'}) {
      $cpu_specific = 'hppa';
--- 9,16 ----
      # Linux and win32 have different name mangling conventions, so we
      # can't use the same cpu-specific file.
      $cpu_specific = 'linux-ix86';
! } elsif (($features{'compiled_for_win32'} || $features{'compiled_for_freebsd'})
!         && $features{'compiled_for_x86'}) {
      $cpu_specific = 'i386';
  } elsif ($features{'compiled_for_hppa'}) {
      $cpu_specific = 'hppa';
Index: d2c/runtime/c-code/main.c
diff -c d2c/runtime/c-code/main.c:1.1.1.1 d2c/runtime/c-code/main.c:1.2
*** d2c/runtime/c-code/main.c:1.1.1.1	Sun Sep  7 05:20:21 1997
--- d2c/runtime/c-code/main.c	Wed Jan 21 18:25:33 1998
***************
*** 219,224 ****
--- 219,240 ----
  double log2 (double x)
  {
    return 0;
+ }
+ 
+ #endif
+ 
+ #if !defined(WIN32)
+ 
+ #include <sys/types.h>
+ #include <sys/time.h>
+ #include <sys/resource.h>
+ 
+ void no_core_dumps(void)
+ {
+   struct rlimit lim;
+   getrlimit(RLIMIT_CORE, &lim);
+   lim.rlim_cur = 0;
+   setrlimit(RLIMIT_CORE, &lim);
  }
  
  #endif
Index: d2c/runtime/dylan/Makegen
diff -c d2c/runtime/dylan/Makegen:1.1.1.1 d2c/runtime/dylan/Makegen:1.2
*** d2c/runtime/dylan/Makegen:1.1.1.1	Sun Sep  7 05:20:21 1997
--- d2c/runtime/dylan/Makegen	Wed Jan 21 18:29:28 1998
***************
*** 1,6 ****
  
  $D2CFLAGS = '';
! if ($target_name eq "x86-linux") {
    $D2C = $D2C . ' -F"gcc -g -I' . "$srcroot/d2c/runtime" .
  	 ' -c %s -o %s" -fnum.c';
  };
--- 1,6 ----
  
  $D2CFLAGS = '';
! if ($target_name eq "x86-linux" || $target_name eq "x86-freebsd") {
    $D2C = $D2C . ' -F"gcc -g -I' . "$srcroot/d2c/runtime" .
  	 ' -c %s -o %s" -fnum.c';
  };
Index: d2c/runtime/dylan/system.dylan
diff -c d2c/runtime/dylan/system.dylan:1.1.1.1 d2c/runtime/dylan/system.dylan:1.3
*** d2c/runtime/dylan/system.dylan:1.1.1.1	Sun Sep  7 05:20:21 1997
--- d2c/runtime/dylan/system.dylan	Sun Jan 25 18:43:52 1998
***************
*** 84,93 ****
  //
  define method no-core-dumps () => ();
    #if (~ compiled-for-win32)
!     let buf = make(<buffer>, size: 8);
!     call-out("getrlimit", #"void", #"int", 4, #"ptr", buf.buffer-address);
!     pointer-deref(#"int", buf.buffer-address, 0) := 0;
!     call-out("setrlimit", #"void", #"int", 4, #"ptr", buf.buffer-address);
    #endif
  end method no-core-dumps;
  
--- 84,90 ----
  //
  define method no-core-dumps () => ();
    #if (~ compiled-for-win32)
!    call-out("no_core_dumps", #"void");
    #endif
  end method no-core-dumps;
  
Index: d2c/runtime/gc/Makegen
diff -c d2c/runtime/gc/Makegen:1.1.1.1 d2c/runtime/gc/Makegen:1.2
*** d2c/runtime/gc/Makegen:1.1.1.1	Sun Sep  7 05:20:22 1997
--- d2c/runtime/gc/Makegen	Wed Jan 21 18:37:42 1998
***************
*** 284,290 ****
  	./if_mach SPARC SUNOS5 touch on_sparc_sunos5
  	./if_mach SPARC SUNOS5 $(AR) rus libgc.a $(OBJS) dyn_load.o
  EOF
! print "\t./if_not_there on_sparc_sunos5 \$(AR) rus libgc$dot_lib \$(OBJS) dyn_load.o\n";
      print <<'EOF';
  	./if_not_there on_sparc_sunos5 $(RANLIB) libgc.a || cat /dev/null
  #	ignore ranlib failure; that usually means it doesn't exist, and isn't needed
--- 284,290 ----
  	./if_mach SPARC SUNOS5 touch on_sparc_sunos5
  	./if_mach SPARC SUNOS5 $(AR) rus libgc.a $(OBJS) dyn_load.o
  EOF
! print "\t./if_not_there on_sparc_sunos5 \$(AR) ru libgc$dot_lib \$(OBJS) dyn_load.o\n";
      print <<'EOF';
  	./if_not_there on_sparc_sunos5 $(RANLIB) libgc.a || cat /dev/null
  #	ignore ranlib failure; that usually means it doesn't exist, and isn't needed
Index: mindy/comp/expand.c
diff -c mindy/comp/expand.c:1.1.1.1 mindy/comp/expand.c:1.2
*** mindy/comp/expand.c:1.1.1.1	Sun Sep  7 05:19:47 1997
--- mindy/comp/expand.c	Wed Jan 21 19:05:49 1998
***************
*** 1342,1347 ****
--- 1342,1348 ----
  		struct body *let_body = let->body;
  		let->body = make_body();
  		add_constituent(body, (struct constituent *)let);
+ 		let->next = NULL;
  		for (; p != NULL; p = p->next) {
  		    if (p->type_temp) {
  			struct symbol *temp = gensym();
***************
*** 1369,1374 ****
--- 1370,1376 ----
  		expr = make_function_call(make_varref(id(check_type)), args);
  		bindings->expr = expr;
  		add_constituent(body, (struct constituent *)let);
+ 		let->next = NULL;
  	    }
  	    *ptr = make_expr_constituent(make_body_expr(body));
  	    return TRUE;
Index: mindy/compat/std-bstring.h
diff -c mindy/compat/std-bstring.h:1.1.1.1 mindy/compat/std-bstring.h:1.2
*** mindy/compat/std-bstring.h:1.1.1.1	Sun Sep  7 05:19:57 1997
--- mindy/compat/std-bstring.h	Thu Jan 22 19:28:10 1998
***************
*** 1,4 ****
! extern void	bcopy _ANSI_ARGS_((const void *, void *, int));
! extern int	bcmp _ANSI_ARGS_((const void *, const void *, int));
! extern void	bzero _ANSI_ARGS_((void *, int));
! extern void	blkclr _ANSI_ARGS_((void *, int));
--- 1,4 ----
! extern void	bcopy _ANSI_ARGS_((const void *, void *, size_t));
! extern int	bcmp _ANSI_ARGS_((const void *, const void *, size_t));
! extern void	bzero _ANSI_ARGS_((void *, size_t));
! extern void	blkclr _ANSI_ARGS_((void *, size_t));
Index: mindy/compat/std-c.h
diff -c mindy/compat/std-c.h:1.1.1.1 mindy/compat/std-c.h:1.2
*** mindy/compat/std-c.h:1.1.1.1	Sun Sep  7 05:19:57 1997
--- mindy/compat/std-c.h	Thu Jan 22 22:04:02 1998
***************
*** 147,153 ****
  #ifdef USE_LINUX_FBUFEMPTYP
  #   define FBUFEMPTYP(fp)        (fp->_IO_read_ptr >= fp->_IO_read_end)
  #else
! #   define FBUFEMPTYP(fp)        (fp->_cnt == 0)
  #endif
  
  /*
--- 147,157 ----
  #ifdef USE_LINUX_FBUFEMPTYP
  #   define FBUFEMPTYP(fp)        (fp->_IO_read_ptr >= fp->_IO_read_end)
  #else
! #   ifdef USE_BSD_FBUFEMPTYP
! #       define FBUFEMPTYP(fp)    (fp->_r <= 0)
! #   else
! #       define FBUFEMPTYP(fp)    (fp->_cnt == 0)
! #   endif
  #endif
  
  /*
Index: mindy/interp/extern1.def
diff -c mindy/interp/extern1.def:1.1.1.1 mindy/interp/extern1.def:1.2
*** mindy/interp/extern1.def:1.1.1.1	Sun Sep  7 05:19:56 1997
--- mindy/interp/extern1.def	Fri Jan 23 07:07:43 1998
***************
*** 1,8 ****
! #define extern_sym_count 8
! extern void *timezone;
  extern void *free();
  extern void *calloc();
- extern void *daylight;
  extern void *malloc();
  extern void *strcmp();
  extern void *strlen();
--- 1,6 ----
! #define extern_sym_count 6
  extern void *free();
  extern void *calloc();
  extern void *malloc();
  extern void *strcmp();
  extern void *strlen();
***************
*** 10,19 ****
  
  void init0()
  {
-     add_explicit_symbol("timezone", &timezone);
      add_explicit_symbol("free", &free);
      add_explicit_symbol("calloc", &calloc);
-     add_explicit_symbol("daylight", &daylight);
      add_explicit_symbol("malloc", &malloc);
      add_explicit_symbol("strcmp", &strcmp);
      add_explicit_symbol("strlen", &strlen);
--- 8,15 ----
Index: tests/Makegen
diff -c tests/Makegen:1.1.1.1 tests/Makegen:1.2
*** tests/Makegen:1.1.1.1	Sun Sep  7 05:19:37 1997
--- tests/Makegen	Fri Jan 23 18:06:00 1998
***************
*** 36,42 ****
  #);
  
  if (! $features{'compiled_for_solaris'}
!     && ! $features{'compiled_for_win32'}) {
  	do emit_library_rule(
  	    'time-test', '$(BUILDROOT)/force.timestamp', '', 'compile', 'compile-mindy'
  	);
--- 36,43 ----
  #);
  
  if (! $features{'compiled_for_solaris'}
!     && ! $features{'compiled_for_win32'}
!     && ! $features{'compiled_for_freebsd'}) {
  	do emit_library_rule(
  	    'time-test', '$(BUILDROOT)/force.timestamp', '', 'compile', 'compile-mindy'
  	);
Index: tools/melange/Makegen
diff -c tools/melange/Makegen:1.1.1.1 tools/melange/Makegen:1.2
*** tools/melange/Makegen:1.1.1.1	Sun Sep  7 05:20:34 1997
--- tools/melange/Makegen	Thu Jan 22 22:16:47 1998
***************
*** 8,13 ****
--- 8,15 ----
      $c_decl_lid = "solaris-c-decl";
  } elsif ($features{'compiled_for_linux'}) {
      $c_decl_lid = "linux-c-decl";
+ } elsif ($features{'compiled_for_freebsd'}) {
+     $c_decl_lid = "freebsd-c-decl";
  } else {
      &uknown_platform_error();
  };
***************
*** 21,26 ****
--- 23,35 ----
         '',
         'compile'
         );
+ } else {
+   &emit_library_rule
+       ($c_decl_lid,
+        '$(BUILDROOT)/force.timestamp',
+        '',
+        'no-d2c'
+        );
  };
  
  &emit_parsergen_rule('int-parse');
***************
*** 31,36 ****
--- 40,52 ----
         '$(BUILDROOT)/force.timestamp melange-c.lib.du',
         '-L.',
         'compile', 'install'
+        );
+ } else {
+   &emit_library_rule
+       ('melange',
+        '$(BUILDROOT)/force.timestamp',
+        '',
+        'no-d2c'
         );
  };
  
Index: tools/melange/freebsd-c-decl.lid
diff -c /dev/null tools/melange/freebsd-c-decl.lid:1.1
*** /dev/null	Mon Jan 26 20:39:28 1998
--- tools/melange/freebsd-c-decl.lid	Thu Jan 22 22:11:56 1998
***************
*** 0 ****
--- 1,15 ----
+ rcs-header: $Header: /usr/home/cvsroot/gwydion/dylan/tools/melange/freebsd-c-decl.lid,v 1.1 1998/01/23 06:11:56 housel Exp $
+ library: melange-c
+ unit-prefix: cdecl
+ unique-id-base: 10000
+ 
+ c-exports.dylan
+ multistring.dylan
+ c-lexer.dylan
+ c-lexer-cpp.dylan
+ freebsd-portability.dylan
+ c-parse.dylan
+ alignment.dylan
+ c-decl-state.dylan
+ c-decl-write.dylan
+ c-decl.dylan
Index: tools/melange/freebsd-portability.dylan
diff -c /dev/null tools/melange/freebsd-portability.dylan:1.1
*** /dev/null	Mon Jan 26 20:39:28 1998
--- tools/melange/freebsd-portability.dylan	Thu Jan 22 22:11:56 1998
***************
*** 0 ****
--- 1,101 ----
+ documented: #t
+ module: portability
+ copyright: Copyright (C) 1994, Carnegie Mellon University
+ 	   All rights reserved.
+ 	   This code was produced by the Gwydion Project at Carnegie Mellon
+ 	   University.  If you are interested in using this code, contact
+ 	   "Scott.Fahlman@cs.cmu.edu" (Internet).
+ rcs-header: $Header: 
+ 
+ //======================================================================
+ //
+ // Copyright (c) 1995, 1996, 1997  Carnegie Mellon University
+ // All rights reserved.
+ // 
+ // Use and copying of this software and preparation of derivative
+ // works based on this software are permitted, including commercial
+ // use, provided that the following conditions are observed:
+ // 
+ // 1. This copyright notice must be retained in full on any copies
+ //    and on appropriate parts of any derivative works.
+ // 2. Documentation (paper or online) accompanying any system that
+ //    incorporates this software, or any part of it, must acknowledge
+ //    the contribution of the Gwydion Project at Carnegie Mellon
+ //    University.
+ // 
+ // This software is made available "as is".  Neither the authors nor
+ // Carnegie Mellon University make any warranty about the software,
+ // its performance, or its conformity to any specification.
+ // 
+ // Bug reports, questions, comments, and suggestions should be sent by
+ // E-mail to the Internet address "gwydion-bugs@cs.cmu.edu".
+ //
+ //======================================================================
+ 
+ //======================================================================
+ //
+ // Copyright (c) 1994  Carnegie Mellon University
+ // All rights reserved.
+ //
+ //======================================================================
+ 
+ //======================================================================
+ // Module portability is a tiny OS dependent module which defines the
+ // preprocessor definions and "standard" include directories which would be
+ // used by a typical C compiler for that OS.  It may, at some future date,
+ // also include behavioral switches for things like slot allocation or sizes
+ // of different sorts of numbers.
+ //
+ // This particular implementation of module portability corresponds to the
+ // compilation environment for an Intel x86 running FreeBSD 2.x
+ //======================================================================
+ 
+ define constant $default-defines
+   = #["const", "",
+       "volatile", "",
+       "__STDC__", "",
+ 
+       // The following six declarations should be removed someday, as soon as 
+       // we fix a bug in MINDY.
+ //    "__GNUC__", "2",
+ //    "__GNUC_MINPR__", "7",
+ //    "__signed__", "",
+ //    "__const", "",
+ //    "__CONSTVALUE", "",
+ //    "__CONSTVALUE2", "",
+ 
+       "unix", "",
+       "i386", "",
+       "__FreeBSD__", "2",
+       "__unix__", "",
+       "__i386__", "",
+       "__unix", "",
+       "__i386", ""];
+   
+ define constant FreeBSD-include-directories
+   = #["/usr/local/include", "/usr/include"];
+ 
+ for (dir in FreeBSD-include-directories)
+   push-last(include-path, dir);
+ end for;
+ 
+ 
+ // These constants should be moved here in the future.  Until the module
+ // declarations can be sufficiently rearranged to allow their definition
+ // here, they will remain commented out.  -- panda
+ //
+ // define constant c-type-size = unix-type-size;
+ // define constant c-type-alignment = unix-type-alignment;
+ // define constant $default-alignment :: <integer> = 4;
+ 
+ 
+ define constant $integer-size :: <integer> = 4;
+ define constant $short-int-size :: <integer> = 2;
+ define constant $long-int-size :: <integer> = 4;
+ define constant $char-size :: <integer> = 1;
+ define constant $float-size :: <integer> = 4;
+ define constant $double-float-size :: <integer> = 8;
+ define constant $long-double-size :: <integer> = 16;
+ define constant $enum-size :: <integer> = $integer-size;
+ define constant $pointer-size :: <integer> = 4;
+ define constant $function-pointer-size :: <integer> = $pointer-size;
Index: tools/parsergen/Makegen
diff -c tools/parsergen/Makegen:1.1.1.1 tools/parsergen/Makegen:1.3
*** tools/parsergen/Makegen:1.1.1.1	Sun Sep  7 05:20:37 1997
--- tools/parsergen/Makegen	Thu Jan 22 23:04:29 1998
***************
*** 3,8 ****
  if ($stage2) {
    &emit_library_rule('Parsergen', '$(BUILDROOT)/force.timestamp', '', 
  		     'compile', 'install');
  };
- 
- &emit_dbc_link_rule('parsergen-lib.dbc', 'library.dbc lisp-read.dbc parsergen.dbc');
--- 3,9 ----
  if ($stage2) {
    &emit_library_rule('Parsergen', '$(BUILDROOT)/force.timestamp', '', 
  		     'compile', 'install');
+ } else {
+   &emit_library_rule('Parsergen', '$(BUILDROOT)/force.timestamp', '', 
+ 		     'no-d2c', 'install');
  };
Index: tools/shared-misc/gen-makefile
diff -c tools/shared-misc/gen-makefile:1.1.1.1 tools/shared-misc/gen-makefile:1.2
*** tools/shared-misc/gen-makefile:1.1.1.1	Sun Sep  7 05:20:37 1997
--- tools/shared-misc/gen-makefile	Thu Jan 22 22:41:48 1998
***************
*** 842,848 ****
      print "\n\t\$(MELANGE) -I\$(SRCDIR) ";
      print "\$(SRCDIR)/$basefile.intr \$(SRCDIR)/$basefile.dylan\n\n";
      push(@compile_dependencies, "\$(SRCDIR)/$basefile.dylan");
!     push(@files_to_clean, "\$SRCDIR/$basefile.dylan");
  }
  
  # emit_parsergen_rule($base_file_name) -- exported
--- 842,848 ----
      print "\n\t\$(MELANGE) -I\$(SRCDIR) ";
      print "\$(SRCDIR)/$basefile.intr \$(SRCDIR)/$basefile.dylan\n\n";
      push(@compile_dependencies, "\$(SRCDIR)/$basefile.dylan");
!     push(@files_to_clean, "\$(SRCDIR)/$basefile.dylan");
  }
  
  # emit_parsergen_rule($base_file_name) -- exported
***************
*** 1024,1029 ****
--- 1024,1030 ----
      print "DASH_$uppercase_libname = -l$libname\n\n";
      print "$uppercase_libname", "_OBJS = ", join(" ", @objects), "\n\n";
      push(@dbc_only_dependencies, "$libname-lib.dbc");
+     push(@files_to_clean, "$libname-lib.dbc");
  
      local($source);
      foreach $source (@sources) {
Index: tools/versioner/Makegen
diff -c tools/versioner/Makegen:1.1.1.1 tools/versioner/Makegen:1.2
*** tools/versioner/Makegen:1.1.1.1	Sun Sep  7 05:20:35 1997
--- tools/versioner/Makegen	Thu Jan 22 23:05:14 1998
***************
*** 1,10 ****
  &makegen_include("../common-Makegen");
  
! # Solaris and win32 don't support the Time library, so we can't build
  # Versioner on Solaris.
  #
  if (! $features{'compiled_for_solaris'} 
!     && ! $features{'compiled_for_win32'}) {
      &emit_library_rule('Versioner', '$(BUILDROOT)/force.timestamp', '',
  	 	       'compile', 'install');
  }
--- 1,11 ----
  &makegen_include("../common-Makegen");
  
! # Solaris, FreeBSD and win32 don't support the Time library, so we can't build
  # Versioner on Solaris.
  #
  if (! $features{'compiled_for_solaris'} 
!     && ! $features{'compiled_for_win32'}
!     && ! $features{'compiled_for_freebsd'}) {
      &emit_library_rule('Versioner', '$(BUILDROOT)/force.timestamp', '',
  	 	       'compile', 'install');
  }
