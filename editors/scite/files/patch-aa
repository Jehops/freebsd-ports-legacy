--- makefile.orig	Tue Nov  5 17:36:21 2002
+++ makefile	Tue Nov  5 17:39:53 2002
@@ -10,34 +10,34 @@
 
 # For the Gnome desktop stuff to work, prefix must point to where Gnome thinks it is.
 # "h@h@" is printed here when gnome-config unavailable. Seems harmless.
-gnomeprefix:=$(shell gnome-config --prefix 2>/dev/null)
+gnomeprefix:=$(PREFIX)
 ifdef gnomeprefix
   prefix=$(gnomeprefix)
-  datadir=$(gnomeprefix)/share
+  datadir=$(gnomeprefix)/share/gnome
   pixmapdir=$(datadir)/pixmaps
 else
   prefix=/usr/local
 endif
 bindir=$(prefix)/bin
-SYSCONF_PATH=$(prefix)/share/scite
+SYSCONF_PATH=$(prefix)/share/gnome/scite
 
 PROG	= ../bin/SciTE
 
-vpath %.h ../src ../../scintilla/include
+vpath %.h ../src $(X11BASE)/include/scintilla
 vpath %.cxx ../src
 
 #CXXFLAGS= -g -DGTK -DSCI_LEXER -DSYSCONF_PATH=\"$(SYSCONF_PATH)\" -Wwrite-strings
-INCLUDEDIRS=-I ../../scintilla/include -I ../src
+INCLUDEDIRS=-I $(X11BASE)/include/scintilla -I ../src
 CXXBASEFLAGS=-W -Wall -DGTK -DSCI_LEXER -DSYSCONF_PATH=\"$(SYSCONF_PATH)\" $(INCLUDEDIRS)
 
 ifdef DEBUG
-CXXFLAGS=-DDEBUG -g $(CXXBASEFLAGS)
+CXXFLAGS+=-DDEBUG -g $(CXXBASEFLAGS)
 else
-CXXFLAGS=-DNDEBUG -Os $(CXXBASEFLAGS)
+CXXFLAGS+=-DNDEBUG $(CXXBASEFLAGS)
 endif
 
 .cxx.o:
-	$(CC) `gtk-config --cflags` $(CXXFLAGS) -c $< -o $@
+	$(CC) $(shell $(GTK_CONFIG) --cflags) $(shell $(GLIB_CONFIG) --libs gthread) $(CXXFLAGS) -c $< -o $@
 
 all: $(PROG)
 
@@ -45,14 +45,14 @@
 	rm -f *.o $(PROG)
 
 deps:
-	$(CC) -MM `gtk-config --cflags` $(CXXFLAGS) *.cxx ../src/*.cxx >deps.mak
+	$(CC) -MM `$(GTK_CONFIG) --cflags` `$(GLIB_CONFIG) --libs gthread)` $(CXXFLAGS) *.cxx ../src/*.cxx >deps.mak
 
 # make should be run in ../../scintilla/gtk to compile all the lexers.
 LEXEROBJS=$(wildcard ../../scintilla/gtk/Lex*.o)
 
-$(PROG): SciTEGTK.o SciTEBase.o SciTEBuffers.o SciTEIO.o Exporters.o DirectorExtension.o \
-SciTEProps.o Utf8_16.o $(LEXEROBJS) ../../scintilla/bin/scintilla.a
-	$(CC) `gtk-config --libs` `glib-config --libs gthread` -DGTK $^ -o $@
+$(PROG): SciTEGTK.o SciTEBase.o SciTEBuffers.o SciTEIO.o Exporters.o DirectorExtension.o Utf8_16.o \
+SciTEProps.o # $(LEXEROBJS) ../../scintilla/bin/scintilla.a
+	$(CC) $(shell $(GTK_CONFIG) --libs) $(shell $(GLIB_CONFIG) --libs gthread) -DGTK $^ -L$(X11BASE)/lib -lscintilla -lscintilla_lexers -o $@
 
 # SciTE-static no longer builds. Kept here in case of later need.
 SciTE-static: SciTEGTK.o SciTEBase.o SciTEBuffers.o SciTEIO.o Exporters.o SciTEProps.o \
@@ -66,15 +66,15 @@
 # This is OK - just means no SciTE in the Gnome Applications menu
 # Dead:	install -D SciTEGTK.properties $(SYSCONF_PATH)/SciTEGlobal.properties
 install:
-	install -s $(PROG) $(bindir)
-	install -d $(SYSCONF_PATH)
-	install ../src/*.properties $(SYSCONF_PATH)
-	install ../doc/*.html $(SYSCONF_PATH)
-	install ../doc/SciTEIco.png $(SYSCONF_PATH)
-	install ../doc/PrintHi.png $(SYSCONF_PATH)
+	$(BSD_INSTALL_PROGRAM) $(PROG) $(bindir)
+	$(MKDIR) $(SYSCONF_PATH)
+	$(BSD_INSTALL_DATA) ../src/*.properties $(SYSCONF_PATH)
+	$(BSD_INSTALL_DATA) ../doc/*.html $(SYSCONF_PATH)
+	$(BSD_INSTALL_DATA) ../doc/SciTEIco.png $(SYSCONF_PATH)
+	$(BSD_INSTALL_DATA) ../doc/PrintHi.png $(SYSCONF_PATH)
 ifdef gnomeprefix
-	install SciTE.desktop $(datadir)/gnome/apps/Applications
-	install Sci48M.png $(pixmapdir)
+	$(BSD_INSTALL_DATA) SciTE.desktop $(datadir)/apps/Applications
+	$(BSD_INSTALL_DATA) Sci48M.png $(pixmapdir)
 endif
 
 uninstall:
