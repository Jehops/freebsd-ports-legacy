--- Makefile.orig	Fri Mar 29 16:12:20 2002
+++ Makefile	Mon Apr  1 12:15:29 2002
@@ -1,6 +1,5 @@
  ## Makefile for IPMagic ##
 
-CC = cc
 SPELL = magic
 SRC =  ipmagic.c spellbook.c cauldron.c spells.c tcp.c icmp.c udp.c
 CON = sorcery.c spells.c ipsorcery.c icmp.c
@@ -9,16 +8,18 @@
 default:
 	@echo "Usage: make[gtk|con] then make [gtk-install|con-install]"
 
+all:   con gtk
+
 con:
-	$(CC) -g -O2 -Wall -ansi -D_CON_ $(CON) -o ipmagic
+	$(CC) $(CFLAGS) -Wall -ansi -D_CON_ $(CON) -o ipmagic
 	
 
 gtk:
-	$(CC) -g -O2 -Wall -ansi -D_GTK_ $(SRC) -o $(SPELL) `gtk-config --cflags --libs`
+	$(CC) $(CFLAGS) -Wall -ansi -D_GTK_ $(SRC) -o $(SPELL) `/usr/X11R6/bin/gtk12-config --cflags --libs`
 
 
 solaris:     
-	$(CC) -g -O2 -Wall -ansi -D_CON_ $(CON) -o $(SPELL)  -lsocket -lnsl
+	$(CC) $(CFLAGS) -Wall -ansi -D_CON_ $(CON) -o $(SPELL)  -lsocket -lnsl
 
 
 install: con-install
