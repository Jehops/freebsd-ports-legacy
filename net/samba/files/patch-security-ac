diff -u -r --new-file --exclude=CVS source/smbd/statcache.c samba-2.2.8a/source/smbd/statcache.c
--- source/smbd/statcache.c	2001-10-11 04:34:37.000000000 -0500
+++ source/smbd/statcache.c	2003-04-04 16:02:33.000000000 -0600
@@ -88,7 +88,7 @@
    * StrnCpy always null terminates.
    */
 
-  StrnCpy(orig_name, full_orig_name, namelen);
+  StrnCpy(orig_name, full_orig_name, MIN(namelen, sizeof(orig_name)-1));
   if(!case_sensitive)
     strupper( orig_name );
 
