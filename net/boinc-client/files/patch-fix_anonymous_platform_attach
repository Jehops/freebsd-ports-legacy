--- client/cs_account.C.orig	Mon Oct  3 20:05:58 2005
+++ client/cs_account.C	Wed Mar  8 18:41:37 2006
@@ -346,7 +346,7 @@
 }
 
 int CLIENT_STATE::add_project(const char* master_url, const char* _auth) {
-    char path[256], canonical_master_url[256], auth[256];
+    char path[256], canonical_master_url[256], auth[256], dir[256];
     PROJECT* project;
     FILE* f;
     int retval;
@@ -366,7 +366,7 @@
         return ERR_AUTHENTICATOR;
     }
 
-    // check if this project is already running
+    // check if we're already attached to this project
     //
     if (lookup_project(canonical_master_url)) {
         msg_printf(0, MSG_ERROR, "Already attached to %s", canonical_master_url);
@@ -392,8 +392,21 @@
     if (retval) return retval;
 
     // remove any old files
+    // (unless PROJECT/app_info.xml is found, so that
+    // people using anonymous platform don't have to get apps again)
     //
-    retval = remove_project_dir(*project);
+    get_project_dir(project, dir);
+    sprintf(path, "%s/%s", dir, APP_INFO_FILE_NAME);
+    if (boinc_file_exists(path)) {
+	project->anonymous_platform = true;
+	f = fopen(path, "r");
+	if (f) {
+	    parse_app_info(project, f);
+	    fclose(f);
+	}
+    } else {
+        retval = remove_project_dir(*project);
+    }
 
     retval = make_project_dir(*project);
     if (retval) return retval;
