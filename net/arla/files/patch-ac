Index: xfs/bsd/xfs_message.c
===================================================================
RCS file: /afs/stacken.kth.se/src/SourceRepository/arla/xfs/bsd/xfs_message.c,v
retrieving revision 1.64.2.3
diff -u -w -r1.64.2.3 xfs_message.c
--- xfs/bsd/xfs_message.c	2001/10/19 04:29:31	1.64.2.3
+++ xfs/bsd/xfs_message.c	2002/01/07 04:28:29
@@ -473,6 +473,15 @@
 	/* XXX see comment in xfs_node_find */
 	/* XXXSMP do gone[l] need to get mntvnode_slock ? */
 
+#if __FreeBSD_version >= 440002
+	for(vp = TAILQ_FIRST(&XFS_TO_VFS(&xfs[fd])->mnt_nvnodelist);
+	    vp != NULL; 
+	    vp = next) {
+
+	    next = TAILQ_NEXT(vp, v_nmntvnodes);
+	    gc_vnode (vp, p);
+	}
+#else
 	for(vp = XFS_TO_VFS(&xfs[fd])->mnt_vnodelist.lh_first;
 	    vp != NULL; 
 	    vp = next) {
@@ -480,6 +489,7 @@
 	    next = vp->v_mntvnodes.le_next;
 	    gc_vnode (vp, p);
 	}
+#endif
     } else {
 	struct xfs_node *t;
 	int i;
