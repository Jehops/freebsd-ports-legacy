--- main.c.orig	Sun Sep 22 12:13:43 1991
+++ main.c	Fri Feb 11 04:14:00 2000
@@ -15,6 +15,7 @@
 #include <sgtty.h>
 #include <signal.h>
 #include <setjmp.h>
+#include <sys/param.h>
 #include "safe_malloc.h"
 #include "str_galore.h"
 #include "config.h"
@@ -37,7 +38,7 @@
     extern int stop_printing();
     extern int continue_printing();
 
-    extern int last_c_pos;
+    extern int _rl_last_c_pos;
 #endif
 
 /* Longjmp buffer, jump there after error() or CTRL-C */
@@ -58,7 +59,7 @@
 	ldisplay("\n");
 	ldisplay("%s", rl_line_buffer);
 	rl_redisplay(count, key);
-	last_c_pos = rl_end;
+	_rl_last_c_pos = rl_end;
     }
 #endif

@@ -191,7 +192,11 @@
 #endif

     if (debug && exitval) {
+	#if defined(__FreeBSD__) && (__FreeBSD_version >= 500035)
+	signal(SIGABRT, SIG_DFL);
+	#else
	signal(SIGIOT, SIG_DFL);
+	#endif
	abort();
     }
     else
