--- Makefile.orig	2011-05-27 00:49:17.000000000 +0200
+++ Makefile	2012-05-11 19:42:37.000000000 +0200
@@ -11,7 +11,7 @@
 # Linux users, please use Makefile.linux :
 #  make -f Makefile.linux
 
-CFLAGS = -pipe -Wall -Os
+CFLAGS += -pipe -Wall
 #CFLAGS = -pipe -Wall -O -g -DDEBUG
 CC ?= gcc
 RM = rm -f
@@ -32,10 +32,12 @@
 
 # better way to find if we are using ipf or pf
 .if $(OSNAME) == "FreeBSD"
+.if defined(/etc/rc.subr) && defined(/etc/rc.conf)
 FWNAME != . /etc/rc.subr; . /etc/rc.conf; \
           if checkyesno ipfilter_enable; then \
           echo "ipf"; else echo "pf"; fi
 .endif
+.endif
 
 .if $(OSNAME) == "NetBSD"
 FWNAME != . /etc/rc.subr; . /etc/rc.conf; \
