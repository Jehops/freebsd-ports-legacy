
$FreeBSD$

--- ztcfg/Makefile.orig	Mon May 17 18:00:11 2004
+++ ztcfg/Makefile	Mon May 17 04:09:57 2004
@@ -1,10 +1,10 @@
-CFLAGS+= -I/usr/local/include -I. -I../zaptel -DUSE_LOCAL_INCLUDE=1
-INSTALL=/usr/bin/install
+CFLAGS+= -I${.CURDIR} -I${.CURDIR}/../zaptel -I${PREFIX}/include -DUSE_LOCAL_INCLUDE=1 \
+         -DPREFIX=\"${PREFIX}\"
 
 all: ztcfg libtonezone.a
 
 ztcfg: ztcfg.o  tonezone.o zonedata.o
-	$(CC) -o ztcfg ztcfg.o tonezone.o zonedata.o -lm -L. 
+	$(CC) -o ztcfg ztcfg.o tonezone.o zonedata.o -lm -L${.CURDIR}
 
 ztcfg.c: ztcfg.h
 
@@ -12,9 +12,14 @@
 	ar r libtonezone.a tonezone.o zonedata.o
 
 install:
-	$(INSTALL) -o root -g wheel -m 644 libtonezone.a /usr/local/lib/
-	$(INSTALL) -o root -g wheel -m 644 tonezone.h /usr/local/include/
-	$(INSTALL) -o root -g wheel -m 644 ../zaptel/zaptel.h /usr/local/include/
+	${BSD_INSTALL_PROGRAM} ztcfg ${PREFIX}/bin
+	${BSD_INSTALL_DATA} libtonezone.a ${PREFIX}/lib
+	${BSD_INSTALL_DATA} tonezone.h ${PREFIX}/include
+	${BSD_INSTALL_DATA} ${.CURDIR}/../zaptel/zaptel.h ${PREFIX}/include
+	${BSD_INSTALL_DATA} zaptel.conf.sample ${PREFIX}/etc
+	if [ ! -f %B/zaptel.conf ]; then \
+		${BSD_INSTALL_DATA} zaptel.conf.sample ${PREFIX}/etc/zaptel.conf; \
+	fi
 
 clean: 
 	rm -f *.o ztcfg *.a
