--- ./src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c.orig	2011-09-30 10:12:07.000000000 -0400
+++ ./src/modules/rlm_eap/types/rlm_eap_tls/rlm_eap_tls.c	2012-09-11 07:28:34.000000000 -0400
@@ -531,7 +531,7 @@
 	 */
 	buf[0] = '\0';
 	asn_time = X509_get_notAfter(client_cert);
-	if ((lookup <= 1) && asn_time && (asn_time->length < MAX_STRING_LEN)) {
+	if ((lookup <= 1) && asn_time && (asn_time->length < sizeof(buf))) {
 		memcpy(buf, (char*) asn_time->data, asn_time->length);
 		buf[asn_time->length] = '\0';
 		pairadd(&handler->certs,
