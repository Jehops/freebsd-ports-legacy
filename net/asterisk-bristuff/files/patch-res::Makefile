--- res/Makefile.orig	Tue Jul  3 23:32:47 2007
+++ res/Makefile	Tue Jul  3 23:39:56 2007
@@ -37,8 +37,8 @@
 endif
 
 ifeq ($(findstring BSD,${OSARCH}),BSD)
-  CFLAGS+=-I$(CROSS_COMPILE_TARGET)/usr/local/include
-  SOLINK+=-L$(CROSS_COMPILE_TARGET)/usr/local/lib
+  CFLAGS+=-I$(CROSS_COMPILE_TARGET)$(LOCALBASE)/include
+  SOLINK+=-L$(CROSS_COMPILE_TARGET)$(LOCALBASE)/lib
 endif
 
 ifeq (${OSARCH},CYGWIN)
@@ -55,9 +55,7 @@
 CFLAGS+=
 
 ifndef WITHOUT_ZAPTEL
-ifneq ($(wildcard $(CROSS_COMPILE_TARGET)/usr/include/linux/zaptel.h)$(wildcard $(CROSS_COMPILE_TARGET)/usr/local/include/zaptel.h),)
-  CFLAGS+=-DZAPATA_MOH
-endif
+  CFLAGS+=-DZAPATA_MOH -I$(CROSS_COMPILE_TARGET)$(LOCALBASE)/include/zaptel
 endif # WITHOUT_ZAPTEL
 
 #
@@ -75,7 +73,7 @@
 	rm -f $(DESTDIR)$(ASTHEADERDIR)/parking.h
 	rm -f $(DESTDIR)$(MODULES_DIR)/app_agi.so 
 	rm -f $(DESTDIR)$(MODULES_DIR)/res_parking.so
-	for x in $(MODS); do $(INSTALL) -m 755 $$x $(DESTDIR)$(MODULES_DIR) ; done
+	for x in $(MODS); do $(BSD_INSTALL_PROGRAM) $$x $(DESTDIR)$(MODULES_DIR) ; done
 	@if [ x`which mpg123 2>/dev/null | grep -v '^no'` != x ] ; then \
 	  if mpg123 --longhelp 2>&1 | grep -q .59r 2>&1 >/dev/null ; then echo ; else \
 			echo "*************************************************************";\
