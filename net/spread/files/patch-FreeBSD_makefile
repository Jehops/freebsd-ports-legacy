--- FreeBSD_makefile.orig	Mon Oct  2 16:09:34 2000
+++ FreeBSD_makefile	Mon Jun 11 02:10:13 2001
@@ -1,4 +1,3 @@
-CC=gcc
 MAKEFILE=FreeBSD_makefile
 YACC = bison -y
 LEX = flex
@@ -8,8 +7,8 @@
 #SRCDIRS= dir1 dir2
 #INCL=$(SRCDIRS:%=-I%)
 #CFLAGS =  -O does not always work on BSDI pc
-CFLAGS = -ansi -c -Wall -O3
-TCFLAGS = $(CFLAGS) -pthread
+CFLAGS+= -ansi -c
+TCFLAGS = $(CFLAGS) $(PTHREAD_LIBS)
 
 COBJS = lex.yy.o y.tab.o configuration.o skiplist.o
 OBJS =  alarm.o events.o memory.o membership.o data_link.o network.o status.o log.o flow_control.o message.o
@@ -28,7 +27,7 @@
 	$(CC) -o user user.o libsp.a
 
 tuser : user.to libtsp.a 
-	$(CC) -pthread -o tuser user.to libtsp.a
+	$(CC) $(PTHREAD_LIBS) -o tuser user.to libtsp.a
 
 simple_user : simple_user.o libsp.a
 	$(CC) -o simple_user simple_user.o libsp.a 
@@ -64,7 +63,7 @@
 	$(CC) $(CFLAGS) $*.c
 
 .c.to:	
-	$(CC) $(TCFLAGS) -D_THREAD_SAFE -D_REENTRANT $*.c -o $*.to
+	$(CC) $(TCFLAGS) $(PTHREAD_CFLAGS) -D_REENTRANT $*.c -o $*.to
 
 depend:
 	cp $(MAKEFILE) $(MAKEFILE).bak \
