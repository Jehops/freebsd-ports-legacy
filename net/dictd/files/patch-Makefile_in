--- Makefile.in.orig	Mon Jun 10 02:33:02 2002
+++ Makefile.in	Mon Jun 10 02:37:31 2002
@@ -33,7 +33,7 @@
 srcdir=		@srcdir@
 VPATH=		@srcdir@
 prefix=		@prefix@
-subdirs=        @allsubdirs@ regex # doc -- use rfc2229 instead
+subdirs=        @allsubdirs@ # regex # doc -- use rfc2229 instead
 exec_prefix=	@exec_prefix@
 man1_prefix=	@mandir@/man1
 man8_prefix=	@mandir@/man8
@@ -57,9 +57,9 @@
 		-DDICT_CONFIG_PATH=\"$(conf)\"
 SCFLAGS=        @SCFLAGS@
 LDFLAGS=        @LDFLAGS@
-XTRACFLAGS=     @WCFLAGS@ @XTRACFLAGS@ @DEFS@ @CPPFLAGS@ -I. -Iregex
+XTRACFLAGS=     @WCFLAGS@ @XTRACFLAGS@ @DEFS@ @CPPFLAGS@ -I. # -Iregex
 XTRALDFLAGS=    @WLDFLAGS@ @XTRALDFLAGS@
-LDLIBS=		@LIBS@ -Lregex -lregex
+LDLIBS=		@LIBS@ -L%%PREFIX%%/lib -lltdl # -Lregex -lregex
 
 EXES=	 	dict dictd dictzip
 
@@ -75,17 +75,7 @@
 all $(EXES)::
 	@for subdir in `echo $(subdirs)`; do \
 		echo making in $$subdir; \
-	 	if [ "$$subdir" = "zlib" ]; then \
-			(cd $$subdir \
-			&& $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS)" libz.a) \
-			|| exit 1; \
-		elif [ "$$subdir" = "regex" ]; then \
-			(cd $$subdir \
-			&& $(MAKE) CC="$(CC) $(CFLAGS)" lib) \
-			|| exit 1; \
-		else \
-			(cd $$subdir && $(MAKE)) || exit 1; \
-		fi; \
+		(cd $$subdir && $(MAKE)) || exit 1; \
 	done
 
 all:: $(EXES)
@@ -116,11 +106,13 @@
 servscan.o: servscan.c servparse.o servparse.h $(HEADERS)
 	$(CC) -c $(XTRACFLAGS) $(CFLAGS) $(SCFLAGS) $<
 
-servparse.c: servparse.y
-	$(YACC) -tdv $<
-	cmp -s y.tab.h servparse.h || mv y.tab.h servparse.h
-	cmp -s y.tab.c servparse.c || mv y.tab.c servparse.c
-	-rm -f y.tab.h y.tab.c
+servparse.c: servparse.h
+
+servparse.h: servparse.y
+	$(YACC) -tdv -b serv $<
+	cmp -s serv.tab.h servparse.h || mv serv.tab.h servparse.h
+	cmp -s serv.tab.c servparse.c || mv serv.tab.c servparse.c
+	-rm -f serv.tab.h serv.tab.c
 
 servparse.o: servparse.c $(HEADERS)
 	$(CC) -c $(XTRACFLAGS) $(CFLAGS) $(SCFLAGS) $<
