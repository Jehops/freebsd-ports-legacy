--- Wnn/jlib.V3/Makefile.in.orig	Fri Jan 21 01:00:28 2000
+++ Wnn/jlib.V3/Makefile.in	Fri Sep  1 10:21:03 2000
@@ -51,8 +51,24 @@
 OBJ3= sstrings.o
 SRC4= $(WNNETCSRC)/xutoj.c
 OBJ4= xutoj.o
+LOCAL_RKSRCS= $(WNNROMKANSRC)/rk_bltinfn.c 	$(WNNROMKANSRC)/rk_main.c 	$(WNNROMKANSRC)/rk_modread.c 	$(WNNROMKANSRC)/rk_read.c 	$(WNNROMKANSRC)/rk_vars.c
+
+LOCAL_RKOBJS= $(WNNROMKANSRC)/rk_bltinfn.o 	$(WNNROMKANSRC)/rk_main.o 	$(WNNROMKANSRC)/rk_modread.o 	$(WNNROMKANSRC)/rk_read.o 	$(WNNROMKANSRC)/rk_vars.o
+
+LOCAL_ETCSRCS= $(WNNETCSRC)/msg.c $(WNNETCSRC)/yincoding.c $(WNNETCSRC)/py_table.c $(WNNETCSRC)/zy_table.c $(WNNETCSRC)/strings.c $(WNNETCSRC)/bcopy.c $(WNNETCSRC)/mkdir.c
+
+LOCAL_ETCOBJS= $(WNNJLIBSRC)/msg.o $(WNNJLIBSRC)/yincoding.o $(WNNJLIBSRC)/py_table.o $(WNNJLIBSRC)/zy_table.o $(WNNJLIBSRC)/strings.o $(WNNJLIBSRC)/bcopy.o $(WNNJLIBSRC)/mkdir.o
+
+LOCAL_JLIBSRCS= $(WNNJLIBSRC)/js.c $(WNNJLIBSRC)/wnnerrmsg.c $(WNNJLIBSRC)/jl.c $(WNNJLIBSRC)/getopt.c
+
+LOCAL_JLIBOBJS= $(WNNJLIBSRC)/js.o $(WNNJLIBSRC)/wnnerrmsg.o $(WNNJLIBSRC)/jl.o $(WNNJLIBSRC)/getopt.o
+
 SRCS= $(SRC1) $(SRC2) $(SRC3) $(SRC4)
-OBJS= $(OBJ1) $(OBJ2) $(OBJ3) $(OBJ4)
+OBJS= $(OBJ1) $(OBJ2) $(OBJ3) $(OBJ4) $(LOCAL_ETCOBJS) $(LOCAL_RKOBJS) $(LOCAL_JLIBOBJS)
+
+clean::
+	$(RM) -r .libs
+	$(RM) *.lo *.la
 
 all::
 
@@ -60,16 +76,12 @@
 
 .c.o:
 	$(RM) $@
-	$(CC) -c $(CFLAGS) $(_NOOP_) $*.c
-
-clean::
+	$(LIBTOOL) $(CC) -c $(CFLAGS) $(_NOOP_) $*.c
 
-all:: libjd.a
+all:: libjd.la
 
-libjd.a: $(OBJS) $(WNNJLIB)
-	cp $(WNNJLIB) $@
-	ar rv $@ $(OBJS)
-	$(RANLIB) $@
+libjd.la: $(OBJS) $(EXTRALIBRARYDEPS)
+	$(LIBTOOL) $(CC) -o $@ $(OBJS:.o=.lo) -rpath $(DESTDIR)$(WNNLIBDIR) -version-info $(WNNJLIBVERSION)
 
 lintlib:: llib-ljd.ln
 
@@ -77,11 +89,10 @@
 	$(RM) $@
 	$(LINT) $(LINTLIBFLAG)jd $(LINTFLAGS) $(SRCS)
 
-install:: libjd.a
+install:: libjd.la
 	@if [ -d $(DESTDIR)$(WNNLIBDIR) ]; then set +x; \
 	else (set -x; $(MKDIRHIER) $(DESTDIR)$(WNNLIBDIR)); fi
-	$(INSTALL) $(INSTALLFLAGS) $(INSTLIBFLAGS) libjd.a $(DESTDIR)$(WNNLIBDIR)
-	$(RANLIB) $(RANLIBINSTFLAGS) $(DESTDIR)$(WNNLIBDIR)/libjd.a
+	$(LIBTOOL) $(INSTALL) $(INSTALLFLAGS) $(INSTLIBFLAGS) libjd.la $(DESTDIR)$(WNNLIBDIR)
 
 install:: jlib.h
 	@if [ -d $(DESTDIR)$(JWNNINCDIR) ]; then set +x; \
@@ -104,13 +115,13 @@
 	done
 
 $(OBJ2) : $(SRC2)
-	$(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
+	$(LIBTOOL) $(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
 
 $(OBJ3) : $(SRC3)
-	$(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
+	$(LIBTOOL) $(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
 
 $(OBJ4) : $(SRC4)
-	$(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
+	$(LIBTOOL) $(CC) -c $(CFLAGS)  $(WNNETCSRC)/`basename $@ .o`.c
 
 depend:: .depend
 
