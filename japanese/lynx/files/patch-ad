--- src/LYHistory.c.orig	Sat Apr  1 09:33:40 2000
+++ src/LYHistory.c	Thu Jul 13 17:43:32 2000
@@ -528,6 +528,20 @@
 	} else {
 	    StrAllocCopy(Title, NO_TITLE);
 	}
+	if (HTCJK == JAPANESE) {
+	    char *tmp;
+
+	    if ((tmp = (char *)calloc(strlen(Title)*2, sizeof(char *))) == NULL)
+		outofmem(__FILE__, "showhistory");
+	    *tmp = '\0';
+	    if (kanji_code == EUC) {
+		TO_EUC(Title, tmp);
+	    } else if (kanji_code == SJIS) {
+		TO_SJIS(Title, tmp);
+	    }
+	    if (*tmp) StrAllocCopy(Title, tmp);
+	    FREE(tmp);
+	}
 	fprintf(fp0,
 		"%s<em>%d</em>. <tab id=t%d><a href=\"LYNXHIST:%d\">%s</a>\n",
 		(x > 99 ? "" : x < 10 ? "  " : " "),
@@ -765,6 +779,20 @@
 		StrAllocCopy(Title , NO_TITLE);
 	} else {
 	    StrAllocCopy(Title , NO_TITLE);
+	}
+	if (HTCJK == JAPANESE) {
+	    char *tmp;
+
+	    if ((tmp = (char *)calloc(strlen(Title)*2, sizeof(char *))) == NULL)
+		outofmem(__FILE__, "LYShowVisitedLinks");
+	    *tmp = '\0';
+	    if (kanji_code == EUC) {
+		TO_EUC(Title, tmp);
+	    } else if (kanji_code == SJIS) {
+		TO_SJIS(Title, tmp);
+	    }
+	    if (*tmp) StrAllocCopy(Title, tmp);
+		FREE(tmp);
 	}
 	if (vl->address != NULL && *vl->address != '\0') {
 	    StrAllocCopy(Address, vl->address);
