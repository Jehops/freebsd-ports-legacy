diff -uNr Canna32p1/Canna.conf Canna32p1-FreeBSD2.0/Canna.conf
--- Canna32p1/Canna.conf	Tue May 31 08:47:26 1994
+++ Canna32p1-FreeBSD2.0/Canna.conf	Sat Jan 14 00:00:01 1995
@@ -119,10 +119,10 @@
 cannaLibDir = /usr/local/canna/lib
 cannaManDir = /usr/local/canna/man
 cannaIncDir = /usr/local/canna/include/canna
-libCannaDir = /usr/lib
+libCannaDir = /usr/local/lib
 
-ErrDir  = /usr/spool/canna
-LockDir = /usr/spool/canna/lock
+ErrDir  = /var/spool/canna
+LockDir = /var/spool/canna/lock
 
 wcharDefinition = -DCANNA_WCHAR
 Wlib =
@@ -135,7 +135,7 @@
 
 pointerIntegerDef =
 
-cannaDsoRev = 1
+cannaDsoRev = 1.0
 sharedLibExtension = so.$(cannaDsoRev)
 
 /* 以下の３つは root にならないでインストールするのであれば echo に
diff -uNr Canna32p1/canna/Imakefile Canna32p1-FreeBSD2.0/canna/Imakefile
--- Canna32p1/canna/Imakefile	Tue Apr 12 07:32:59 1994
+++ Canna32p1-FreeBSD2.0/canna/Imakefile	Sat Jan 14 13:37:38 1995
@@ -1,7 +1,6 @@
 /* $Id: Imakefile,v 2.4 1994/04/12 12:32:59 kon Exp $ */
 #include "../Canna.conf"
 
-      INSTALLFLAGS = $(INSTINCFLAGS)
          CANNAROOT = ..
       CANNA_HEADER = jrkanji.h  keydef.h mfdef.h
       OSDEP_HEADER = net.h widedef.h
diff -uNr Canna32p1/canna/widedef.h Canna32p1-FreeBSD2.0/canna/widedef.h
--- Canna32p1/canna/widedef.h	Tue May 31 08:47:33 1994
+++ Canna32p1-FreeBSD2.0/canna/widedef.h	Sat Jan 14 14:03:43 1995
@@ -27,6 +27,10 @@
 #ifndef _WIDEDEF_H_
 #define _WIDEDEF_H_
      
+#if defined(__FreeBSD__) || defined(__NetBSD__)
+# include <machine/ansi.h>
+#endif
+
 #if __STDC__ || defined(SVR4) || defined(sun) /* This may be wrong. */
 # if !defined(WCHAR16) && !defined(CANNA_WCHAR)
 #  define HAVE_WCHAR_OPERATION
@@ -40,6 +44,18 @@
 #endif
 #endif /* HAVE_WCHAR_OPERATION */
 
+#if defined(__FreeBSD__) || defined(__NetBSD__)
+# ifdef _BSD_WCHAR_T_
+#  undef _BSD_WCHAR_T_
+#  ifdef WCHAR16
+#   define _BSD_WCHAR_T_ unsigned short
+#  else
+#   define _BSD_WCHAR_T_ unsigned long
+#  endif
+# include <stddef.h>
+# define _WCHAR_T
+# endif
+#else
 #if !defined(WCHAR_T) && !defined(_WCHAR_T) && !defined(_WCHAR_T_) \
  && !defined(__WCHAR_T) && !defined(_GCC_WCHAR_T)
 # ifdef WCHAR16
@@ -53,6 +69,7 @@
 # define _WCHAR_T_
 # define __WCHAR_T
 # define _GCC_WCHAR_T
+#endif
 #endif
 
 #endif /* _WIDEDEF_H_ */
diff -uNr Canna32p1/cmd/crfreq/crfreq.c Canna32p1-FreeBSD2.0/cmd/crfreq/crfreq.c
--- Canna32p1/cmd/crfreq/crfreq.c	Mon Feb  7 04:52:39 1994
+++ Canna32p1-FreeBSD2.0/cmd/crfreq/crfreq.c	Sat Jan 14 13:37:51 1995
@@ -25,6 +25,7 @@
 #endif
 
 #include "RKintern.h"
+#include <sys/types.h>
 #include <stdio.h>
 #include <fcntl.h>
 
@@ -148,7 +149,7 @@
     doff = off;
     off += hd.data[HD_SIZ].var;
     if (!strncmp(".swd", (char *)(hd.data[HD_DMNM].ptr + strlen((char *)hd.data[HD_DMNM].ptr) - 4), 4)) {
-      if (lseek(fd, (long)off, 0) < 0 || read(fd, (char *)ll, 4) != 4) 
+      if (lseek(fd, (off_t)off, 0) < 0 || read(fd, (char *)ll, 4) != 4) 
 	err = 1;
       off += bst4_to_l(ll) + 4;
     }
@@ -211,7 +212,7 @@
   }
   fqoffset = 0;
   for (i = 0; i < lk; i++) {
-    (void)lseek(fd, (long)doff, 0);
+    (void)lseek(fd, (off_t)doff, 0);
     doff += sz;
     if (read(fd, (char *)buf, sz) != sz) {
       (void)fprintf(stderr, "%s: cannot read %s.\n", program, dmnm);
diff -uNr Canna32p1/cmd/dicar/dicar.c Canna32p1-FreeBSD2.0/cmd/dicar/dicar.c
--- Canna32p1/cmd/dicar/dicar.c	Fri Jan 28 01:37:36 1994
+++ Canna32p1-FreeBSD2.0/cmd/dicar/dicar.c	Sat Jan 14 13:37:55 1995
@@ -229,7 +229,7 @@
     if (!fname || !strcmp(fname, key)) { /* 原子辞書が同じ時 */
       if ((dst = openForWrite(key)) >= 0) {
 	actmessage("x", key); /* 出力メッセージ */
-	(void)lseek(fd, offset, 0);
+	(void)lseek(fd, (off_t)offset, 0);
 	copyfile(fd, dst, dmsize);
 	closeForWrite(dst, key);
       }
@@ -330,7 +330,7 @@
 	  (void)strcpy(key, childdic[i].key);
 	  (void)strcat(key, ".d");
 	  actmessage("r", key); /* 出力メッセージ */
-	  (void)lseek(atm, childdic[i].offset, 0);
+	  (void)lseek(atm, (off_t)childdic[i].offset, 0);
 	  copyfile(atm, dst, childdic[i].size);
 	  childdic[i].flag = 0;
 	  break;
@@ -339,7 +339,7 @@
       _RkClearHeader(&hd);
 
       if (i == num) { /* リプレース指定されていなければ */
-	(void)lseek(src, offset, 0);
+	(void)lseek(src, (off_t)offset, 0);
 	copyfile(src, dst, dmsize);
       }
       offset += dmsize;
@@ -352,7 +352,7 @@
       (void)strcpy(key, childdic[i].key);
       (void)strcat(key, ".d");
       actmessage("a", key); /* 出力メッセージ */
-      (void)lseek(atm, childdic[i].offset, 0);
+      (void)lseek(atm, (off_t)childdic[i].offset, 0);
       copyfile(atm, dst, childdic[i].size);
     }
   }
@@ -385,7 +385,7 @@
     _RkClearHeader(&hd);
 
     if (strcmp(fname, key)) { /* 指定原子辞書以外はコピー */
-      (void)lseek(src, offset, 0);
+      (void)lseek(src, (off_t)offset, 0);
       copyfile(src, dst, dmsize);
     }
     else {
diff -uNr Canna32p1/cmd/dpxdic/dpxdic.c Canna32p1-FreeBSD2.0/cmd/dpxdic/dpxdic.c
--- Canna32p1/cmd/dpxdic/dpxdic.c	Sat Jan 14 12:57:21 1995
+++ Canna32p1-FreeBSD2.0/cmd/dpxdic/dpxdic.c	Sat Jan 14 13:37:57 1995
@@ -219,7 +219,7 @@
   }
   if (!(buf = (unsigned char *)malloc(size)))
     return(-1);
-  (void)lseek(fd, (long)off, 0);
+  (void)lseek(fd, (off_t)off, 0);
   if (read(fd, (char *)buf, size) != size)
     return(-1);
   dic->buf = buf;
@@ -253,7 +253,7 @@
       return(-1);
     }
     
-    (void)lseek(fd, (long)off, 0);
+    (void)lseek(fd, (off_t)off, 0);
     if (read(fd, (char *)buf, size) != size) {
       (void)fprintf(stderr, "cannot read page %d (%d)\n", id, size);
       return(-1);
@@ -445,7 +445,7 @@
     doff = off;
     off += hd.data[HD_SIZ].var;
     if (!strncmp(".swd", (char *)(hd.data[HD_DMNM].ptr + strlen((char *)hd.data[HD_DMNM].ptr) - 4), 4)) {
-      if (lseek(fd, (long)off, 0) < 0 || read(fd, (char *)ll, 4) != 4)
+      if (lseek(fd, (off_t)off, 0) < 0 || read(fd, (char *)ll, 4) != 4)
 	err = 1;
       off += bst4_to_l(ll) + 4;
     }
diff -uNr Canna32p1/lib/RK/RKfq.c Canna32p1-FreeBSD2.0/lib/RK/RKfq.c
--- Canna32p1/lib/RK/RKfq.c	Wed Jun  1 01:54:20 1994
+++ Canna32p1-FreeBSD2.0/lib/RK/RKfq.c	Sat Jan 14 13:37:28 1995
@@ -25,6 +25,7 @@
 #endif
 
 #include	"RKintern.h"
+#include <sys/types.h>
 
 #if defined(USG) || defined(SYSV) || defined(SVR4)
 #include <string.h>
@@ -542,13 +543,13 @@
 	|| ((struct ND *)codm->dm_xdm)->can != hd.data[HD_CAN].var)
       break;
     off += hd.data[HD_HSZ].var;
-    (void)lseek(fd, off, 0);
+    (void)lseek(fd, (off_t)off, 0);
     (void)read(fd, (char *)ll, 4);
     off += 4;
     bitsiz = L4TOL(ll);
     bitoff = off;
     off += bitsiz;
-    (void)lseek(fd, off, 0);
+    (void)lseek(fd, (off_t)off, 0);
     dmh = &df->df_members;
     for (dm = dmh->dm_next; dm != dmh; dm = dm->dm_next) {
       if (!strcmp((char *)dm->dm_dicname, (char *)hd.data[HD_CODM].ptr)) {
@@ -620,7 +621,7 @@
     qm->dm_qbits = (unsigned char *)malloc((unsigned)xqm->ex_bsiz);
     if (!qm->dm_qbits) 
       return -1;
-    (void)lseek(fd, xqm->ex_boff, 0);
+    (void)lseek(fd, (off_t)xqm->ex_boff, 0);
     (void)read(fd, (char *)qm->dm_qbits, (int)xqm->ex_bsiz);
     qm->dm_rut = LoadRUC(fd);
     qm->dm_nv = readNV(fd);
@@ -650,7 +651,7 @@
   if (xqm) {
     if (qm->dm_qbits) {
       if (qm->dm_flags & DM_UPDATED) {
-	(void)lseek(fd, xqm->ex_boff, 0);
+	(void)lseek(fd, (off_t)xqm->ex_boff, 0);
 	(void)write(fd, (char *)qm->dm_qbits, (int)xqm->ex_bsiz);
       };
       (void)free((char *)qm->dm_qbits);
@@ -702,7 +703,7 @@
   if (xqm) {
     if (qm->dm_qbits) {
       if (qm->dm_flags & DM_UPDATED) {
-	(void)lseek(fd, xqm->ex_boff, 0);
+	(void)lseek(fd, (off_t)xqm->ex_boff, 0);
 	if (write(fd, (char *)qm->dm_qbits, (int)xqm->ex_bsiz) != 
 	    (int) xqm->ex_bsiz)
 	  rv = -1;
diff -uNr Canna32p1/lib/RK/RKngram.c Canna32p1-FreeBSD2.0/lib/RK/RKngram.c
--- Canna32p1/lib/RK/RKngram.c	Wed Jun  1 01:54:27 1994
+++ Canna32p1-FreeBSD2.0/lib/RK/RKngram.c	Sat Jan 14 13:37:30 1995
@@ -26,6 +26,7 @@
 
 #include	"RKintern.h"
 
+#include	<sys/types.h>
 #include	<stdio.h>
 #ifdef SVR4
 #include	<unistd.h>
@@ -141,7 +142,7 @@
 			  + strlen((char *)hd.data[HD_DMNM].ptr) - 4),
 		 4)) {
       lk = 0;
-      if (lseek(fd, off, 0) < 0) {
+      if (lseek(fd, (off_t)off, 0) < 0) {
 	lk = 1;
 	RkSetErrno(RK_ERRNO_EACCES);
       }
diff -uNr Canna32p1/lib/RK/RKpermdic.c Canna32p1-FreeBSD2.0/lib/RK/RKpermdic.c
--- Canna32p1/lib/RK/RKpermdic.c	Sat Jan 14 12:57:51 1995
+++ Canna32p1-FreeBSD2.0/lib/RK/RKpermdic.c	Sat Jan 14 13:37:30 1995
@@ -26,6 +26,7 @@
 
 #include	"RKintern.h"
 
+#include	<sys/types.h>
 #ifdef SVR4
 #include	<unistd.h>
 #endif
@@ -82,7 +83,7 @@
 		 (char *)(hd.data[HD_DMNM].ptr
 			  + strlen((char *)hd.data[HD_DMNM].ptr) - 4),
 		 4)) {
-      if (lseek(fd, off, 0) < 0 || read(fd, (char *)ll, 4) != 4)
+      if (lseek(fd, (off_t)off, 0) < 0 || read(fd, (char *)ll, 4) != 4)
 	err++;
       off += bst4_to_l(ll) + 4;
     }
@@ -159,7 +160,7 @@
     xdm->pgs[i].count = 0;
     xdm->pgs[i].buf = (unsigned char *) 0;
   }
-  (void)lseek(fd, xdm->doff, 0);
+  (void)lseek(fd, (off_t)xdm->doff, 0);
   if (read(fd, (char *)xdm->buf, xdm->drsz) != xdm->drsz) {
     (void)free((char *)xdm->pgs);
     (void)free((char *)xdm->buf);
@@ -170,7 +171,7 @@
   if (dm->dm_class == ND_SWD) {
     struct RkKxGram *gram;
 
-    lseek(fd, xdm->doff + xdm->drsz + xdm->ttlpg * xdm->pgsz, 0);
+    lseek(fd, (off_t)(xdm->doff + xdm->drsz + xdm->ttlpg * xdm->pgsz), 0);
     gram = RkReadGram(fd);
     if (gram) {
       dm->dm_gram = (struct RkGram *)malloc(sizeof(struct RkGram));
@@ -265,7 +266,7 @@
   if (!isLoadedPage(dic->pgs + id)) {
     if (!(buf = (unsigned char *)malloc(size)))
       return((unsigned char *)0);
-    (void)lseek(fd, off, 0);
+    (void)lseek(fd, (off_t)off, 0);
     if (read(fd, (char *)buf, size) != size) {
       free((char *)buf);
       return((unsigned char *)0);
diff -uNr Canna32p1/lib/RK/RKutil.c Canna32p1-FreeBSD2.0/lib/RK/RKutil.c
--- Canna32p1/lib/RK/RKutil.c	Wed Jun  1 01:54:39 1994
+++ Canna32p1-FreeBSD2.0/lib/RK/RKutil.c	Sat Jan 14 13:37:31 1995
@@ -25,6 +25,7 @@
 #endif
 
 #include "RKintern.h"
+#include <sys/types.h>
 #include <stdio.h>
 
 static char	*Hdrtag[] = {
@@ -219,7 +220,7 @@
     hd->flag[i] = 0;
   }
   /* 次の off_from_top の計算がうさんくさいぞ */
-  if (lseek(fd, off_from_top, 0) < 0) {
+  if (lseek(fd, (off_t)off_from_top, 0) < 0) {
     RkSetErrno(RK_ERRNO_EACCES);
     goto read_err;
   }
@@ -255,7 +256,7 @@
       if (off < hdrsize) {
 	(void)memcpy(hd->data[i].ptr, localbuffer + off, len);
       } else {
-	if (lseek(fd, (long)(off_from_top + off), 0) < 0) {
+	if (lseek(fd, (off_t)(off_from_top + off), 0) < 0) {
 	  RkSetErrno(RK_ERRNO_EACCES);
 	  goto read_err;
 	}
diff -uNr Canna32p1/lib/RKC/Imakefile Canna32p1-FreeBSD2.0/lib/RKC/Imakefile
--- Canna32p1/lib/RKC/Imakefile	Sat Jan 14 12:57:53 1995
+++ Canna32p1-FreeBSD2.0/lib/RKC/Imakefile	Sat Jan 14 13:37:36 1995
@@ -26,7 +26,7 @@
 
 #if ProjectX > 5
 #define LibName RKC
-#define SoRev		cannaDsoRev
+#define SoRev cannaDsoRev
 #define SHLIBDIR	libCannaDir
 #define USRLIBDIR	libCannaDir
 #define LibHeaders 0
diff -uNr Canna32p1/lib/RKC16/Imakefile Canna32p1-FreeBSD2.0/lib/RKC16/Imakefile
--- Canna32p1/lib/RKC16/Imakefile	Sat Jan 14 12:57:58 1995
+++ Canna32p1-FreeBSD2.0/lib/RKC16/Imakefile	Sat Jan 14 13:37:37 1995
@@ -23,7 +23,7 @@
 
 #if ProjectX > 5
 #define LibName RKC16
-#define SoRev		cannaDsoRev
+#define SoRev cannaDsoRev
 #define SHLIBDIR	libCannaDir
 #define USRLIBDIR	libCannaDir
 #define LibHeaders 0
diff -uNr Canna32p1/lib/canna/Imakefile Canna32p1-FreeBSD2.0/lib/canna/Imakefile
--- Canna32p1/lib/canna/Imakefile	Sat Jan 14 12:58:00 1995
+++ Canna32p1-FreeBSD2.0/lib/canna/Imakefile	Sat Jan 14 13:37:32 1995
@@ -56,7 +56,7 @@
 
 #if ProjectX > 5
 #define LibName canna
-#define SoRev		cannaDsoRev
+#define SoRev cannaDsoRev
 #define SHLIBDIR	libCannaDir
 #define USRLIBDIR	libCannaDir
 #define LibHeaders 0
diff -uNr Canna32p1/lib/canna16/Imakefile Canna32p1-FreeBSD2.0/lib/canna16/Imakefile
--- Canna32p1/lib/canna16/Imakefile	Sat Jan 14 12:58:07 1995
+++ Canna32p1-FreeBSD2.0/lib/canna16/Imakefile	Sat Jan 14 13:37:35 1995
@@ -58,7 +58,7 @@
 
 #if ProjectX > 5
 #define LibName canna16
-#define SoRev		cannaDsoRev
+#define SoRev cannaDsoRev
 #define SHLIBDIR	libCannaDir
 #define USRLIBDIR	libCannaDir
 #define LibHeaders 0
