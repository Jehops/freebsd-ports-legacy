TEXIFILE= emacs.texi
INFOFILE= ../info/emacs-ja

EMACS?=	emacs
FORMAT_FLAG?= t

EMACS_ARGS= -batch -nw --multibyte -no-init-file -no-site-file
EMACS_LOADLIBS= --load=texinfmt.el
EMACS_FUNCALLS=	--eval "(texinfo-format-buffer ${FORMAT_FLAG})" -f save-buffer

all: ${INFOFILE}

MAKEINFO-BY-EMACS: .USE
	${EMACS} ${EMACS_ARGS} ${EMACS_LOADLIBS} ${.ALLSRC} ${EMACS_FUNCALLS} \
		> /dev/null 2>&1

${INFOFILE}: ${TEXIFILE} MAKEINFO-BY-EMACS

install: all
	${BSD_INSTALL_DATA} ${INFOFILE} ${PREFIX}/info

clean:
	rm -f ${INFOFILE}
