diff -arcN ../sjxa-1.5.11.org/CONFIG ./CONFIG
*** ../sjxa-1.5.11.org/CONFIG	Wed Jun 21 14:20:18 1995
--- ./CONFIG	Mon Aug 12 17:23:42 1996
***************
*** 94,105 ****
  
  #elif defined(FreeBSDArchitecture)		/**/
  
  #define HasSjisLocale		NO
  #define HasJlsFunction		NO
  #define UseXIMCP		YES
  #define UseXIMP			YES
  #define UseXLC			YES
! #define ManDir			/usr/share/man/man1
  
  #elif defined(SGIArchitecture)			/**/
  
--- 94,117 ----
  
  #elif defined(FreeBSDArchitecture)		/**/
  
+ /*
+  * Change some default value and add some variables.
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ /* #define UseInstalledSj3Lib	YES */
+ /* #define Sj3LibDir		/usr/local/lib */
  #define HasSjisLocale		NO
  #define HasJlsFunction		NO
  #define UseXIMCP		YES
  #define UseXIMP			YES
  #define UseXLC			YES
! #define UseSJX			NO
! #define JapaneseManLocale	eucJP
! #define JapaneseManDir		/usr/X11R6/man/ja/man1
! #define ManDir			/usr/X11R6/man/man1
! #define SjxaBinDir		/usr/X11R6/bin
! #define SjxaAppDir		/usr/X11R6/lib/X11
! #define SjxarkDir		/usr/X11R6/lib/X11/sjxa
  
  #elif defined(SGIArchitecture)			/**/
  
diff -arcN ../sjxa-1.5.11.org/Imakefile ./Imakefile
*** ../sjxa-1.5.11.org/Imakefile	Tue Apr 11 21:11:07 1995
--- ./Imakefile	Mon Aug 12 18:28:43 1996
***************
*** 27,32 ****
--- 27,37 ----
  Sony Corporation.
  */
  
+ /*
+  * Change some make rules.
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ 
  #ifdef ManDir
  #undef ManDir
  #endif
***************
*** 70,76 ****
         SJ3LIBOBJ = Sj3lib.o
  #endif
  #ifdef Sj3LibDir
!       SJ3LIB_DIR = Concat(-L,Sj3LibDir)
  #endif
  #if UseXIMCP
         USE_XIMCP = -DUSE_XIMCP
--- 75,83 ----
         SJ3LIBOBJ = Sj3lib.o
  #endif
  #ifdef Sj3LibDir
! /*    SJ3LIB_DIR = Concat(-L,Sj3LibDir) */
!       SJ3LIB_DIR = Sj3LibDir
!    SJ3LIB_LDFLAG = -L$(SJ3LIB_DIR)
  #endif
  #if UseXIMCP
         USE_XIMCP = -DUSE_XIMCP
***************
*** 108,119 ****
  
          DEFINES = $(PROTOCOL_DEFINES) $(HEADER_DEFINES)
         INCLUDES = -I. -I$(LIBSRC) -I$(TOOLKITSRC) -I$(AWIDGETSRC)
!   LOCAL_LDFLAGS = $(SJ3LIB_DIR) -LXmw
          DEPLIBS = Xmw/libXmw.a XawClientDepLibs
  #if UseInstalledSj3Lib  ||  defined(Sj3LibDir)
  LOCAL_LIBRARIES = -lsj3lib -lXmw XawClientLibs
  #else
  LOCAL_LIBRARIES = -lXmw XawClientLibs
  #endif
        MANSUFFIX = 1
  
--- 115,140 ----
  
          DEFINES = $(PROTOCOL_DEFINES) $(HEADER_DEFINES)
         INCLUDES = -I. -I$(LIBSRC) -I$(TOOLKITSRC) -I$(AWIDGETSRC)
!   LOCAL_LDFLAGS = $(SJ3LIB_LDFLAG) -LXmw
          DEPLIBS = Xmw/libXmw.a XawClientDepLibs
  #if UseInstalledSj3Lib  ||  defined(Sj3LibDir)
+ /*
+  * Change for FreeBSD.
+  * Because When the LANG variable is EUC, setlocale function in library libc 
+  * return NULL, use it in library libxpg4 
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ #if defined(FreeBSDArchitecture)
+ LOCAL_LIBRARIES = -lxpg4 -lsj3lib -lXmw XawClientLibs
+ #else
  LOCAL_LIBRARIES = -lsj3lib -lXmw XawClientLibs
+ #endif
+ #else
+ #if defined(FreeBSDArchitecture)
+ LOCAL_LIBRARIES = -lxpg4 -lXmw XawClientLibs
  #else
  LOCAL_LIBRARIES = -lXmw XawClientLibs
+ #endif
  #endif
        MANSUFFIX = 1
  
diff -arcN ../sjxa-1.5.11.org/SjString.h ./SjString.h
*** ../sjxa-1.5.11.org/SjString.h	Tue Apr 11 21:11:12 1995
--- ./SjString.h	Mon Aug 12 17:21:43 1996
***************
*** 45,50 ****
--- 45,56 ----
  
  #define	iseuc(c)	((unsigned char)(c) >= 0xa1 &&		\
  			 (unsigned char)(c) <= 0xfe)
+ /*
+  * Add isjjis() function.
+  * Because is used in this sources, but it is undefined!!
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ #define isjjis(c)	((0x21 <= (c)) && ((c) <= 0x7e))
  #define issjis1(c)	(((unsigned char)(c) >= 0x81 &&		\
  			  (unsigned char)(c) <= 0x9f) ||	\
  			 ((unsigned char)(c) >= 0xe0 &&		\
diff -arcN ../sjxa-1.5.11.org/man/Imakefile ./man/Imakefile
*** ../sjxa-1.5.11.org/man/Imakefile	Mon May 30 22:07:32 1994
--- ./man/Imakefile	Mon Aug 12 17:58:35 1996
***************
*** 27,32 ****
--- 27,37 ----
  Sony Corporation.
  */
  
+ /*
+  * Change some make rules.
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ 
  #ifdef ManDir
  #undef ManDir
  #endif
***************
*** 40,49 ****
  #define JapaneseManLocale	eucJP
  #endif
  #ifndef JapaneseManDir
! #define JapaneseManDir	/usr/local/man/man1
  #endif
  #ifndef ManDir
! #define ManDir		/usr/local/man/man1
  #endif
  
        JMANLOCALE = JapaneseManLocale
--- 45,54 ----
  #define JapaneseManLocale	eucJP
  #endif
  #ifndef JapaneseManDir
! #define JapaneseManDir	/usr/X11R6/man/ja/man1
  #endif
  #ifndef ManDir
! #define ManDir		/usr/X11R6/man/man1
  #endif
  
        JMANLOCALE = JapaneseManLocale
diff -arcN ../sjxa-1.5.11.org/resource/Imakefile ./resource/Imakefile
*** ../sjxa-1.5.11.org/resource/Imakefile	Wed Mar 29 15:33:35 1995
--- ./resource/Imakefile	Mon Aug 12 17:58:49 1996
***************
*** 27,32 ****
--- 27,37 ----
  Sony Corporation.
  */
  
+ /*
+  * Change some make rules.
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
+ 
  #ifdef ManDir
  #undef ManDir
  #endif
***************
*** 39,45 ****
  #ifdef SjxaAppDir
  #define SJXAAPPDIR	SjxaAppDir
  #else
! #define SJXAAPPDIR	$(LIBDIR)
  #endif
  
  #ifdef SjxarkDir
--- 44,50 ----
  #ifdef SjxaAppDir
  #define SJXAAPPDIR	SjxaAppDir
  #else
! #define SJXAAPPDIR	$(LIBDIR)/X11
  #endif
  
  #ifdef SjxarkDir
diff -arcN ../sjxa-1.5.11.org/resource/eucJP.ad ./resource/eucJP.ad
*** ../sjxa-1.5.11.org/resource/eucJP.ad	Mon May 30 22:07:55 1994
--- ./resource/eucJP.ad	Mon Aug 12 17:17:35 1996
***************
*** 44,50 ****
  !*kanaMode:				True
  *wrapToSelect:				3
  *initialMode:				ZenkakuHiragana
! *defaultCode:				sjis
  
  Sjxa.XmwPreedit.borderWidth:		0
  
--- 44,54 ----
  !*kanaMode:				True
  *wrapToSelect:				3
  *initialMode:				ZenkakuHiragana
! !
! ! Change default code sjjis -> euc.
! ! Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
! !
! *defaultCode:				euc
  
  Sjxa.XmwPreedit.borderWidth:		0
  
diff -arcN ../sjxa-1.5.11.org/sjxa.c ./sjxa.c
*** ../sjxa-1.5.11.org/sjxa.c	Mon Jun 19 19:55:19 1995
--- ./sjxa.c	Mon Aug 12 17:26:55 1996
***************
*** 145,153 ****
  	program_name = ss + 1;
  
     /* get user locale */
      if( (locale_name = setlocale( LC_CTYPE, "" )) == NULL ) {
! 	fprintf( stderr, "%s error: locale could not be set.\n", program_name );
! 	exit( 1 );
      }
      if( strcmp( locale_name, "ja_JP.SJIS" ) == 0 )
  	user_locale = LC_CTYPE_SHIFTJIS;
--- 145,160 ----
  	program_name = ss + 1;
  
     /* get user locale */
+ /*
+  * If the setlocale functione return NULL,
+  * try to get user locale by LANG variables again.
+  * Patched by Hidekazu Kuroki(hidekazu@cs.titech.ac.jp)		1996/8/10
+  */
      if( (locale_name = setlocale( LC_CTYPE, "" )) == NULL ) {
! 	if( (locale_name = getenv("LANG")) == NULL ) {
! 	    fprintf( stderr, "%s error: locale could not be set.\n", program_name );
! 	    exit( 1 );
! 	}
      }
      if( strcmp( locale_name, "ja_JP.SJIS" ) == 0 )
  	user_locale = LC_CTYPE_SHIFTJIS;
