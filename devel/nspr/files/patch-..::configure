--- ../configure.orig	Wed Mar 26 21:21:19 2003
+++ ../configure	Sun Jun  1 13:08:11 2003
@@ -3300,16 +3300,21 @@
 #define HAVE_BSD_FLOCK 1
 EOF
 
-    CFLAGS="$CFLAGS $(DSO_CFLAGS) -ansi -Wall"
+    cat >> confdefs.h <<\EOF
+#define HAVE_SOCKLEN_T 1
+EOF
+
+    CFLAFS="$CFLAGS $DSO_CFLAGS -ansi -Wall -pipe -DXP_UNIX"
     MOZ_OBJFORMAT=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
     if test "$MOZ_OBJFORMAT" = "elf"; then
-        DLL_SUFFIX=so
+        DLL_SUFFIX=so.1
     else
         DLL_SUFFIX=so.1.0
     fi
     MKSHLIB='$(CC) $(DSO_LDOPTS) -o $@'
     DSO_CFLAGS=-fPIC
     DSO_LDOPTS='-shared -Wl,-soname -Wl,$(notdir $@)'
+    DSO_LDOPTS="$DSO_LDOPTS $BSD_PTHREAD_LIBS"
     MDCPUCFG_H=_freebsd.cfg
     PR_MD_CSRCS=freebsd.c
     ;;
