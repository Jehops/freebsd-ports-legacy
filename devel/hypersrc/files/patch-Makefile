--- GNUmakefile.orig	Mon May  3 06:44:47 2004
+++ GNUmakefile	Sun May 16 00:31:40 2004
@@ -8,11 +8,7 @@
 
 # Where to install.
 #
-ifeq ($(USER),root)
-		INSTALL_DIR=/usr/local/bin
-else
-		INSTALL_DIR=$(HOME)/bin
-endif
+		INSTALL_DIR=${PREFIX}/bin
 
 INSTALL			= install
 INSTALL_OWNER	=
@@ -75,7 +71,7 @@
 else
 
 ifndef DEBUG
-C_OPTIMIZE = -O2 -finline-functions
+C_OPTIMIZE = ${CFLAGS}
 else
 C_OPTIMIZE = -O2 -finline-functions
 #C_OPTIMIZE = -O
@@ -149,10 +145,10 @@
 
 # -----	editing the rest should usually be unnecessary ------------------------
 
-CC			= gcc -c
-CC_FLAGS	= -I$(INC_DIR) $(PROF_OPTS) $(C_DEBUG) $(C_OPTIMIZE) $(C_OPTS) $(C_WARNINGS) `$(GTK_CONFIG) --cflags` `gnome-config --cflags gnomeui`
-LD			= gcc
-LD_FLAGS	+= $(PROF_OPTS) `$(GTK_CONFIG) --libs` `gnome-config --libs gnomeui`
+#CC			= gcc -c
+CC_FLAGS	= -I$(INC_DIR) $(PROF_OPTS) $(C_DEBUG) $(C_OPTIMIZE) $(C_OPTS) $(C_WARNINGS) `gnome-config --cflags gnomeui`
+LD			= $(CC)
+LD_FLAGS	+= $(PROF_OPTS) `gnome-config --libs gnomeui`
 C_SRCS		= $(addprefix $(SRC)/,$(C_SRCS_))
 C_OBJS_		= $(C_SRCS_:.c=.o)
 C_OBJS		= $(addprefix $(OUT)/,$(C_OBJS_))
@@ -184,7 +180,7 @@
 		$(LD) -o $(OUT)/hypersrc $(C_OBJS) $(LD_FLAGS) $(LIBS)
 
 $(OUT)/%.o:     $(SRC)/%.c
-		$(CC) -o $@ $(CC_FLAGS) $(subst $(OUT)/,$(SRC)/,$<)
+		$(CC) -c -o $@ $(CC_FLAGS) $(subst $(OUT)/,$(SRC)/,$<)
 
 # -----------------------------------------------------------------------------
 
@@ -202,14 +198,11 @@
 		rm -f $(INSTALL_DIR)/ctags.pl
 		cat  Hypersrc.pl  \
 		| sed 's|\$hypersrc = "hypersrc"|\$hypersrc = "${INSTALL_DIR}/hypersrc"|'  \
-		| sed 's|\$ctags_pl = "ctags.pl"|\$ctags_pl = "${INSTALL_DIR}/ctags.pl"|'  >  $(INSTALL_DIR)/Hypersrc.pl
-		@
-		cp  $(OUT)/hypersrc  $(INSTALL_DIR)
-		cp  ctags.pl  $(INSTALL_DIR)
+		| sed 's|\$ctags_pl = "ctags.pl"|\$ctags_pl = "${INSTALL_DIR}/ctags.pl"|'  >  $(OUT)/Hypersrc.pl
+		${BSD_INSTALL_SCRIPT}  $(OUT)/Hypersrc.pl  $(INSTALL_DIR)
 		@
-		chmod  +rx  $(INSTALL_DIR)/hypersrc
-		chmod  +rx  $(INSTALL_DIR)/Hypersrc.pl
-		chmod  +rx  $(INSTALL_DIR)/ctags.pl
+		${BSD_INSTALL_PROGRAM}  $(OUT)/hypersrc  $(INSTALL_DIR)
+		${BSD_INSTALL_SCRIPT}  ctags.pl  $(INSTALL_DIR)
 ifeq ($(USER),root)
 		@echo "------------------------------------------------------------------"
 		@echo "Installing man page"
