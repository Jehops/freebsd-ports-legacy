--- auto.def.orig	2019-07-13 13:05:19 UTC
+++ auto.def
@@ -149,6 +149,15 @@ if {![opt-bool internal-sqlite]} {
   }
 
   find_internal_sqlite
+
+  if {![cc-check-progs sqlite3]} {
+    user-error "system sqlite3 command not found"
+  }
+  msg-checking "Checking for JSON1 support in system sqlite3..."
+  if {[catch {exec [get-define SQLITE3] << {select json(true);}} res] || $res != 1} {
+    user-error "system sqlite3 does not have the JSON1 extension"
+  }
+  msg-result "yes"
 }
 
 proc is_mingw {} {
