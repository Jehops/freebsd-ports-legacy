#!/bin/sh

# Install bjam tool
${BSD_INSTALL_PROGRAM} ${BJAM} ${PREFIX}/bin/

# Install libraries
${FIND} ${WRKSRC}/bin/boost/libs -type f -name "*.a"\
    -exec ${BSD_INSTALL_DATA} \{\} ${PREFIX}/lib \;

${FIND} ${WRKSRC}/bin/boost/libs -type f -name "*.so.2"\
	-exec ${BSD_INSTALL_DATA} \{\} ${PREFIX}/lib \; 

# Create symlinks for shared libraries
cd ${PREFIX}/lib;
for i in libboost*.so.2; do
	${LN} -s $i ${i%%.2};
done;

# Install headers
cd ${WRKSRC} && ${FIND} boost -type d -a \! -name "*.orig"\
    -exec ${MKDIR} ${PREFIX}/include/\{\} \;
cd ${WRKSRC} && ${FIND} boost -type f -a \! -name "*.orig"\
    -exec ${BSD_INSTALL_DATA} \{\} ${PREFIX}/include/\{\} \;

# Documentation & examples
if [ "${NOPORTDOCS}xyz" = "xyz" ]; then
    # Installation
    ${MKDIR} ${DOCSDIR}

    ${FIND} ${WRKSRC} -type f -exec chmod 0444 {} \;
    ${FIND} ${WRKSRC} -type d -exec chmod 0555 {} \;
    cd ${WRKSRC} &&\
	${FIND} . -name "*.htm" -o -name "*.html"  -o -name "*.css"\
	    -o -name "*.jp*g" -o -name "*.png" -o -name "*.gif"\
	    | ${TAR} cTf - - | ${TAR} xUCf ${DOCSDIR} -

    cd ${WRKSRC}/libs &&\
    ${FIND} . -name "example" -o -name "examples" -o -name "*example*.cpp"\
	    -o -name "*example*.c" -o -name "*example*.hpp" | ${UNIQ} |\
	    ${GREP} -v "assign/test" | ${GREP} -v "iterator/test" | \
 	    ${GREP} -v "range/test" |\
	    ${TAR} cTf - - | ${TAR} xUCf ${DOCSDIR}/libs -
fi;
