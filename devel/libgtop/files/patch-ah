--- sysdeps/freebsd/procmap.c.orig	Thu May 27 13:56:48 1999
+++ sysdeps/freebsd/procmap.c	Thu Mar  1 17:29:02 2001
@@ -35,3 +35,7 @@
 #include <vm/vm_object.h>
+#if (__FreeBSD_version >= 400011)
+#include <vm/vm.h>
+#else
 #include <vm/vm_prot.h>
+#endif
 #include <vm/vm_map.h>
@@ -94,3 +98,2 @@
 	struct inode inode;
-	struct mount mount;
 #endif
@@ -116,3 +119,7 @@
 	if (kvm_read (server->machine.kd,
+#if (__FreeBSD_version >= 500013)
+		      (unsigned long) pinfo [0].ki_vmspace,
+#else
 		      (unsigned long) pinfo [0].kp_proc.p_vmspace,
+#endif
 		      (char *) &vmspace, sizeof (vmspace)) != sizeof (vmspace))
@@ -253,7 +260,2 @@
 			glibtop_error_io_r (server, "kvm_read (inode)");
-
-		if (kvm_read (server->machine.kd,
-			      (unsigned long) vnode.v_mount,
-			      &mount, sizeof (mount)) != sizeof (mount))
-			glibtop_error_io_r (server, "kvm_read (mount)");
 
