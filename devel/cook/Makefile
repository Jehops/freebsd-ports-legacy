# New ports collection Makefile for:	cook
# Date created:		31 January 2000
# Whom:			jasone
#
# $FreeBSD$
#

PORTNAME=	cook
PORTVERSION=	2.15
CATEGORIES=	devel

# MASTER_SITES would normally include ${MASTER_SITE_SUNSITE}, but updated
# cook distributions have not been propagated to sunsite since 2.12.
MASTER_SITES=	http://www.canb.auug.org.au/~millerp/cook/
MASTER_SITE_SUBDIR=	devel/make

MAINTAINER=	jasone@freebsd.org

BUILD_DEPENDS=	gettext:${PORTSDIR}/devel/gettext

USE_AUTOCONF=	yes
GNU_CONFIGURE=	yes
CONFIGURE_ENV=	CPPFLAGS=-I${LOCALBASE}/include LDFLAGS=-L${LOCALBASE}/lib

MAN1=	c_incl.1 cook.1 cook_bom.1 cook_lic.1 cookfp.1 cooktime.1 find_libs.1 \
	make2cook.1 roffpp.1
MANPREFIX =	${PREFIX}/share/cook
MANLANG =	"" en
MANCOMPRESSED=	no

strip_bins := c_incl cook cook_bom cookfp cooktime find_libs make2cook roffpp

# cook's configure.in is in the etc subdirectory.  Move it to the main
# directory so that USE_AUTOCONF works.
post-patch:
	@${MV} ${WRKSRC}/etc/configure.in ${WRKSRC}/

# Make sure that the whole directory tree exists.
pre-install:
	${MKDIR} ${PREFIX}/share/cook/en/man1
	${MKDIR} ${PREFIX}/lib/cook/en/LC_MESSAGES

# cook installs extra copies of the manpages in a directory that MANLANG can't
# cope with, so shuffle things around a bit.
post-install:
	@${MKDIR} ${PREFIX}/share/cook/en/man1
	@${MKDIR} ${PREFIX}/share/cook/man/en/man1
.for manpage in ${MAN1}
	@${MV} ${PREFIX}/share/cook/en/man1/${manpage} \
	${PREFIX}/share/cook/man/en/man1/
.endfor
	@${TOUCH} ${PREFIX}/share/cook/en/man1/.not_empty
	@${MKDIR} ${PREFIX}/share/cook/man/man1
.for manpage in ${MAN1}
	@${MV} ${PREFIX}/man/man1/${manpage} ${PREFIX}/share/cook/man/man1/
.endfor
.for bin in ${strip_bins}
	@strip ${PREFIX}/bin/${bin}
.endfor
	@echo
	@echo "Add ${PREFIX}/share/cook/man to your MANPATH in order to" \
	"access the manual"
	@echo "pages included with this port."
	@echo

.include <bsd.port.mk>
