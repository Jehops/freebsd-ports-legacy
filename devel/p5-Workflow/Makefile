# New ports collection makefile for:	p5-Workflow
# Date created:				8 June 2006
# Whom:					svysh
#
# $FreeBSD$
#

PORTNAME=	Workflow
PORTVERSION=	1.32
PORTREVISION=	1
CATEGORIES=	devel perl5
MASTER_SITES=	CPAN
PKGNAMEPREFIX=	p5-

MAINTAINER=	svysh@pn.sinp.msu.ru
COMMENT=	Simple, flexible system to implement workflows

BUILD_DEPENDS=	\
	${SITE_PERL}/Class/Observable.pm:${PORTSDIR}/devel/p5-Class-Observable \
	${SITE_PERL}/Class/Accessor.pm:${PORTSDIR}/devel/p5-Class-Accessor \
	${SITE_PERL}/DBD/Mock.pm:${PORTSDIR}/databases/p5-DBD-Mock \
	${SITE_PERL}/Class/Factory.pm:${PORTSDIR}/devel/p5-Class-Factory \
	${SITE_PERL}/${PERL_ARCH}/DateTime.pm:${PORTSDIR}/devel/p5-DateTime \
	${SITE_PERL}/Exception/Class.pm:${PORTSDIR}/devel/p5-Exception-Class \
	${SITE_PERL}/DateTime/Format/Strptime.pm:${PORTSDIR}/devel/p5-DateTime-Format-Strptime \
	${SITE_PERL}/XML/Simple.pm:${PORTSDIR}/textproc/p5-XML-Simple \
	${SITE_PERL}/Log/Dispatch.pm:${PORTSDIR}/devel/p5-Log-Dispatch \
	${SITE_PERL}/Log/Log4perl.pm:${PORTSDIR}/devel/p5-Log-Log4perl \
	${SITE_PERL}/${PERL_ARCH}/Data/UUID.pm:${PORTSDIR}/devel/p5-Data-UUID \
	${SITE_PERL}/${PERL_ARCH}/Data/Dumper.pm:${PORTSDIR}/devel/p5-Data-Dumper \
	${SITE_PERL}/${PERL_ARCH}/DBI.pm:${PORTSDIR}/databases/p5-DBI \
	${SITE_PERL}/Test/Exception.pm:${PORTSDIR}/devel/p5-Test-Exception \
	${SITE_PERL}/File/Slurp.pm:${PORTSDIR}/devel/p5-File-Slurp

RUN_DEPENDS=	${BUILD_DEPENDS}

PERL_CONFIGURE=	5.8.6+

MAN3=	Workflow.3 \
	Workflow::Action.3 \
	Workflow::Action::InputField.3 \
	Workflow::Action::Mailer.3 \
	Workflow::Action::Null.3 \
	Workflow::Base.3 \
	Workflow::Condition.3 \
	Workflow::Condition::Evaluate.3 \
	Workflow::Condition::HasUser.3 \
	Workflow::Config.3 \
	Workflow::Config::Perl.3 \
	Workflow::Config::XML.3 \
	Workflow::Context.3 \
	Workflow::Exception.3 \
	Workflow::Factory.3 \
	Workflow::History.3 \
	Workflow::Persister.3 \
	Workflow::Persister::DBI.3 \
	Workflow::Persister::DBI::AutoGeneratedId.3 \
	Workflow::Persister::DBI::ExtraData.3 \
	Workflow::Persister::DBI::SequenceId.3 \
	Workflow::Persister::File.3 \
	Workflow::Persister::RandomId.3 \
	Workflow::Persister::SPOPS.3 \
	Workflow::Persister::UUID.3 \
	Workflow::State.3 \
	Workflow::Validator.3 \
	Workflow::Validator::HasRequiredField.3 \
	Workflow::Validator::InEnumeratedType.3 \
	Workflow::Validator::MatchesDateFormat.3


.if !defined(NOPORTEXAMPLES)
PORTEXAMPLES=	*
.endif
.if !defined(NOPORTDATA)
PORTDATA=	*
.endif
.if !defined(NOPORTDOCS)
PORTDOCS=	*
.endif

post-patch:
	${RM} ${WRKSRC}/lib/${PORTNAME}/Factory.pm.orig

post-install:
.if !defined(NOPORTEXAMPLES)
	@${MKDIR} ${EXAMPLESDIR}
	@(cd ${WRKSRC}/eg && ${COPYTREE_SHARE} ticket/\* ${EXAMPLESDIR}/)
	@${ECHO_MSG} "===> Examples installed in ${EXAMPLESDIR}."
.endif
.if !defined(NOPORTDATA)
	@${MKDIR} ${DATADIR}
	@(cd ${WRKSRC} && ${COPYTREE_SHARE} struct/\* ${DATADIR}/)
	@${ECHO_MSG} "===> SQL data structures installed in ${DATADIR}."
.endif
.if !defined(NOPORTDOCS)
	@${MKDIR} ${DOCSDIR}
	@(cd ${WRKSRC}/ && ${CP} -R README Changes TODO doc ${DOCSDIR}/)
	@${ECHO_MSG} "===> Docs are installed in ${DOCSDIR}."
.endif

.include <bsd.port.mk>
