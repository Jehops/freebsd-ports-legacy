
$FreeBSD$

--- configure.orig	Mon Dec 24 00:50:12 2001
+++ configure	Fri Jan 18 09:40:30 2002
@@ -16354,8 +16354,8 @@
             	        G_THREAD_CFLAGS="$G_THREAD_CFLAGS -mthreads"
 		fi
 		;;
-	*-freebsd2.2*)
-		G_THREAD_CFLAGS="$G_THREAD_CFLAGS -D_THREAD_SAFE"
+	*-freebsd*)
+		G_THREAD_CFLAGS="$G_THREAD_CFLAGS $PTHREAD_CFLAGS"
 
 		# FreeBSD 2.2.x shiped with gcc 2.7.2.x, which doesn't support
 		# -mthreads flag.
@@ -16433,13 +16433,13 @@
            	fi
 		;;
              *)
-		for thread_lib in "" pthread pthread32 pthreads c_r thread dce; do
+		for thread_lib in "$PTHREAD_LIBS" "" pthread pthread32 pthreads c_r thread dce; do
 			if test x"$thread_lib" = x; then
 				add_thread_lib=""
 				IN=""
 			else
-				add_thread_lib="-l$thread_lib"
-				IN=" in -l$thread_lib"
+				add_thread_lib="$thread_lib"
+				IN=" in $thread_lib"
 			fi
 			if test x"$have_threads" = xposix; then
 				defattr=0
@@ -17636,13 +17636,13 @@
    #
    # Check for libiconv
    #
-   echo "$as_me:17639: checking for libiconv_open in -liconv" >&5
-echo $ECHO_N "checking for libiconv_open in -liconv... $ECHO_C" >&6
+   echo "$as_me:17639: checking for libiconv_open in -lgiconv" >&5
+echo $ECHO_N "checking for libiconv_open in -lgiconv... $ECHO_C" >&6
 if test "${ac_cv_lib_iconv_libiconv_open+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-liconv  $LIBS"
+LIBS="-lgiconv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line 17647 "configure"
 #include "confdefs.h"
@@ -17704,7 +17704,7 @@
 fi
 
 if test "x$with_libiconv" = "xyes" ; then
-  ICONV_LIBS="-liconv"
+  ICONV_LIBS="-lgiconv"
   cat >>confdefs.h <<\_ACEOF
 #define USE_LIBICONV 1
 _ACEOF
