# New ports collection makefile for:	swarm
# Date created:		26 June 1998
# Whom:			Horance C.H Chou <horance@freedom.ie.cycu.edu.tw>
#
# $FreeBSD$
#

PORTNAME=	swarm
PORTVERSION=	2.1.1
PORTREVISION=	2
CATEGORIES=	devel
MASTER_SITES=	ftp://ftp.santafe.edu/pub/swarm/src/swarm/

MAINTAINER=	horance@freedom.ie.cycu.edu.tw
COMMENT=	The Swarm Simulation System

BUILD_DEPENDS=	emacs:${PORTSDIR}/editors/emacs21
LIB_DEPENDS=	png.5:${PORTSDIR}/graphics/png \
		BLT24.3:${PORTSDIR}/x11-toolkits/blt
.if defined(WITH_HDF5)
LIB_DEPENDS+=	hdf5.0:${PORTSDIR}/graphics/hdf5
BROKEN=		undefined references in hdf5, please deinstall hdf5 package \
		before continue
.endif

BROKEN=		"Does not configure; will be removed after Feb 2"

.if defined(WITH_JAVA)
USE_JAVA=	1.3+
.endif
USE_GMAKE=	yes
USE_XPM=	yes
USE_LIBTOOL=	yes
USE_REINPLACE=	yes
INSTALLS_SHLIB=	yes
CONFIGURE_ARGS=	--with-defaultdir=${PREFIX} \
		--with-tclincludedir=${PREFIX}/include/tcl8.4 \
		--with-tkincludedir=${PREFIX}/include/tk8.4 \
		--with-tclscriptdir=${PREFIX}/lib/tcl8.4 \
		--with-tkscriptdir=${PREFIX}/lib/tk8.4 \
		--enable-subdirs
PLIST_SUB=	JAVA="@comment "
.if defined(WITH_JAVA)
CONFIGURE_ARGS+=	--with-jdkdir=${JAVA_HOME}
PLIST_SUB=	JAVA=""
.endif

post-patch:
	@${REINPLACE_CMD} \
		-e 's|%%LTCONFIG%%|${LIBTOOL_SHAREDIR}/ltconfig${LIBTOOL_VERSION}|g' \
		-e 's|%%LTMAIN%%|${LIBTOOL_SHAREDIR}/ltmain.sh|g' \
		${WRKSRC}/configure

pre-everything::
.if !defined(WITH_JAVA)
	@${ECHO_MSG} "===>"
	@${ECHO_MSG} "===> To enable java support , please define WITH_JAVA"
	@${ECHO_MSG} "===>"
.endif

post-patch:


post-install:
	${CAT} ${PKGMESSAGE} | ${SED} -e "s:%%PREFIX%%:${PREFIX}:g"

.include <bsd.port.mk>
