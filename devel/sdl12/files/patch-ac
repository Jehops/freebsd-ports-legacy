--- configure.orig	Tue Feb  8 03:53:58 2000
+++ configure	Tue Feb  8 11:31:03 2000
@@ -3016,7 +3016,7 @@
      echo "$ac_t""yes" 1>&6
      
             CFLAGS="$CFLAGS -DESD_SUPPORT $ESD_CFLAGS"
-            SYSTEM_LIBS="$SYSTEM_LIBS -lesd"
+            SYSTEM_LIBS="$SYSTEM_LIBS $ESD_LIBS"
              
   else
      echo "$ac_t""no" 1>&6
@@ -4326,7 +4326,7 @@
     ac_save_libs="$LIBS"
     case "$target" in
         *-*-freebsd*)
-            pthread_lib="-lc_r"
+            pthread_lib="-L""$LOCALBASE""/lib -llthread -llgcc_r"
             ;;
         *-*-openbsd*)
             pthread_lib="-lc_r"
@@ -4366,7 +4366,7 @@
         echo "$ac_t""$use_pthreads" 1>&6
         if test x$use_pthreads = xyes; then
             CFLAGS="$CFLAGS -D_REENTRANT -DSDL_USE_PTHREADS"
-            SDL_CFLAGS="$SDL_CFLAGS -D_REENTRANT"
+            SDL_CFLAGS="$SDL_CFLAGS -D_REENTRANT -D_THREAD_SAFE -I""$LOCALBASE""/include/pthread/linuxthreads"
             SDL_LIBS="$SDL_LIBS $pthread_lib"
         fi
     fi
@@ -4955,6 +4955,7 @@
         ;;
     *-*-freebsd*)
         ARCH=freebsd
+	CheckNASM
         CheckESD
         CheckX11
         CheckPTHREAD
@@ -5038,6 +5039,28 @@
 __EOF__
   cat >>$new <$old
 
+
+  echo "Copying src/audio/linux/SDL_dspaudio.h -> src/audio/SDL_dspaudio.h"
+  old="$srcdir/src/audio/linux/SDL_dspaudio.h"
+  new="$srcdir/src/audio/SDL_dspaudio.h"
+  cat >$new <<__EOF__
+/* WARNING:  This file was automatically generated!
+ * Original: $old
+ */
+__EOF__
+  cat >>$new <$old
+
+            
+  echo "Copying src/audio/linux/SDL_dspaudio.c -> src/audio/SDL_dspaudio.c"
+  old="$srcdir/src/audio/linux/SDL_dspaudio.c"
+  new="$srcdir/src/audio/SDL_dspaudio.c"
+  cat >$new <<__EOF__
+/* WARNING:  This file was automatically generated!
+ * Original: $old
+ */
+__EOF__
+  cat >>$new <$old
+  
         fi
         # Set up files for the cdrom library
         if test x$enable_cdrom = xyes; then
