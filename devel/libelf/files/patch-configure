
$FreeBSD$

--- configure.orig	Wed May  7 21:28:06 2003
+++ configure	Sat Jul 12 13:54:26 2003
@@ -1123,7 +1123,7 @@
 
 fi
 
-for ac_hdr in unistd.h fcntl.h elf.h sys/elf.h link.h sys/link.h
+for ac_hdr in unistd.h fcntl.h sys/elf.h link.h sys/link.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -3039,7 +3039,7 @@
 fi
 
     case "$host" in
-      *-linux*|*-gnu*)
+      *-linux*|*-gnu*|*-freebsd*)
 	if test "$GCC" = yes; then
 	  
   
@@ -3096,13 +3096,12 @@
 	    then
 	      SHLIB='$(PACKAGE)-$(VERSION).so'
 	    else
-	      SHLIB='$(PACKAGE).so.$(VERSION)'
+	      SHLIB='$(PACKAGE).so.$(MAJOR)'
 	    fi
 	    SHLINK='$(PACKAGE).so'
 	    SONAME='$(PACKAGE).so.$(MAJOR)'
-	    LINK_SHLIB='$(CC) -shared -Wl,-soname,$(SONAME)'
+	    LINK_SHLIB='$(CC) -shared -Wl,-soname,$(SONAME) $(LDFLAGS)'
 	    INSTALL_SHLIB='$(INSTALL_PROGRAM)'
-	    DEPSHLIBS='-lc'
 	  else
 	    echo "configure: warning: shared libraries not supported for $host" 1>&2
 	    mr_enable_shared=no
