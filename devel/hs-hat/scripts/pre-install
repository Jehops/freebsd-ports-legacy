#!/bin/sh

rm -f ${WRKSRC}/pkg-plist && touch ${WRKSRC}/pkg-plist

MACHINE=`${WRKSRC}/script/harch`

if [ `grep -c ghc ${WRKSRC}/lib/${MACHINE}/hmakerc` -gt 0 ]
then
    echo "lib/nhc98/ix86-FreeBSD/hat-trans" >> ${WRKSRC}/pkg-plist
    if [ ${WITH_TRACER} ]
    then
	ONEDIR=`grep ghc ${WRKSRC}/lib/${MACHINE}/hmakerc | grep import | head -1 | cut -d'"' -f2 | sed -e "s#${PREFIX}/##"`
	GHCINCDIR=`dirname $ONEDIR`
	GHCLIBDIR=`dirname $GHCINCDIR`
	FILES=`ls ${WRKSRC}/lib/hat/ | grep 'hi$\|hx$' | sed -e "s#^.*/lib/hat/##g"`
	echo "lib/nhc98/ix86-FreeBSD/libHShat.a" >> ${WRKSRC}/pkg-plist
	echo "${GHCLIBDIR}/libHShat.a" >> ${WRKSRC}/pkg-plist
	for file in ${FILES}; do
		echo ${GHCINCDIR}/hat/${file} >> ${WRKSRC}/pkg-plist
	done
	echo "@dirrm ${GHCINCDIR}/hat" >> ${WRKSRC}/pkg-plist
    fi
fi

cat ${CURDIR}/pkg-plist >> ${WRKSRC}/pkg-plist
