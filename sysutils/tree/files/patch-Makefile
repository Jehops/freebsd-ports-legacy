--- Makefile.orig	Tue Jan  9 23:10:01 2007
+++ Makefile	Thu Jan 25 19:09:06 2007
@@ -6,11 +6,6 @@
 # warranties, including, without limitation, the implied warranties
 # of merchant-ability and fitness for a particular purpose.
 
-CC=gcc
-#CFLAGS=-ggdb -Wall -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
-CFLAGS=-O2 -Wall -fomit-frame-pointer -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
-LDFLAGS=-s
-
 # Uncomment for FreeBSD:
 #CC=gcc
 #CFLAGS=-O2 -Wall -fomit-frame-pointer
@@ -38,12 +33,12 @@
 #CFLAGS=-02 -Wall -fomit-frame-pointer -Zomf -Zsmall-conv
 #LDFLAGS=-s -Zomf -Zsmall-conv
 
-prefix = /usr
+prefix = ${PREFIX}
 
 VERSION=1.5.1
 TREE_DEST=tree
 BINDIR=${prefix}/bin
-MAN=tree.1
+MAN=man/tree.1
 MANDIR=${prefix}/man/man1
 
 all:	tree
@@ -58,13 +53,11 @@
 	if [ -f tree.o ]; then rm *.o; fi
 	rm -f *~
 
-install:
-	install -d $(BINDIR)
-	install -d $(MANDIR)
-	if [ -e $(TREE_DEST) ]; then \
-		install -s $(TREE_DEST) $(BINDIR)/$(TREE_DEST); \
-	fi
-	install man/$(MAN) $(MANDIR)/$(MAN)
+install: $(TREE_DEST)
+	$(MKDIR) $(BINDIR)
+	$(MKDIR) $(MANDIR)
+	${BSD_INSTALL_PROGRAM} $(TREE_DEST) $(BINDIR)
+	${BSD_INSTALL_MAN} $(MAN) $(MANDIR)
 
 distclean:
 	if [ -f tree.o ]; then rm *.o; fi
