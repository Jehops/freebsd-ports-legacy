--- Makefile.in~	Mon Feb 11 00:43:27 2002
+++ Makefile.in	Sun Feb 17 13:33:34 2002
@@ -11,9 +11,9 @@
 
 DEFS=-DHAVE_CONFIG_H
 
-LIBDIR=/usr/X11R6/lib
+LIBDIR=$(X11BASE)/lib
 INCDIR=.
-XINCDIR=/usr/X11R6/include
+XINCDIR=$(X11BASE)/include
 XLIB=-lXaw -lXmu
 EXTENSIONLIB=-lXext
 INCLUDES=-I$(INCDIR)
@@ -21,9 +21,9 @@
 LIBS=-L$(LIBDIR) -lXaw $(XLIB) -lXt $(EXTENSIONLIB) -lX11 -lm
 
 #CC=/compat/linux/usr/bin/gcc
-CC=gcc
-CFLAGS=-O3 $(INCLUDES) $(DEFS)
-CFLAGSX=-O3 $(XINCLUDES) $(DEFS)
+CC?=gcc
+CFLAGS+= $(INCLUDES) $(DEFS)
+CFLAGSX= $(XINCLUDES) $(CFLAGS)
 LDFLAGS=-s
 
 LINT=lint
@@ -32,16 +32,19 @@
 RM=rm -f
 INSTALL=install
 
-INST_DIR=/usr/local/bin
-INST_XDIR=/usr/X11R6/bin
-INST_XRDIR=/usr/X11R6/lib/X11/app-defaults
+INST_DIR=$(PREFIX)/bin
+INST_XDIR=$(PREFIX)/bin
+INST_XRDIR=$(X11BASE)/lib/X11/app-defaults
  
 .c.o:
 	$(CC) -c $(CFLAGS) $*.c
 
-PROGRAM = mbmon xmbmon testpci testsmb testhwm testfan
+PROGRAM = mbmon
+TESTER	= testpci testsmb testhwm testfan
+DOCS=	00README.txt	00READMEj.txt	DEBUG_Info	xmbmon.resources
+PROGRAM+= xmbmon
 
-all: $(PROGRAM)
+all: $(PROGRAM) $(TESTER)
 
 mbmon: methods.h mbmon.c mbmon_small.c getMBinfo.o getMB-isa.o getMB-smb.o getMB-via.o pci_hwm.h pci_hwm.o smb_io.h smb_io.c
 	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ mbmon.c getMBinfo.o getMB-isa.o getMB-smb.o getMB-via.o pci_hwm.o
@@ -68,8 +71,14 @@
 	$(RM) Makefile config.cache config.log config.h config.status
 
 install: $(PROGRAM)
-	$(INSTALL) -o root -g wheel -m 4555 -c -p mbmon $(INST_DIR)
-	$(INSTALL) -o root -g wheel -m 4555 -c -p xmbmon $(INST_XDIR)
+	@for i in $(PROGRAM); do \
+		$(INSTALL) -o root -g wheel -m 4555 -c -p $$i $(INST_DIR); \
+	done
 
 lint:
 	$(LINT) $(INCLUDES) $(DEFS) $(FONTDEFINES) $(SRCS) -lm
+
+install-doc: $(DOCS)
+	@for f in $(DOCS); do \
+		$(INSTALL_DATA) $$f $(DOCSDIR)/; \
+	done
