--- root-tail.c.orig	Thu Apr  8 21:58:28 2004
+++ root-tail.c	Wed Jun 23 14:06:13 2004
@@ -152,6 +152,7 @@
 void list_files (int);
 void force_reopen (int);
 void force_refresh (int);
+void exit_now (int);
 void blank_window (int);
 
 void InitWindow (void);
@@ -198,6 +199,13 @@
 }
 
 void
+exit_now (int signal)
+{
+  fprintf (stderr, "Program exiting due to signal: %d\n", signal);
+  exit(-1);
+}
+
+void
 blank_window (int dummy)
 {
   XClearArea (disp, root, win_x, win_y, width + MARGIN_OF_ERROR, height, False);
@@ -655,11 +663,12 @@
 char *
 concat_line (char *p1, const char *p2)
 {
+  int l1,l2;
+  char *r;
   assert(p2);
 
-  int l1 = p1 ? strlen (p1) : 0;
-  int l2 = strlen (p2);
-  char *r;
+  l1 = p1 ? strlen (p1) : 0;
+  l2 = strlen (p2);
 
   if (p1)
     r = xrealloc(p1, l1 + l2 + 1);
@@ -925,6 +934,7 @@
       int wrapped = 0;
       char *break_p = NULL;
       int width_at_break_p = 0;
+      int prefix_len;
       spaces = 0;
 
       if (opt_justify)
@@ -992,7 +1002,6 @@
       if (!wrapped)
         break;
 
-      int prefix_len;
 
       /* choose where to break the line */
       if (opt_wordwrap && break_p && break_p != beg)
@@ -1501,6 +1510,7 @@
   install_signal (SIGHUP, force_reopen);
   install_signal (SIGUSR1, list_files);
   install_signal (SIGUSR2, force_refresh);
+  install_signal (SIGSEGV, exit_now);
 
   if (opt_daemonize)
     daemonize ();
