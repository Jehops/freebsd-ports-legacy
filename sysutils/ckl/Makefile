# Created by: Tomaz Muraus <kami@k5-storitve.net>
# $FreeBSD$

PORTNAME=	ckl
PORTVERSION=	0.9.1
PORTREVISION=	2
CATEGORIES=	sysutils net
MASTER_SITES=	http://packages.cloudkick.com/releases/ckl/
DISTNAME=	ckl-${PORTVERSION}

MAINTAINER=	kami@k5-storitve.net
COMMENT=	A command line tool for noting when something was changed on a machine

BROKEN=		unfetchable, MASTER_SITES redirects to Rackspace
DEPRECATED=	Broken for more than 6 month
EXPIRATION_DATE=	2014-02-27
LIB_DEPENDS=	curl:${PORTSDIR}/ftp/curl

USE_SCONS=	yes
USE_BZIP2=	yes

PORTDOCS=	CHANGES LICENSE NOTICE README

NO_STAGE=	yes
post-patch:
	@${REINPLACE_CMD} -e '/<curl\/types.h>/d' ${WRKSRC}/src/ckl.h

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/src/ckl ${PREFIX}/bin

post-install:
.if !defined(NOPORTDOCS)
	@${MKDIR} ${DOCSDIR}
.for file in ${PORTDOCS}
	@${INSTALL_DATA} ${WRKSRC}/${file} ${DOCSDIR}
.endfor
.endif

.if !defined(NOPORTEXAMPLES)
	@${MKDIR} ${EXAMPLESDIR}
	@${MKDIR} ${EXAMPLESDIR}/webapp
	(cd ${WRKSRC}/webapp/ && ${COPYTREE_SHARE} \* ${EXAMPLESDIR}/webapp)
.endif
	${INSTALL_DATA} ${PATCHDIR}/cloudkick.conf.example ${PREFIX}/etc/cloudkick.conf.sample
	@if [ ! -f ${PREFIX}/etc/cloudkick.conf ]; then \
	${INSTALL_DATA} -p ${PREFIX}/etc/cloudkick.conf.sample ${PREFIX}/etc/cloudkick.conf ; \
	fi

.include <bsd.port.mk>
