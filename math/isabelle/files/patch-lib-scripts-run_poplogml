--- lib/scripts/run-poplogml.orig	Tue Oct 11 21:28:04 2005
+++ lib/scripts/run-poplogml	Sat Jan 12 18:01:54 2008
@@ -1,22 +1,20 @@
-#!/usr/bin/env bash
+#!/bin/sh
 #
 # $Id: run-poplogml,v 1.5 2005/10/11 11:28:04 wenzelm Exp $
 # Author: Makarius
 #
 # Poplog/PML startup script (version 15.6/2.1).
 
-export -n INFILE OUTFILE COPYDB COMPRESS MLTEXT TERMINATE NOWRITE
-
 
 ## diagnostics
 
-function fail_out()
+fail_out()
 {
   echo "Unable to create output heap file: \"$OUTFILE\"" >&2
   exit 2
 }
 
-function check_mlhome_file()
+check_mlhome_file()
 {
   if [ ! -f "$1" ]; then
     echo "Unable to locate $1" >&2
@@ -25,7 +23,7 @@
   fi
 }
 
-function check_heap_file()
+check_heap_file()
 {
   if [ ! -f "$1" ]; then
     echo "Expected to find ML heap file $1" >&2
@@ -35,6 +33,21 @@
   fi
 }
 
+SAVE_INFILE="$INFILE"
+SAVE_OUTFILE="$OUTFILE"
+SAVE_COPYDB="$COPYDB"
+SAVE_COMPRESS="$COMPRESS"
+SAVE_MLTEXT="$MLTEXT"
+SAVE_TERMINATE="$TERMINATE"
+SAVE_NOWRITE="$NOWRITE"
+unset INFILE OUTFILE COPYDB COMPRESS MLTEXT TERMINATE NOWRITE
+INFILE="$SAVE_INFILE"
+OUTFILE="$SAVE_OUTFILE"
+COPYDB="$SAVE_COPYDB"
+COMPRESS="$SAVE_COMPRESS"
+MLTEXT="$SAVE_MLTEXT"
+TERMINATE="$SAVE_TERMINATE"
+NOWRITE="$SAVE_NOWRITE"
 
 ## prepare databases
 
