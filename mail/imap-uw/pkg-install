#!/bin/sh
TTY=/dev/tty

if [ "X$PACKAGE_BUILDING" != "X" ]; then
    exit 0
fi

case $2 in
    POST-INSTALL)
	;;
    PRE-INSTALL)
	if dialog --yesno "This port has been proven exploitable at several occasions (read up\non CERT advisories), leaving systems subject to remote root access.\nBefore installing this package, please consider:\n\na) Whether you really want to use this software. The integrity of\nyour system may be at risk.\n\nb) Using TCP Wrappers to protect your UW imap/pop daemons from being\npublicly available. Adding this to /etc/hosts.allow will make your\nimap and pop3 daemons accessible only from 192.168.0.0/24:\n\nimapd : 192.168.0.0/24 : allow\nimapd : ALL : deny\nipop3d : 192.168.0.0/24 : allow\nipop3d : ALL : deny\n\nFor more information about the hosts.allow file, read\nhosts_access(5). Please test that this setup works as expected.\n\nDo you wish to proceed with the build?" 24 72 < ${TTY} >${TTY} 2>&1; then
	    exit 0
	else
	    exit 1
	fi
	;;
    *)
	echo "Unexpected argument $2!"
	exit 1
	;;
esac
exit 0
