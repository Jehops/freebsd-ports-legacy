--- src/ipopd/Makefile.old	Wed Oct 25 01:55:07 2000
+++ src/ipopd/Makefile	Sun Dec 31 18:23:16 2000
@@ -19,29 +19,27 @@
 
 
 C = ../c-client
-CCLIENTLIB = $C/c-client.a
+#CCLIENTLIB = $C/c-client.a
 SHELL = /bin/sh
 
 # Get local definitions from c-client directory
 
 CC = `cat $C/CCTYPE`
-CFLAGS = -I$C `cat $C/CFLAGS`
-LDFLAGS = $(CCLIENTLIB) `cat $C/LDFLAGS`
+.if defined(WITH_DRAC)
+CFLAGS = `cat $C/CFLAGS` -DDRAC_AUTH -DETC_DIR=\"$(PREFIX)/etc\"
+LDFLAGS = `cat $C/LDFLAGS` -ldrac
+.else
+CFLAGS = `cat $C/CFLAGS`
+LDFLAGS = `cat $C/LDFLAGS`
+.endif
 
 ipopd: ipop2d ipop3d
 
-ipop2d: $(CCLIENTLIB) ipop2d.o
+ipop2d: ipop2d.o
 	$(CC) $(CFLAGS) -o ipop2d ipop2d.o $(LDFLAGS)
 
-ipop3d: $(CCLIENTLIB) ipop3d.o
+ipop3d: ipop3d.o
 	$(CC) $(CFLAGS) -o ipop3d ipop3d.o $(LDFLAGS)
-
-ipop2d.o: $C/mail.h $C/misc.h $C/osdep.h
-
-ipop3d.o: $C/mail.h $C/misc.h $C/osdep.h
-
-$(CCLIENTLIB):
-	cd $C;make
 
 clean:
 	rm -f *.o ipop2d ipop3d || true
