#!/bin/sh
#
# $FreeBSD$
#

# PROVIDE: dovecot
# REQUIRE: %%REQUIRE%%
# KEYWORD: shutdown

# Define these dovecot_* variables in one of these files:
#	/etc/rc.conf
#	/etc/rc.conf.local
#	/etc/rc.conf.d/dovecot
#
# DO NOT CHANGE THESE DEFAULT VALUES HERE
#
: ${dovecot_enable:="NO"}

. %%RC_SUBR%%

name=dovecot
rcvar=`set_rcvar`

command=%%PREFIX%%/sbin/${name}
required_files=%%PREFIX%%/etc/${name}.conf
start_precmd="${name}_prestart"
extra_commands="restart"

dovecot_prestart()
{	# Ensure runtime directories exist with correct permissions
	base=/var/run/dovecot
	/usr/bin/install -o root -g wheel -m 0755 -d ${base}
	/usr/bin/install -o root -g dovecot -m 0750 -d ${base}/login
}

load_rc_config ${name}
run_rc_command "$1"
