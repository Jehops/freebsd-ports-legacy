Index: master/service.c
diff -u master/service.c.orig master/service.c
--- master/service.c.orig	Mon Dec 17 18:08:07 2001
+++ master/service.c	Mon Dec 17 18:08:38 2001
@@ -101,7 +101,11 @@
     
     /* is this a connection from the local host? */
     if (getpeername(fd, (struct sockaddr *) &sin, &len) == 0) {
-	if (((struct sockaddr *)&sin)->sa_family == AF_UNIX) {
+	switch (((struct sockaddr *)&sin)->sa_family) {
+	case AF_INET:
+	case AF_INET6:
+	    break;
+	default:
 	    return 1;
 	}
     }
