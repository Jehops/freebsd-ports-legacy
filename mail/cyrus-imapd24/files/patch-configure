Index: configure
diff -u configure.orig configure
--- configure.orig	2009-03-13 21:19:01.000000000 +0900
+++ configure	2009-03-15 16:16:50.000000000 +0900
@@ -642,6 +642,7 @@
 IMAP_COM_ERR_LIBS
 LIB_RT
 LIB_UCDSNMP
+LDFLAGS_UCDSNMP
 SNMP_CONFIG
 LIB_WRAP
 CMU_LIB_SUBDIR
@@ -19030,6 +19031,7 @@
     EXTRA_SUBDIRS="${EXTRA_SUBDIRS} perl"
     PERL_SUBDIRS="imap"
     PERL="${with_perl}"
+    eval `${PERL} -V:cccdlflags`
     PERL_CCCDLFLAGS="$cccdlflags"
 
 fi
@@ -19984,7 +19986,9 @@
 
     if test -n "$SNMP_LIBS" && test -n "$SNMP_PREFIX"; then
       CPPFLAGS="$CPPFLAGS -I${SNMP_PREFIX}/include"
-      LIB_UCDSNMP=$SNMP_LIBS
+      LIB_UCDSNMP="$SNMP_LIBS -lwrap"
+      PERLLIBDIR=`$PERL -e 'use Config; print "$Config{archlibexp}/CORE";'`
+      LDFLAGS_UCDSNMP="-L${PERLLIBDIR} -R${PERLLIBDIR}"
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_NETSNMP 1
@@ -20224,7 +20228,7 @@
 #define HAVE_UCDSNMP 1
 _ACEOF
 
-      LIB_UCDSNMP="-lucdagent -lucdmibs -lsnmp"
+      LIB_UCDSNMP="-lucdagent -lucdmibs -lsnmp -lkvm -ldevstat -lwrap"
       { $as_echo "$as_me:$LINENO: checking for rpmdbOpen in -lrpm" >&5
 $as_echo_n "checking for rpmdbOpen in -lrpm... " >&6; }
 if test "${ac_cv_lib_rpm_rpmdbOpen+set}" = set; then
