--- milter-regex.8.orig	Thu Dec 21 17:15:05 2006
+++ milter-regex.8	Thu Dec 21 17:22:46 2006
@@ -52,6 +52,8 @@
 .It Fl d
 Don't detach from controlling terminal and produce verbose debug
 output on stdout.
+.It Fl q
+Don't send to syslog messages with priority higher than LOG_NOTICE.
 .It Fl c Ar config
 Use the specified configuration file instead of the default,
 /etc/milter-regex.conf.
--- milter-regex.c.orig	Thu Dec 21 17:13:26 2006
+++ milter-regex.c	Thu Dec 21 17:23:28 2006
@@ -57,6 +57,7 @@
 
 static const char	*rule_file_name = "/etc/milter-regex.conf";
 static int		 debug = 0;
+static int		 quiet = 0;
 
 struct context {
 	struct ruleset	*rs;
@@ -520,6 +521,9 @@
 	va_list ap;
 	char msg[8192];
 
+	if (LOG_PRI(priority) > LOG_INFO && quiet)
+		return;
+
 	va_start(ap, fmt);
 	if (context != NULL)
 		snprintf(msg, sizeof(msg), "%s: ", context->host_addr);
@@ -563,13 +567,16 @@
 	tzset();
 	openlog("milter-regex", LOG_PID | LOG_NDELAY, LOG_DAEMON);
 
-	while ((ch = getopt(argc, argv, "c:dp:u:")) != -1) {
+	while ((ch = getopt(argc, argv, "c:dqp:u:")) != -1) {
 		switch (ch) {
 		case 'c':
 			rule_file_name = optarg;
 			break;
 		case 'd':
 			debug = 1;
+			break;
+		case 'q':
+			quiet = 1;
 			break;
 		case 'p':
 			oconn = optarg;


