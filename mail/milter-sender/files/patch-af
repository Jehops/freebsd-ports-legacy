--- milter-sender.c.orig	Fri Jul  9 09:36:28 2004
+++ milter-sender.c	Thu Jul 15 01:18:13 2004
@@ -387,6 +387,7 @@
 static StringOption milterCf 		= { 0, "MilterCf",		MILTER_CF,	"read a milter configuration file of command line options" };
 static StringOption milterSocket	= { 0, "MilterSocket",		NULL,		"(REQUIRED) the sendmail/milter socket type & name; see INPUT_MAIL_FILTER" };
 static StringOption publicIp		= { 0, "PublicIp",		NULL,		"the public IP address of this machine, when behind a NAT/firewall" };
+static StringOption heloName		= { 0, "HeloName",		NULL,		"the host name to use when we send a HELO" };
 static StringOption sendmailCf		= { 0, "SendmailCf",		SENDMAIL_CF,	"pathname of the sendmail.cf file; set empty to disable use of databases" };
 
 static StringOption *stringOptions[] = {
@@ -395,6 +396,7 @@
 	&milterCf,
 	&milterSocket,
 	&publicIp,
+	&heloName,
 	&sendmailCf,		
 	(StringOption *) 0
 };
@@ -1342,7 +1344,7 @@
 static int
 mxHelo(workspace data, int *code)
 {
-	(void) snprintf(data->line, sizeof (data->line), "HELO %s\r\n", smfi_getsymval(data->work.ctx, macro_if_name));
+	(void) snprintf(data->line, sizeof (data->line), "HELO %s\r\n", heloName.value == NULL ? smfi_getsymval(data->work.ctx, macro_if_name) : heloName.value);
 	return mxCommand(data, data->line, 250, code, MX_ERROR_HELO);
 }
 
