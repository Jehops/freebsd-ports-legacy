#! /bin/sh
#
# $FreeBSD: /tmp/pcvs/ports/mail/postgrey/files/pkg-install.in,v 1.4 2011-11-09 09:15:33 mm Exp $

PATH=/bin:/usr/bin:/usr/sbin
DBDIR="%%DBDIR%%"
USER="%%USER%%"
GROUP="%%GROUP%%"

case $2 in

POST-INSTALL)
  echo "---> Starting post-install script:"

  # Create home directory if required
  if [ -z ${DBDIR} ]; then
    echo "---> Default database directory not specified"
  elif [ -d ${DBDIR} ]; then
    echo "---> Using existing Postgrey database directory (${DBDIR})"
    echo "     (There may be existing active postgrey databases - this installation"
    echo "     will attempt to preserve them.)"
  elif [ -e ${DBDIR} ]; then
    echo "---> The default Postgrey database directory (${DBDIR})"
    echo "     exists but is not a directory - you have to create it yourself"
  else
    echo "---> Creating Postgrey database directory (${DBDIR})"
    (umask 002 && mkdir -p ${DBDIR}) || exit 1
    chown -R ${USER}:${GROUP} ${DBDIR} || exit 1
    chmod g+s ${DBDIR} || exit 1
  fi

esac
