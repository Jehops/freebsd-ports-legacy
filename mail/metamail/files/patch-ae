*** metamail/splitmail.c.orig	Mon Jan 31 23:23:14 1994
--- metamail/splitmail.c	Sat Feb 28 19:17:32 2004
***************
*** 41,48 ****
  #define VERBOSEDELIVERYCMD VerboseDeliveryCmd
  #else
  extern char *getenv();
! #define NORMALDELIVERYCMD "/usr/lib/sendmail -t -oi"
! #define VERBOSEDELIVERYCMD "/usr/lib/sendmail -t -v -oi"
  #endif
  
  usageexit() {
--- 41,48 ----
  #define VERBOSEDELIVERYCMD VerboseDeliveryCmd
  #else
  extern char *getenv();
! #define NORMALDELIVERYCMD "/usr/sbin/sendmail -t -oi"
! #define VERBOSEDELIVERYCMD "/usr/sbin/sendmail -t -v -oi"
  #endif
  
  usageexit() {
***************
*** 194,200 ****
  	s = endofheader(from);  /* would be index(from, '\n'),
  				 but need to check for continuation lines */
          *s = '\0';
! 	if (ShareThisHeader(from, SubjectBuf, &OrigID)) {
  	    strcat(SharedHeaders, from);
  	    strcat(SharedHeaders, "\n");
  	}
--- 194,200 ----
  	s = endofheader(from);  /* would be index(from, '\n'),
  				 but need to check for continuation lines */
          *s = '\0';
! 	if (ShareThisHeader(from, SubjectBuf, sizeof(SubjectBuf), &OrigID)) {
  	    strcat(SharedHeaders, from);
  	    strcat(SharedHeaders, "\n");
  	}
***************
*** 339,347 ****
      NULL
  };
  
! ShareThisHeader(s, SubjectBuf, OrigID)
  char *s;
  char *SubjectBuf;
  char **OrigID;
  {
      int i;
--- 339,348 ----
      NULL
  };
  
! ShareThisHeader(s, SubjectBuf, size, OrigID)
  char *s;
  char *SubjectBuf;
+ size_t size;
  char **OrigID;
  {
      int i;
***************
*** 361,367 ****
      }
      if (!ULstrcmp(s, "subject")) {
          *colon = ':';
!         strcpy(SubjectBuf, ++colon);
          return(0);
      }
      if (!ULstrcmp(s, "content-type")) {
--- 362,369 ----
      }
      if (!ULstrcmp(s, "subject")) {
          *colon = ':';
!         strncpy(SubjectBuf, ++colon, size);
!         SubjectBuf[size - 1] = '\0';
          return(0);
      }
      if (!ULstrcmp(s, "content-type")) {
