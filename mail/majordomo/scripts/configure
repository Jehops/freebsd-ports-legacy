#!/usr/bin/perl
#

eval '(exit $?0)' && eval 'exec /usr/bin/perl -S $0 ${1+"$@"}'
& eval 'exec /usr/bin/perl -S $0 $argv:q'
if 0;

if( getpwnam( "majordom" ) ) {
	( $null, $null, $mjUID ) = getpwnam( "majordom" );
} else {
	print "\nMajordomo user not found - aborting!\n\n";
	exit 1;
}

if( getgrnam( "majordom" ) ) {
	( $null, $null, $mjGID ) = getgrnam( "majordom" );
} else {
	print "\nMajordomo group not found - aborting!\n\n";
	exit 1;
}

chop( $hostname = `hostname` );

system( "/usr/bin/perl -pi -e 's|%%MJUID%%|$mjUID|g' $ENV{'WRKSRC'}/Makefile" );
system( "/usr/bin/perl -pi -e 's|%%MJGID%%|$mjGID|g' $ENV{'WRKSRC'}/Makefile" );
system( "/usr/bin/perl -pi -e 's|%%HOSTNAME%%|$hostname|g' $ENV{'WRKSRC'}/sample.cf $ENV{'WRKSRC'}/aliases.majordomo" );
system( "/usr/bin/perl -pi -e 's|%%PREFIX%%|$ENV{'PREFIX'}|g' $ENV{'WRKSRC'}/sample.cf $ENV{'WRKSRC'}/contrib/digest" );
