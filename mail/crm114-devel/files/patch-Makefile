--- Makefile.orig	Thu Feb 12 03:42:43 2004
+++ Makefile	Thu Feb 26 12:02:12 2004
@@ -4,7 +4,7 @@
 #   If you want to install the executables somewhere else, change
 #    BINDIR here.  Default is /usr/bin 
 #
-prefix=/usr
+#prefix=/usr/local
 BINDIR=${prefix}/bin
 
 # VER_SUFFIX defines a version suffix for our installed executables, 
@@ -56,24 +56,14 @@
 experimental: crm114_tre
 	install -m 755 crm114_tre $(BINDIR)/crma
 
-crm114: crm114.c crm114.h crm114_structs.h crm114_config.h crm114_sysincludes.h
-	$(MAKE) crm114_tre
-	#  ./crm114 is used locally; make sure it's there too.
+crm114: crm114_tre
 	ln -f -s crm114_tre crm114
 
 crm114_gnu: crm114.o crmregex_gnu.o crm_mathexec.o
 	$(CC) $(LDFLAGS) crm114.o crmregex_gnu.o crm_mathexec.o -lm -o crm114_gnu $(LIBS)
 
 crm114_tre: crm114.o crmregex_tre.o crm_mathexec.o
-	#
-	#   Note: if you haven't installed TRElib, the next step 
-	#   will get an error.
-	#       For TRElib, look in the TRE sub-directory of this kit.
-	#   You will also need to add /usr/local/lib to /etc/ld.so.conf,
-	#   and then run ldconfig (as root) to set the library up and make
-	#   the library known to the static and runtime linkers.
-	#
-	$(CC) $(LDFLAGS) crm114.o crmregex_tre.o crm_mathexec.o -static -lm -ltre -o crm114_tre $(LIBS)
+	$(CC) $(LDFLAGS) crm114.o crmregex_tre.o crm_mathexec.o -lm -ltre -o crm114_tre $(LIBS)
 
 crm114.o: crm114.c crm114.h crm114_structs.h crm114_config.h crm114_sysincludes.h
 	$(CC)  $(CFLAGS) -DVERSION='"$(VERSION)"' -c crm114.c -o crm114.o
@@ -89,14 +79,14 @@
 
 cssutil: cssutil.c crm114.h crm114_structs.h crm114_config.h crm114_sysincludes.h
 	$(CC)  $(CFLAGS) -c cssutil.c -o cssutil.o  
-	$(CC)  $(CFLAGS) cssutil.o -static -lm -ltre -o cssutil  
+	$(CC)  $(LDFLAGS) $(CFLAGS) cssutil.o -lm -ltre -o cssutil $(LIBS)
 
 cssdiff: cssdiff.c crm114.h crm114_structs.h crm114_config.h crm114_sysincludes.h
 	$(CC)  $(CFLAGS) -c cssdiff.c -o cssdiff.o
-	$(CC)  $(CFLAGS) -static -ltre cssdiff.o -o cssdiff
+	$(CC)  $(LDFLAGS) $(CFLAGS) -ltre cssdiff.o -o cssdiff $(LIBS)
 
 cssmerge: cssmerge.c crm114.h crm114_structs.h crm114_config.h crm114_sysincludes.h
-	$(CC)  $(CFLAGS) -static -ltre cssmerge.c -o cssmerge
+	$(CC)  $(LDFLAGS) $(CFLAGS) -ltre cssmerge.c -o cssmerge $(LIBS)
 
 clean:
 	-rm -f crm114
@@ -108,22 +98,14 @@
 	-rm -f crm114_tre
 	-rm -f *.o
 
-install_crm114: crm114
-	#
-	#   NOTE - the default CRM114 now uses the TRE regex lib, not GNU
-	#          If you want the GNU one (not recommended) you should
-	#          use 'install_gnu' as the make target.
-	#    
-	$(MAKE) install_tre
+install_crm114: crm114 install_tre
 
-install_utils:
-	$(MAKE) cssmerge cssutil cssdiff
+install_utils: cssmerge cssutil cssdiff
 	install -m 755 -s cssdiff $(BINDIR)/cssdiff$(VER_SUFFIX)
 	install -m 755 -s cssmerge $(BINDIR)/cssmerge$(VER_SUFFIX)
 	install -m 755 -s cssutil $(BINDIR)/cssutil$(VER_SUFFIX)
 
-install: FORCE
-	$(MAKE) install_crm114 install_utils
+install: install_crm114 install_utils
 
 install_tre: crm114_tre
 	install -m 755 -s crm114_tre $(BINDIR)/crm$(VER_SUFFIX)
@@ -254,4 +236,5 @@
 distribution: install src_gzip i386_gzip css_gzip
 	md5sum crm114-$(VERSION).*.tar.gz
 
-FORCE:
\ No newline at end of file
+FORCE:
+
