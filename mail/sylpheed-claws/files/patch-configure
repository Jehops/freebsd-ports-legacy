--- configure.orig	Tue Sep 26 13:48:55 2006
+++ configure	Tue Sep 26 13:52:15 2006
@@ -28199,6 +28199,18 @@
 { echo "$as_me:$LINENO: checking for OPENSSL" >&5
 echo $ECHO_N "checking for OPENSSL... $ECHO_C" >&6; }
 
+       case $host_os in
+               *freebsd*)
+                       if test $(openssl version | cut -d ' ' -f 2) \< 0.9.7 ; then
+                               ac_cv_enable_openssl=no
+                       else
+                               OPENSSL_LIBS=${OPENSSL_LIBS-"-lcrypto -lssl"}
+				echo "${ECHO_T}yes" >&6;
+                       fi
+                       ;;
+       esac
+
+if false; then
 if test -n "$PKG_CONFIG"; then
     if test -n "$OPENSSL_CFLAGS"; then
         pkg_cv_OPENSSL_CFLAGS="$OPENSSL_CFLAGS"
@@ -28265,6 +28277,8 @@
 echo "${ECHO_T}yes" >&6; }
 	:
 fi
+fi # if false
+
 	if test x$ac_cv_enable_openssl = xyes; then
 
 cat >>confdefs.h <<\_ACEOF
@@ -29719,18 +29733,18 @@
 rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext;
   if test "$ac_cv_var__res_options" != "yes"; then
-	LIBRESOLV="-lresolv"
+	LIBRESOLV=""
   fi
   LIBS="$t_oldLibs"
 
   if test "x$LIBRESOLV" = "x"; then
-	{ echo "$as_me:$LINENO: checking for res_query in -lresolv" >&5
-echo $ECHO_N "checking for res_query in -lresolv... $ECHO_C" >&6; }
+	{ echo "$as_me:$LINENO: checking for res_query in " >&5
+echo $ECHO_N "checking for res_query in ... $ECHO_C" >&6; }
 if test "${ac_cv_lib_resolv_res_query+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+LIBS="  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -29802,7 +29816,7 @@
 { echo "$as_me:$LINENO: result: $ac_cv_lib_resolv_res_query" >&5
 echo "${ECHO_T}$ac_cv_lib_resolv_res_query" >&6; }
 if test $ac_cv_lib_resolv_res_query = yes; then
-  LIBRESOLV=-lresolv
+  LIBRESOLV=
 fi
 
 	LIBS="$t_oldLibs"
@@ -29833,13 +29847,13 @@
 	{ echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6; }
 
-		{ echo "$as_me:$LINENO: checking for res_query in -lresolv" >&5
-echo $ECHO_N "checking for res_query in -lresolv... $ECHO_C" >&6; }
+		{ echo "$as_me:$LINENO: checking for res_query in " >&5
+echo $ECHO_N "checking for res_query in ... $ECHO_C" >&6; }
 if test "${ac_cv_lib_resolv_res_query+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+LIBS="  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -29911,7 +29925,7 @@
 { echo "$as_me:$LINENO: result: $ac_cv_lib_resolv_res_query" >&5
 echo "${ECHO_T}$ac_cv_lib_resolv_res_query" >&6; }
 if test $ac_cv_lib_resolv_res_query = yes; then
-  LDAP_LIBS="$LDAP_LIBS -lresolv"
+  LDAP_LIBS="$LDAP_LIBS "
 fi
 
 	{ echo "$as_me:$LINENO: checking for bind in -lsocket" >&5
@@ -30883,7 +30897,7 @@
 
 	fi
 
-	{ echo "$as_me:$LINENO: checking for unpack_Address in -lpisock" >&5
+	{ echo "$as_me:$LINENO: checking for unpack_Address in -liconv -lpisock" >&5
 echo $ECHO_N "checking for unpack_Address in -lpisock... $ECHO_C" >&6; }
 if test "${ac_cv_lib_pisock_unpack_Address+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -30961,7 +30975,7 @@
 { echo "$as_me:$LINENO: result: $ac_cv_lib_pisock_unpack_Address" >&5
 echo "${ECHO_T}$ac_cv_lib_pisock_unpack_Address" >&6; }
 if test $ac_cv_lib_pisock_unpack_Address = yes; then
-  JPILOT_LIBS="-lpisock"
+  JPILOT_LIBS="-liconv -lpisock"
 else
   JPILOT_LIBS="" ac_cv_enable_jpilot="no"
 fi
