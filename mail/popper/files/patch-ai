*** pop_dropcopy.c.orig	Tue Jun 30 21:54:41 1998
--- pop_dropcopy.c	Tue Jun 30 21:59:22 1998
***************
*** 471,478 ****
  		    *cp++ = '\n';
  		    *cp   = '\0';
  
! 		    mp->length += strlen("X-UIDL: ") + strlen(mp->uidl_str) + 1;
! 		    p->drop_size += strlen("X-UIDL: ") + strlen(mp->uidl_str)+1;
  
  	/* New UIDs do not dirty the mailspool if NO_STATUS is set.  They
  	   are just recalculated each time the popper is run or LMOS is
--- 471,480 ----
  		    *cp++ = '\n';
  		    *cp   = '\0';
  
! 		    i = strlen("X-UIDL: ") + (DIG_SIZE * 2) + 2;
! 		    mp->length += i;
! 		    p->drop_size += i;
! 		    mp->lines++;
  
  	/* New UIDs do not dirty the mailspool if NO_STATUS is set.  They
  	   are just recalculated each time the popper is run or LMOS is
***************
*** 504,511 ****
  		    if( (len = strlen(cp)) > MIN_UIDL_LENGTH && len < MAX_UIDL_LENGTH ) {
  			uidl_found++;
  			mp->uidl_str = (char *)strdup(cp);
! 			mp->length += nchar + 1;
! 			p->drop_size += nchar + 1;
  		    }
  		}
  		continue;  /* Do not include this value in the message size */
--- 506,515 ----
  		    if( (len = strlen(cp)) > MIN_UIDL_LENGTH && len < MAX_UIDL_LENGTH ) {
  			uidl_found++;
  			mp->uidl_str = (char *)strdup(cp);
! 			len += strlen("X-UIDL: ") + 1;
! 			mp->length += len;
! 			p->drop_size += len;
! 			mp->lines++;
  		    }
  		}
  		continue;  /* Do not include this value in the message size */
***************
*** 717,724 ****
  		    *cp++ = '\n';
  		    *cp   = '\0';
  
! 		    mp->length += strlen("X-UIDL: ") + strlen(mp->uidl_str) + 1;
! 		    p->drop_size += strlen("X-UIDL: ") + strlen(mp->uidl_str)+1;
  
  	/* New UIDs do not dirty the mailspool if NO_STATUS is set.  They
  	   are just recalculated each time the popper is run or LMOS is
--- 721,730 ----
  		    *cp++ = '\n';
  		    *cp   = '\0';
  
! 		    i = strlen("X-UIDL: ") + (DIG_SIZE * 2) + 2;
! 		    mp->length += i;
! 		    p->drop_size += i;
! 		    mp->lines++;
  
  	/* New UIDs do not dirty the mailspool if NO_STATUS is set.  They
  	   are just recalculated each time the popper is run or LMOS is
***************
*** 753,760 ****
  		    if( (len = strlen(cp)) > MIN_UIDL_LENGTH && len < MAX_UIDL_LENGTH ) {
  			uidl_found++;
  			mp->uidl_str = (char *)strdup(cp);
! 			mp->length += nchar + 1;
! 			p->drop_size += nchar + 1;
  		    }
  		}
  		continue;  /* Do not include this value in the message size */
--- 759,768 ----
  		    if( (len = strlen(cp)) > MIN_UIDL_LENGTH && len < MAX_UIDL_LENGTH ) {
  			uidl_found++;
  			mp->uidl_str = (char *)strdup(cp);
! 			len += strlen("X-UIDL: ") + 1;
! 			mp->length += len;
! 			p->drop_size += len;
! 			mp->lines++;
  		    }
  		}
  		continue;  /* Do not include this value in the message size */
