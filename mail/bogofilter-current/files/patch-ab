--- ./src/format.c	14 Jun 2004 23:45:44 -0000	1.37
+++ ./src/format.c	28 Jun 2004 19:45:17 -0000
@@ -357,7 +357,7 @@
 		buff += format_string(buff, spam_header_name, 0, prec, flags, end);
 		break;
 	    case 'I':		/* I - received IP address */
-		buff += format_string(buff, ipaddr->text, 0, prec, flags, end);
+		buff += format_string(buff, ipaddr ? (const char *)ipaddr->text : "UNKNOWN", 0, prec, flags, end);
 		break;
 	    case 'l':		/* l - logging tag */
 		buff += format_string(buff, logtag, 0, prec, flags, end);
