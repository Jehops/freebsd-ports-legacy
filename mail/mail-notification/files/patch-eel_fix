--- src/mn-maildir-mailbox-backend.c.orig	2008-03-28 17:57:40.000000000 -0400
+++ src/mn-maildir-mailbox-backend.c	2008-03-28 17:58:18.000000000 -0400
@@ -163,7 +163,7 @@ ___2_mn_maildir_mailbox_backend_monitor_
       {
 	char *filename;
 
-	filename = eel_uri_get_basename(info_uri);
+	filename = mn_vfs_uri_get_basename(info_uri);
 	if (filename)
 	  {
 	    if (filename[0] != '.')
--- src/mn-mh-mailbox-backend.c.orig	2008-03-28 17:58:56.000000000 -0400
+++ src/mn-mh-mailbox-backend.c	2008-03-28 17:59:07.000000000 -0400
@@ -155,7 +155,7 @@ ___2_mn_mh_mailbox_backend_monitor_cb (M
       {
 	char *filename;
 
-	filename = eel_uri_get_basename(info_uri);
+	filename = mn_vfs_uri_get_basename(info_uri);
 	if (filename)
 	  {
 	    if (! strcmp(filename, SEQUENCES_FILE) || mn_str_isnumeric(filename))
--- src/mn-sylpheed-mailbox-backend.c.orig	2008-03-28 17:59:36.000000000 -0400
+++ src/mn-sylpheed-mailbox-backend.c	2008-03-28 17:59:48.000000000 -0400
@@ -277,7 +277,7 @@ ___4_mn_sylpheed_mailbox_backend_monitor
       {
 	char *filename;
 
-	filename = eel_uri_get_basename(info_uri);
+	filename = mn_vfs_uri_get_basename(info_uri);
 	if (filename)
 	  {
 	    if (! strcmp(filename, SYLPHEED_MARK_FILE))
--- src/mn-vfs.c.orig	2008-03-28 18:00:14.000000000 -0400
+++ src/mn-vfs.c	2008-03-28 18:01:22.000000000 -0400
@@ -325,3 +325,21 @@ mn_vfs_get_local_path (GnomeVFSURI *uri)
 
   return path;
 }
+
+char *
+mn_vfs_uri_get_basename (const char *text_uri)
+{
+  GnomeVFSURI *uri;
+  char *name;
+
+  g_return_val_if_fail(text_uri != NULL, NULL);
+
+  uri = gnome_vfs_uri_new(text_uri);
+  if (! uri)
+    return NULL;
+
+  name = gnome_vfs_uri_extract_short_name(uri);
+  gnome_vfs_uri_unref(uri);
+
+  return name;
+}
--- src/mn-vfs.h.orig	2008-03-28 18:01:40.000000000 -0400
+++ src/mn-vfs.h	2008-03-28 18:02:16.000000000 -0400
@@ -52,4 +52,6 @@ GnomeVFSURI *mn_vfs_uri_append_file_suff
 
 char *mn_vfs_get_local_path (GnomeVFSURI *uri);
 
+char *mn_vfs_uri_get_basename (const char *text_uri);
+
 #endif /* _MN_VFS_H */
