#!/bin/sh
#
# $FreeBSD$
#
# set -x

trap ' cleanup ' 0
trap ' echo_signal; exit 1' 1 2 3 15

tmp_first=$(mktemp ${WRKDIR:=/tmp}/.plist-first.XXXXXXXXXX)
tmp_last=$(mktemp ${WRKDIR}/.plist-last.XXXXXXXXXX)

cleanup() {
  rm -f $tmp_first $tmp_last
}

echo_signal() {
  echo "Got Signal -- aborting `basename $0`"
}

PATH=/bin:/usr/bin

cat > $tmp_first <<EOF
bin/flea
bin/mutt
bin/mutt_dotlock
bin/muttbug
bin/pgpewrap
bin/pgpring
bin/smime_keys
etc/Muttrc
etc/mime.types
share/locale/ca/LC_MESSAGES/mutt.mo
share/locale/cs/LC_MESSAGES/mutt.mo
share/locale/da/LC_MESSAGES/mutt.mo
share/locale/de/LC_MESSAGES/mutt.mo
share/locale/el/LC_MESSAGES/mutt.mo
share/locale/eo/LC_MESSAGES/mutt.mo
share/locale/es/LC_MESSAGES/mutt.mo
share/locale/et/LC_MESSAGES/mutt.mo
share/locale/fr/LC_MESSAGES/mutt.mo
share/locale/gl/LC_MESSAGES/mutt.mo
share/locale/hu/LC_MESSAGES/mutt.mo
share/locale/id/LC_MESSAGES/mutt.mo
share/locale/it/LC_MESSAGES/mutt.mo
share/locale/ja/LC_MESSAGES/mutt.mo
share/locale/ko/LC_MESSAGES/mutt.mo
share/locale/lt/LC_MESSAGES/mutt.mo
share/locale/nl/LC_MESSAGES/mutt.mo
share/locale/pl/LC_MESSAGES/mutt.mo
share/locale/pt_BR/LC_MESSAGES/mutt.mo
share/locale/ru/LC_MESSAGES/mutt.mo
share/locale/sk/LC_MESSAGES/mutt.mo
share/locale/sv/LC_MESSAGES/mutt.mo
share/locale/tr/LC_MESSAGES/mutt.mo
share/locale/uk/LC_MESSAGES/mutt.mo
share/locale/zh_CN/LC_MESSAGES/mutt.mo
share/locale/zh_TW/LC_MESSAGES/mutt.mo
EOF

if [ "$MUTT_PORTDOCS" = "yes" ]; then
  cat >> $tmp_first <<EOF
share/doc/mutt/ABOUT-NLS
share/doc/mutt/COPYRIGHT
share/doc/mutt/ChangeLog
share/doc/mutt/ChangeLog.old
share/doc/mutt/GPL
share/doc/mutt/INSTALL
share/doc/mutt/NEWS
share/doc/mutt/PGP-Notes.txt
share/doc/mutt/README
share/doc/mutt/README.SECURITY
share/doc/mutt/README.SSL
share/doc/mutt/TODO
share/doc/mutt/applying-patches.txt
share/doc/mutt/devel-notes.txt
share/doc/mutt/language.txt
share/doc/mutt/language50.txt
share/doc/mutt/manual.txt
share/doc/mutt/patch-notes.txt
share/doc/mutt/smime-notes.txt
share/examples/mutt/Mush.rc
share/examples/mutt/Pine.rc
share/examples/mutt/Tin.rc
share/examples/mutt/ca-bundle.crt
share/examples/mutt/gpg.rc
share/examples/mutt/pgp2.rc
share/examples/mutt/pgp5.rc
share/examples/mutt/pgp6.rc
share/examples/mutt/sample.mailcap
share/examples/mutt/sample.muttrc
share/examples/mutt/sample.muttrc-tlr
share/examples/mutt/smime.rc
share/examples/mutt/smime_keys_test.pl
share/examples/mutt/iconv/iconv.aix-3.2.5.rc
share/examples/mutt/iconv/iconv.aix-4.1.5.rc
share/examples/mutt/iconv/iconv.aix-4.2.0.rc
share/examples/mutt/iconv/iconv.aix-4.3.2.rc
share/examples/mutt/iconv/iconv.freebsd-3.3.rc
share/examples/mutt/iconv/iconv.glibc-2.1.3.rc
share/examples/mutt/iconv/iconv.glibc-2.1.90.rc
share/examples/mutt/iconv/iconv.hpux-10.01.rc
share/examples/mutt/iconv/iconv.hpux-10.20.rc
share/examples/mutt/iconv/iconv.hpux-11.00.rc
share/examples/mutt/iconv/iconv.irix-6.5.rc
share/examples/mutt/iconv/iconv.osf1-4.0a.rc
share/examples/mutt/iconv/iconv.osf1-4.0d.rc
share/examples/mutt/iconv/iconv.solaris-2.4.rc
share/examples/mutt/iconv/iconv.solaris-2.5.1.rc
share/examples/mutt/iconv/iconv.solaris-2.6-cjk.rc
share/examples/mutt/iconv/iconv.solaris-2.6.rc
share/examples/mutt/iconv/iconv.solaris-2.7.rc
EOF

  if [ "$MUTT_NNTP" = "yes" ]; then
    echo "share/doc/mutt/ChangeLog.nntp" >> $tmp_first
  fi
  if [ "$MUTT_SGML" = "yes" ]; then
    echo "share/doc/mutt/manual.latin1" >> $tmp_first
    echo "share/doc/mutt/manual.ps" >> $tmp_first
  fi

  if [ "$MUTT_HTML" = "yes" ]; then
    html=366
    if [ "$MUTT_COMPRESSED_FOLDERS" = "yes" ]; then
      html=$(($html + 5))
    fi
    if [ "$MUTT_NNTP" = "yes" ]; then
      html=$(($html + 22))
    fi
    if [ "$MUTT_QUOTE_PATCH" = "yes" ]; then
      html=$(($html + 2))
    fi
    if [ "$MUTT_EDIT_THREADS" = "yes" ]; then
      html=$(($html + 3))
    fi
    if [ "$MUTT_SIGNATURE_MENU" = "yes" ]; then
      html=$(($html + 1))
    fi
    if [ "$MUTT_IFDEF_PATCH" = "yes" ]; then
      html=$(($html + 1))
    fi
    if [ "$MUTT_PGP_PATCH" = "yes" ]; then
      html=$(($html + 2))
    fi
    echo "share/doc/mutt/html/manual.html" >> $tmp_first
    echo "share/doc/mutt/html/manual_toc.html" >> $tmp_first 
    i=1
    while [ $i -le $html ]; do
      echo "share/doc/mutt/html/manual$i.html" >> $tmp_first 
      i=$(($i + 1))
    done
    echo "@dirrm share/doc/mutt/html" >> $tmp_last
  fi
  cat >> $tmp_last <<EOF
@dirrm share/examples/mutt/iconv
@dirrm share/examples/mutt
@dirrm share/doc/mutt
EOF
fi

sort -u $tmp_first
cat $tmp_last
