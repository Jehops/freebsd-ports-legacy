--- init.h.orig	Mon Feb 12 08:54:57 2001
+++ init.h	Sat Feb 24 18:03:32 2001
@@ -1227,6 +1227,13 @@
   ** \fBdeprecated\fP.
   */
 
+  { "pgp_outlook_compat", DT_QUAD, R_NONE, OPT_PGPOUTLOOK, M_NO },
+  /*
+  ** .pp
+  ** If pgp_create_traditional is defined above, this option causes mutt
+  ** to generate messages readable by users of MS Outlook using PGP.
+  */
+
   /* XXX Default values! */
   
   { "pgp_decode_command", 	DT_STR, R_NONE, UL &PgpDecodeCommand, 0},
--- mutt.h.orig	Tue Feb 26 22:40:16 2002
+++ mutt.h	Tue Feb 26 22:44:05 2002
@@ -263,2 +263,3 @@
   OPT_PGPTRADITIONAL, /* create old-style PGP messages */
+  OPT_PGPOUTLOOK,     /* Create even older broken outlook compatible messages */
 #endif
--- pgp.c.orig	Thu Apr  4 08:49:50 2002
+++ pgp.c	Sun May  5 13:57:57 2002
@@ -1399,11 +1399,20 @@
   
   b->encoding = ENC7BIT;
 
-  b->type = TYPETEXT;
-  b->subtype = safe_strdup ("plain");
-  
-  mutt_set_parameter ("x-action", flags & ENCRYPT ? "pgp-encrypted" : "pgp-signed",
-		      &b->parameter);
+  /* Outlook seems to work by scanning the message itself for PGP information, */
+  /* not the headers.  If the headers are anything but text/plain, it will */
+  /* not recognize the message. */
+  if (flags & PGPOUTLOOK) {
+    b->type = TYPETEXT;
+    b->subtype = safe_strdup ("plain");
+  } else {
+    b->type = TYPEAPPLICATION;
+    b->subtype = safe_strdup ("pgp");
+
+    mutt_set_parameter ("format", "text", &b->parameter);
+    mutt_set_parameter ("x-action", flags & ENCRYPT ? "pgp-encrypted" : "pgp-signed",
+		        &b->parameter);
+  }
   mutt_set_parameter ("charset", send_charset, &b->parameter);
   
   b->filename = safe_strdup (pgpoutfile);
--- pgplib.h.orig	Sun Feb  3 10:34:23 2002
+++ pgplib.h	Sun May  5 14:01:30 2002
@@ -25,6 +25,7 @@
 #define PGPSIGN     (APPLICATION_PGP | SIGN)
 #define PGPGOODSIGN (APPLICATION_PGP | GOODSIGN)
 #define PGPKEY      (APPLICATION_PGP | (1 << 3))
+#define PGPOUTLOOK  (APPLICATION_PGP | (1 << 4))
 
 #define KEYFLAG_CANSIGN 		(1 <<  0)
 #define KEYFLAG_CANENCRYPT 		(1 <<  1)
--- crypt.c.orig	Tue Mar 26 23:23:11 2002
+++ crypt.c	Sun May  5 13:53:52 2002
@@ -184,8 +184,13 @@
     {
       if ((i = query_quadoption (OPT_PGPTRADITIONAL, _("Create an inline PGP message?"))) == -1)
 	return -1;
-      else if (i == M_YES)
+      else if (i == M_YES) {
 	traditional = 1;
+	if ((i = query_quadoption (OPT_PGPOUTLOOK, _("Create an Outlook compatible message?"))) == -1)
+	  return -1;
+	else if (i == M_YES)
+	  flags |= PGPOUTLOOK;
+      }
     }
     if (traditional)
     {
