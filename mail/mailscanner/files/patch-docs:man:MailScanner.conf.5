--- ../MailScanner-install-4.43.8.orig/docs/man/MailScanner.conf.5	Fri Jul  8 14:17:05 2005
+++ docs/man/MailScanner.conf.5	Fri Jul  8 14:17:23 2005
@@ -1,4 +1,4 @@
-.TH "MailScanner.conf" "5" "4.42.9" "Julian Field" "Mail"
+.TH "MailScanner.conf" "5" "4.43.8" "Julian Field" "Mail"
 .SH "NAME"
 .LP 
 MailScanner.conf \- Main configuration for MailScanner
@@ -1701,12 +1701,64 @@
 .br 
 
 .br 
-# The Bayesian database rebuild and expiry may take a 2 or 3 minutes
-# to complete. During this time you can either wait, or simply
-# disable SpamAssassin checks until it has completed.
-WaitDuringBayesRebuild = no
+The Bayesian database rebuild and expiry may take a 2 or 3 minutes to complete. During this time you can either wait, or simply disable SpamAssassin checks until it has completed.
 
 
+
+.SH "Custom Spam Scanner Plugin"
+.TP 
+\fBUse Custom Spam Scanner\fR
+Default: no
+.br 
+
+.br 
+Use the Custom Spam Scanner. This is code you will have to write yourself, a function called "GenericSpamScanner" stored in the file "MailScanner/lib/MailScanner/CustomFunctions/GenericSpamScanner.pm". A sample function is given in the correct file in the distribution. This sample function also includes code to show you how to make it run an external program to produce a spam score. This can also be the filename of a ruleset. The function will be passed
+.br 
+.RS 7
+.IP  \(bu 4
+$IP		\- the numeric IP address of the system on the remote end of the SMTP connections
+.IP  \(bu 4
+$From	\- the address of the envelope sender of the message
+.IP  \(bu 4
+$To		\- a perl reference to the envelope recipients of the message
+.IP  \(bu 4
+$Message	\- a perl reference to the list of line of the message
+.RE
+.br 
+
+
+.TP 
+\fBMax Custom Spam Scanner Size\fR
+Default: 20000
+.br 
+
+.br 
+How much of the message should be passed tot he Custom Spam Scanner. Most spam tools only need the first 20kbytes of the message to determine if it is spam or not. Passing more than is necessary only slows things down. This can also be the filename of a ruleset.
+
+.TP 
+\fBCustom Spam Scanner Timeout\fR
+Default: 20
+.br 
+
+.br 
+How long should the custom spam scanner take to run? If it takes more seconds than this, then it should be considered to have crashed and should be killed. This stops denial\-of\-service attacks.
+
+
+.TP 
+\fBMax Custom Spam Scanner Timeouts\fR
+Default: 10
+.br 
+
+.br 
+If the Custom Spam Scanner times out more times in a row than this, then it will be marked as "unavailable" until MailScanner next re\-starts itself.
+
+.TP 
+\fBCustom Spam Scanner Timeout History\fR
+Default: 20
+.br 
+
+.br 
+The total number of Custom Spam Scanner attempts during which "Max Custom Spam Scanner Timeouts" will cause the Custom Spam Scanner to be marked as "unavailable". See the previous comment for more information. The default values of 10 and 20 mean that 10 timeouts in any sequence of 20 attempts will trigger the behaviour described above, until the next periodic restart (see "Restart Every").
 .SH "What to do with spam"
 .TP 
 \fBSpam Actions\fR
