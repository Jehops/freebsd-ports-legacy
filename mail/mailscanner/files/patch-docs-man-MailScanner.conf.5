--- ../MailScanner-install-4.53.7.orig/docs/man/MailScanner.conf.5	Wed May  3 21:16:27 2006
+++ docs/man/MailScanner.conf.5	Wed May  3 21:33:05 2006
@@ -1,4 +1,4 @@
-.TH "MailScanner.conf" "5" "4.50.1" "Julian Field" "Mail"
+.TH "MailScanner.conf" "5" "4.53.7" "Julian Field" "Mail"
 .SH "NAME"
 .LP 
 MailScanner.conf \- Main configuration for MailScanner
@@ -24,6 +24,10 @@
 .br 
 
 .br 
+The following optional multipliers are supported: You can write "50M" instead of "50000000". The multipliers supported are "k", "m" and "g" to denote 1 thousand, 1 million and 1 billion (10^9) in upper or lower case. You must *not* put any spaces between the number and the multiplier character.
+.br 
+
+.br 
 Many of the options can also be the filename of a ruleset, which can be used to control features depending on the addresses of the message, and/or the IP address where the message came from. You will find some examples of rulesets and an explanation of them in the "rules" directories within the MailScanner installation and in the section "RULESETS" later in this manpage.
 
 .LP 
@@ -364,6 +368,22 @@
 Should we use a TNEF decoder (external or Perl module)? This should be "yes" unless the scanner you are using (Sophos, McAfee) has the facility built\-in. However, if you set it to "no", then the filenames within the TNEF attachment will not be checked against the filename rules.
 
 .TP 
+\fBUse TNEF Contents\fR
+Default: replace
+.br 
+When the TNEF (winmail.dat) attachments are expanded, should the attachments contained in there be added to the list of attachments in the message? If you set this to "add" or "replace" then recipients of messages sent in "Outlook Rich Text Format" (TNEF) will be able to read the attachments if they are not using Microsoft Outlook.
+.br 
+.RS 7
+.IP  \(bu 4
+no: Leave winmail.dat TNEF attachments alone.
+.IP  \(bu 4
+add: Add the contents of winmail.dat as extra attachments, but also still include the winmail.dat file itself. This will result in TNEF messages being doubled in size.
+.IP  \(bu 4
+replace: Replace the winmail.dat TNEF attachment with the files it            contains, and delete the original winmail.dat file itself. This means the message stays the same size, but is usable by non\-Outlook recipients.
+.RE
+
+
+.TP 
 \fBDeliver Unparsable TNEF\fR
 Default: no
 .br 
@@ -405,6 +425,22 @@
 .br 
 The maximum length of time the "file" command is allowed to run for one batch of messages (in seconds).
 
+.TP 
+\fBGunzip Command\fR
+Default: /usr/bin/gunzip
+.br 
+
+.br 
+Where the "gunzip" command is installed. This is used for expanding .gz files. To disable gzipped file checking, set this value to blank and the timeout to 0.
+
+.TP 
+\fBGunzip Timeout\fR
+Default: 50
+.br 
+
+.br 
+The maximum length of time the "gunzip" command is allowed to run to expand 1 attachment file (in seconds).
+
 
 .TP 
 \fBUnrar Command\fR
@@ -423,6 +459,12 @@
 The maximum length of time the "unrar" command is allowed to run for 1 RAR archive (in seconds)
 
 .TP 
+\fBFind UU\-Encoded Files\fR
+Default: no
+.br 
+A few viruses store their infected data in UU\-encoded files, to try to catch out virus scanners. This rarely succeeds at all. Setting this option to yes means that you can apply filename and filetype checks to the contents of UU\-encoded files. This may occasionally be  useful, in which case you should set to yes. This can also be the filename of a ruleset.
+
+.TP 
 \fBBlock Encrypted Messages\fR
 Default: no
 .br 
@@ -521,7 +563,7 @@
 .SH "Virus scanning and vulnerability testing"
 .TP 
 \fBVirus Scanning\fR
-Default: yes
+Default: auto
 .br 
 
 .br 
@@ -529,7 +571,7 @@
 .br 
 NOTE: Switching this to no completely disables all virus\-scanning functionality. If you just want to switch of actual virus scanning, then set "Virus Scanners = none" instead.
 .br 
-If you want to be able to switch scanning on/off for different users or different domains, set this to the filename of a ruleset.
+If you want to be able to switch scanning on/off for different users or different domains, set this to the filename of a ruleset. If you set this to auto then it searches for and uses every available installed virus scanner.
 
 .TP 
 \fBVirus Scanners\fR
@@ -686,6 +728,23 @@
 .br 
 While detecting "Phishing" attacks, do you also want to point out links to numeric IP addresses. Genuine links to totally numeric IP addresses are very rare, so this option is set to "yes" by default. If a numeric IP address is found in a link, the same phishing warning message is used as in the Find Phishing Fraud option above. This value cannot be the name of a ruleset, only a simple yes or no.
 
+.TP 
+\fBUse Stricter Phishing Net\fR
+Default: yes
+.br 
+
+.br 
+If this is set to yes, then most of the URL in a link must match the destination address it claims to take you to. This is the default as it is a much stronger test and is very hard to maliciously avoid. If this is set to no, then just the company name and country (and any names between the two, dependent on the specific country) must match. This is not as strict as it will not protect you against internal malicious sites based within the company being abused. For example, it would not find www.nasty.company\-name.co.uk pretending to be www.nice.company\-name.co.uk. But it will still detect most phishing attacks of the type www.nasty.co.jp versus www.nice.co.jp. Depending on the country code it knows how many levels of domain need to be checked. This can also be the filename of a ruleset.
+
+
+.TP 
+\fBHighlight Phishing Fraud\fR
+Default: yes
+.br 
+
+.br 
+If a phishing fraud is detected, do you want to highlight the tag with a message stating that the link may be to a fraudulent web site. This can also be the filename of a ruleeset.
+
 
 .TP 
 \fBPhishing Safe Sites File\fR
@@ -695,6 +754,15 @@
 .br 
 There are some companies, such as banks, that insist on sending out email messages with links in them that are caught by the "Find Phishing Fraud" test described above. This is the name of a file which contains a list of link destinations which should be ignored in the test. This may, for example, contain the known websites of some banks. See the file itself for more information. This can only be the name of the file containing the list, it *cannot* be the filename of a ruleset.
 
+.TP 
+\fBCountry Sub\-Domains List\fR
+Default: %etc\-dir%/country.domains.conf
+.br 
+
+.br 
+.TP 
+This file lists all the countries that use 2nd\-level and 3rd\-level domain names to classify distinct types of website within their country. This cannot be the name of a ruleset, it is just a simple setting.
+
 
 .TP 
 \fBAllow IFrame Tags\fR
@@ -773,6 +841,22 @@
 .RE
 
 .TP 
+\fBIgnored Web Bug Filenames\fR
+Default: 
+.br 
+
+.br 
+This is a list of filenames (or parts of filenames) that may appear in the filename of a web bug URL. They are only checked in the filename, not any directories or hostnames in the URL of the possible web bug. If it appears, then the web bug is assumed to be a harmless "spacer" for page layout purposes and not a real web bug at all. It should be a space\- and/or comma\-separated list of filename parts. Note: Use this with care, as spammers may use this to circumvent the web bug trap. It is disabled by default because of this problem. This can also be the filename of a ruleset.
+
+.TP 
+\fBWeb Bug Replacement\fR
+Default: http://www.sng.ecs.soton.ac.uk/mailscanner/images/1x1spacer.gif
+.br 
+
+.br 
+When a web bug is found, what image do you want to replace it with? By replacing it with a real image, the page layout still works properly, so the formatting and layout of the message is correct. The following is a harmless untracked 1x1 pixel transparent image. If this is not specified, the the old value of "MailScannerWebBug" is used, which of course is not an image and may well upset layout of the email. This can also be the filename of a ruleset.
+
+.TP 
 \fBAllow Object Codebase Tags\fR
 Default: no
 .br 
@@ -1682,7 +1766,7 @@
 .SH "SpamAssassin"
 .TP 
 \fBUse SpamAssassin\fR
-Default: no
+Default: yes
 .br 
 
 .br 
@@ -2076,6 +2160,15 @@
 .RE
 
 .TP 
+\fBSpamAssassin Local State Dir\fR
+Default:
+.br 
+
+.br 
+The rules created by the "sa\-update" tool are searched for here. This directory contains the spamassassin/3.001001/updates_spamassassin_org directory structure beneath it. Only un\-comment this setting once you have proved that the sa\-update cron job has run successfully and has created a directory structure under the spamassassin directory within this one and has put some *.cf files in there. Otherwise it will ignore all your current rules!
+
+
+.TP 
 \fBSpamAssassin Default Rules Dir\fR
 Default:
 .br 
@@ -2113,6 +2206,22 @@
 .RE
 
 .TP 
+\fBSpamAssassin Cache Timings\fR
+Default: 1800,300,10800,172800,600
+.br 
+Do not change this unless you absolutely have to, these numbers have been carefully calculated. They affect the length of time that different types of message are stored in the SpamAssassin cache which can be configured earlier in this file (look for "Cache"). The numbers are all set in seconds. They are:
+.br 
+1. Non\-Spam cache lifetime                           = 30 minutes
+.br 
+2. Spam (low scoring) cache lifetime                 = 5 minutes
+.br 
+3. High\-Scoring spam cache lifetime                  = 3 hours
+.br 
+4. Viruses cache lifetime                            = 2 days
+.br 
+5. How often to check the cache for expired messages = 10 minutes
+
+.TP 
 \fBDebug\fR
 Default: no
 .br 
@@ -2167,6 +2276,15 @@
 
 .br 
 The value of the option is actually never used, but it is evaluated at the end of processing a batch of messages. It is designed to be used in conjunction with a Custom Function. The Custom Function should then be written to have a "side effect" of doing something useful such as logging lots of information about the batch of messages to a file or an SQL database. 
+
+
+.TP 
+\fBAlways Looked Up Last After Batch\fR
+Default: no
+.br 
+
+.br 
+This option is intended for people who want to log per\-batch information. This is evaluated after the "Always Looked Up Last" configuration option for each message in the batch. This is looked up once for the entire batch. Its value is completely ignored, it is purely there to have side effects. If you want to use it, read CustomConfig.pm. 
 
 .TP 
 \fBDeliver in Background\fR
