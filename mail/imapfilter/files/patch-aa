--- Makefile.orig	Sat Oct  5 12:28:37 2002
+++ Makefile	Sat Oct  5 12:30:57 2002
@@ -1,9 +1,9 @@
-CC = cc
-CFLAGS = -O
+DESTDIR = $(PREFIX)
+BINDIR = $(PREFIX)/bin
+MANDIR = $(PREFIX)/man
 
-DESTDIR = /usr/local
-BINDIR = /usr/local/bin
-MANDIR = /usr/local/man
+INST_BIN = $(BSD_INSTALL_PROGRAM)
+INST_DOC = $(BSD_INSTALL_MAN)
 
 MAN_BIN = imapfilter.1
 MAN_RC = imapfilterrc.5
@@ -14,6 +14,8 @@
 
 LIBS =  -lssl -lcrypto
 
+all: imapfilter
+
 imapfilter: $(OBJ)
 	$(CC) $(LIBS) $(CFLAGS) -o $(BIN) $(OBJ)
 
@@ -22,12 +24,9 @@
 data.o imapfilter.o imap.o file.o passwd.o request.o socket.o: data.h
 
 install: imapfilter
-	if test ! -d $(BINDIR); then mkdir -p $(BINDIR); fi
-	cp -f $(BIN) $(BINDIR) && chmod 0755 $(BINDIR)/$(BIN)
-	if test ! -d $(MANDIR)/man1; then mkdir -p $(MANDIR)/man1; fi
-	cp -f $(MAN_BIN) $(MANDIR)/man1 && chmod 0644 $(MANDIR)/man1/$(MAN_BIN)
-	if test ! -d $(MANDIR)/man5; then mkdir -p $(MANDIR)/man5; fi
-	cp -f $(MAN_RC) $(MANDIR)/man5 && chmod 0644 $(MANDIR)/man5/$(MAN_RC)
+	$(INST_BIN) $(BIN) $(BINDIR)
+	$(INST_DOC) $(MAN_BIN) $(MANDIR)/man1
+	$(INST_DOC) $(MAN_RC) $(MANDIR)/man5
 
 uninstall:
 	rm -f $(BINDIR)/$(BIN) $(MANDIR)/man1/$(MAN_BIN) $(MANDIR)/man5/$(MAN_RC)
