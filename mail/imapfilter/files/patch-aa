--- Makefile~	Sun Jul 28 18:09:32 2002
+++ Makefile	Sun Jul 28 18:09:24 2002
@@ -1,14 +1,11 @@
-CC = cc
 CFLAGS = -Wall -O2
 
-DESTDIR = /usr/local
-BINDIR = /usr/local/bin
-MANDIR = /usr/local/man
-
-INSTALL = install -c
-INST_DIR = install -d
-INST_BIN = $(INSTALL) -m 755
-INST_DOC = $(INSTALL) -m 644
+DESTDIR = $(PREFIX)
+BINDIR = $(PREFIX)/bin
+MANDIR = $(PREFIX)/man
+
+INST_BIN = $(BSD_INSTALL_PROGRAM)
+INST_DOC = $(BSD_INSTALL_MAN)
 
 MAN_BIN = imapfilter.1
 MAN_RC = imapfilterrc.5
@@ -19,6 +16,8 @@
 
 LIBS =  -lssl -lcrypto
 
+all: imapfilter
+
 imapfilter: $(OBJ)
 	$(CC) $(LIBS) $(CFLAGS) -o $(BIN) $(OBJ)
 
@@ -27,11 +26,8 @@
 data.o imapfilter.o imap.o file.o passwd.o request.o socket.o: data.h
 
 install: imapfilter
-	if test ! -d $(BINDIR); then $(INST_DIR) $(BINDIR); fi
 	$(INST_BIN) $(BIN) $(BINDIR)
-	if test ! -d $(MANDIR)/man1; then $(INST_DIR) $(MANDIR)/man1; fi
 	$(INST_DOC) $(MAN_BIN) $(MANDIR)/man1
-	if test ! -d $(MANDIR)/man5; then $(INST_DIR) $(MANDIR)/man5; fi
 	$(INST_DOC) $(MAN_RC) $(MANDIR)/man5
 
 uninstall:
@@ -44,4 +40,4 @@
 	@if test -f .Makefile; then mv .Makefile Makefile; fi
 	@if test -f .config.h; then mv .config.h config.h; fi
 
-.PHONY : install uninstall clean distclean
+.PHONY : all install uninstall clean distclean
