--- Makefile	Tue Nov  2 19:47:10 1999
+++ Makefile.new	Sat Mar 10 14:28:13 2001
@@ -1,13 +1,13 @@
-CC		= gcc
-COPT		= -O2
+CC		= cc
+COPT		= 
 CDEF		= -D_REENTRANT
-CWARN		= -Wall -Werror
-CDBG		= -ggdb
-CFLAGS		= ${CWARN} ${COPT} ${CDEF} ${CDBG}
+CWARN		= -Wall
+CDBG		= 
+CFLAGS		+= ${CWARN} ${COPT} ${CDEF} ${CDBG}
 LDFLAGS		= 
-LIBS            = -lpthread
-INSTDIR		= /usr/local/sbin
-MANDIR		= /usr/local/man/man8
+LIBS            = -lc_r
+INSTDIR		= ${PREFIX}/sbin
+MANDIR		= ${PREFIX}/man/man8
 SHELL		= /bin/sh
 
 all:	dnrd
@@ -17,17 +17,16 @@
 	rm -f dnrd core tags ID *.o *.d *~ *.bak
 
 install: dnrd
-	strip dnrd
-	install -m 0751 -o root -g root -s dnrd ${INSTDIR}
-	install -m 0644 -o root -g root -s ../doc/dnrd.8 ${MANDIR}
+	install -m 0755 -s -o root -g wheel -s -c dnrd ${INSTDIR}
+	install -m 0544 -o root -g wheel -c ../doc/dnrd.8 ${MANDIR}
 
 sources = args.c cache.c common.c dns.c lib.c main.c master.c \
 	  query.c relay.c sig.c tcp.c udp.c
 
-include $(sources:.c=.d)
+#include $(sources:.c=.d)
 
 dnrd:	$(sources:.c=.o)
-	$(CC) $(LDFLAGS) $(LIBS) $^ -o $@
+	$(CC) $(LDFLAGS) $(LIBS) *.o -o $@
 
 %.d: %.c
 	@$(SHELL) -ec '$(CC) -MM $(CFLAGS) $< \
