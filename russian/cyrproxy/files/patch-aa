--- Makefile.orig	Thu Feb  8 14:33:53 2001
+++ Makefile	Sat Oct 12 12:55:07 2002
@@ -6,9 +6,9 @@
 
 CHMOD=/bin/chmod
 CHOWN=/usr/sbin/chown
-GCC=gcc -O
-CFLAGS=-funsigned-char -Wall
-CC=${GCC} ${CFLAGS}
+#GCC=gcc -O
+CFLAGS+=-funsigned-char -Wall
+#CC=${GCC} ${CFLAGS}
 # Some systems contains resolver routines in libresolv
 # EXTRALIBS=lresolv
 EXTRALIBS=
@@ -18,23 +18,23 @@
 TABLEMODE=644
 TABLEDIRMODE=755
 
-CONFOWN=root.wheel
-BINOWN=root.wheel
-TABLEOWN=root.wheel
+CONFOWN=root:wheel
+BINOWN=root:wheel
+TABLEOWN=root:wheel
 
 #directory to place  binary
-BINDIR=/usr/local/bin
-UTILDIR=/usr/local/bin
-CGIPATH=/usr/local/www/cgi-bin
+BINDIR=${PREFIX}/bin
+UTILDIR=${PREFIX}/bin
+CGIPATH=${PREFIX}/www/cgi-bin
 # name of binaries
 CYRPROXY=cyrproxy
 SPY=tcpspy
 
 # directory ty place recoding tables
-TBLDIR=/usr/local/share/proxy
+TBLDIR=${PREFIX}/share/proxy
 
 # config file location
-CONF_FILE=/etc/cyrproxy.conf
+CONF_FILE=${PREFIX}/etc/cyrproxy.conf
 
 # Subdirs for make
 # cyrcoder - filter-like cyrillic recoder
@@ -58,14 +58,14 @@
 ALLSRCS=${SRCS} spy.c
 OBJS=com_gw.o readconf.o connect.o gopher_gw.o main.o telnet_gw.o http_gw.o log.o bufio.o
 
-CFLAGS+= -Wall -O ${DEFINES}
+CFLAGS+= ${DEFINES}
 
 
 all: ${CYRPROXY} ${SPY} subdirmake config.gen
 
 
 subdirmake:
-	@for i in ${SUBDIRS}; do echo "Making all in $$i" ;cd $$i; pmake all; cd ..; done
+	@for i in ${SUBDIRS}; do echo "Making all in $$i" ;cd $$i; make all; cd ..; done
 
 .SUFFIXES: .a .o .c
 
@@ -78,12 +78,12 @@
 	rm -f config.gen cyrproxy.config.sample alldefs.h
 
 clean-sub:
-	@for i in ${SUBDIRS}; do echo "Make clean in $$i" ; cd $$i; pmake clean; cd .. ; done
+	@for i in ${SUBDIRS}; do echo "Make clean in $$i" ; cd $$i; make clean; cd .. ; done
 
 install: install-bin install-config install-tables install-sub
 
 install-sub:
-	@for i in ${SUBDIRS} ; do cd $$i ; pmake install; cd ..; done
+	@for i in ${SUBDIRS} ; do cd $$i ; make install; cd ..; done
 
 install-bin: ${CYRPROXY} ${SPY}
 	cp ${CYRPROXY} ${BINDIR}
