--- deps/v8/src/platform-freebsd.cc.orig	2011-01-22 10:18:37.000000000 +0800
+++ deps/v8/src/platform-freebsd.cc	2011-01-22 21:44:50.000000000 +0800
@@ -416,7 +416,7 @@
 
 
 Thread::Thread(const char* name) : ThreadHandle(ThreadHandle::INVALID) {
-  set_names(name);
+  set_name(name);
 }
 
 
@@ -512,6 +512,16 @@
     return result;
   }
 
+  virtual bool TryLock() {
+    int result = pthread_mutex_trylock(&mutex_);
+    // Return false if the lock is busy and locking failed.
+    if (result == EBUSY) {
+      return false;
+    }
+    ASSERT(result == 0);  // Verify no other errors.
+    return true;
+  }
+
  private:
   pthread_mutex_t mutex_;   // Pthread mutex for POSIX platforms.
 };
@@ -590,7 +600,7 @@
   TickSample sample;
 
   // We always sample the VM state.
-  sample.state = VMState::current_state();
+  // sample.state = VMState::current_state();
 
   // If profiling, we extract the current pc and sp.
   if (active_sampler_->IsProfiling()) {
