--- deps/v8/src/platform-freebsd.cc.orig	2010-12-18 01:51:48.000000000 +0800
+++ deps/v8/src/platform-freebsd.cc	2010-12-26 00:30:36.000000000 +0800
@@ -500,6 +500,16 @@
     return result;
   }
 
+  virtual bool TryLock() {
+    int result = pthread_mutex_trylock(&mutex_);
+    // Return false if the lock is busy and locking failed.
+    if (result == EBUSY) {
+      return false;
+    }
+    ASSERT(result == 0);  // Verify no other errors.
+    return true;
+  }
+
  private:
   pthread_mutex_t mutex_;   // Pthread mutex for POSIX platforms.
 };
@@ -578,7 +588,7 @@
   TickSample sample;
 
   // We always sample the VM state.
-  sample.state = VMState::current_state();
+  // sample.state = VMState::current_state();
 
   // If profiling, we extract the current pc and sp.
   if (active_sampler_->IsProfiling()) {
