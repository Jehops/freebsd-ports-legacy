diff -urN apache_1.3.41/src/main/buff.c src/main/buff.c
--- apache_1.3.41/src/main/buff.c	2006-07-12 10:16:05.000000000 +0200
+++ src/main/buff.c	2010-01-07 11:28:00.000000000 +0100
@@ -737,7 +737,7 @@
 {
     int i, nrd;
 
-    if (fb->flags & B_RDERR)
+    if (fb->flags & B_RDERR || nbyte < 0)
 	return -1;
     if (nbyte == 0)
 	return 0;
@@ -1258,7 +1258,7 @@
     static int csize = 0;
 #endif /*CHARSET_EBCDIC*/
 
-    if (fb->flags & (B_WRERR | B_EOUT))
+    if (fb->flags & (B_WRERR | B_EOUT) || nbyte < 0)
 	return -1;
     if (nbyte == 0)
 	return 0;
diff -urN apache_1.3.41/src/modules/proxy/proxy_util.c src/modules/proxy/proxy_util.c
--- apache_1.3.41/src/modules/proxy/proxy_util.c	2007-10-30 20:17:03.000000000 +0100
+++ src/modules/proxy/proxy_util.c	2010-01-07 11:28:00.000000000 +0100
@@ -507,7 +507,7 @@
 
             /* read the chunk */
             if (remaining > 0) {
-                n = ap_bread(f, buf, MIN((int)buf_size, (int)remaining));
+                n = ap_bread(f, buf, (int) MIN(buf_size, remaining));
                 if (n > -1) {
                     remaining -= n;
                     end_of_chunk = (remaining == 0);
