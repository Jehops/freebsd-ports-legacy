--- Makefile.orig	Wed Sep 15 18:34:27 2004
+++ Makefile	Sat Jan 22 14:58:01 2005
@@ -8,21 +8,16 @@
 ##  @todo autoconf/automake (i18n/apache2)
 
 #   the tools
-CC = gcc
-INSTALL = install
+CC ?= gcc
+INSTALL ?= install
 
 ifeq ($(APACHE_VERSION),2)
-APXS = apxs2
-APACHECTL = apache2ctl
-APRCONFIG = apr-config
 APINCDIR = $(shell $(APRCONFIG) --includes)
 APCFLAGS = $(shell $(APRCONFIG) --cflags | sed -e "s/-g //" -e "s/-O.//" -e "s/-W[a-z]*//")
 APCPPFLAGS = $(shell $(APRCONFIG) --cppflags)
 #APLIBXDIR = $(shell $(APRCONFIG) --installbuilddir)
 APLIBXDIR = $(shell $(APXS) -q LIBEXECDIR)
 else
-APXS = apxs
-APACHECTL = apachectl
 APCFLAGS = $(shell $(APXS) -q CFLAGS_SHLIB | sed -e "s/-g //" -e "s/-O.//" -e "s/-W[a-z]*//")
 APLIBXDIR = $(shell $(APXS) -q LIBEXECDIR)
 endif
@@ -31,11 +26,11 @@
 # debian doesn't have some libs (faad2 for instance...)
 DEBCPPFLAGS = -DHAS_MP3 -DHAS_OGG -DHAS_FLAC
 # in all cases:
-CPPFLAGS = -DHAS_MP3 -DHAS_OGG -DHAS_FLAC -DHAS_MP4
+#CPPFLAGS = -DHAS_MP3 -DHAS_OGG -DHAS_FLAC -DHAS_MP4
 #INC = 
 #LDFLAGS = 
-CFLAGS = -O2 -Wall
-DOCROOT = /var/www
+CFLAGS += -Wall
+DOCROOT = ${LOCALBASE}/www
 
 #   our own defines
 UNAME := $(shell uname)
@@ -90,8 +85,6 @@
 	$(INSTALL) -d $(DESTDIR)$(DOCROOT)/musicindex $(DESTDIR)$(LIBEXECDIR)
 	$(INSTALL) -m 0644 musicindex/*.* $(DESTDIR)$(DOCROOT)/musicindex
 	$(INSTALL) -m 0644 $(MOD_SO) $(DESTDIR)$(LIBEXECDIR)
-	@echo -e "\nDon't forget to edit your httpd.conf (see README for details):\n \
-		LoadModule musicindex_module $(DESTDIR)$(LIBEXECDIR)/$(MOD_SO)"
 
 #   how to compile the objects
 %.o: %.c %.h mod_musicindex.h
