--- Makefile.PL.orig	Tue Dec 30 11:03:22 1997
+++ Makefile.PL	Tue Dec 30 11:08:37 1997
@@ -32,15 +32,10 @@
 gen_script("t/net/perl/cgi.pl");
 gen_script("t/report");
 
-unless ($Is_Win32) {
-    readline_setup();        
-}
-
-eval 'use Apache::MyConfig' ;
-
-$APACHE_SRC_DEFAULT = $@ ? 
-    '../apache_x.x/src'  :
-    $Apache::MyConfig::Setup{Apache_Src} ; 
+opendir( WRKDIR, "$ENV{PORTSDIR}/www/apache12/work" ) || die( "Can't open $ENV{PORTSDIR}/www/apache/work: $!\n" );
+( $srcdir ) = grep( /^apache/, readdir( WRKDIR ) );
+closedir( WRKDIR );
+$APACHE_SRC_DEFAULT = "$ENV{PORTSDIR}/www/apache12/work/" . $srcdir . "/src";
 
 my $PWD = cwd;
 my %SSL = (
@@ -109,11 +104,11 @@
 $EVERYTHING = 0;
 $PERL_STATIC_EXTS = "";
 $Port = $PORT = 8529;
-$DO_HTTPD = $ENV{DO_HTTPD} || 0;
+$DO_HTTPD = 1;
 $NO_HTTPD = $ENV{NO_HTTPD} || 0;
 $PERL_TRACE = 0;
 $ALL_HOOKS  = 0;
-$APACHE_SRC = "";
+$APACHE_SRC = $APACHE_SRC_DEFAULT;
 $PERL_SECTIONS = 0;
 $PERL_SSI = 0;
 $ADD_VERSION = 1;
@@ -912,8 +907,8 @@
     my $sro = 1 if $mmn >= 19970825;
     my $inc;
     my $ccopts = ccopts();
-    my $dssv = "-DSERVER_SUBVERSION";
-    my $ssv = qq{$dssv=\\"mod_perl/$VERSION\\" };
+    my $dssv = "\n-DSERVER_SUBVERSION";
+    my $ssv = qq{$dssv=\\"mod_perl/$VERSION\\" \\};
     $inc = " $ccopts -I. -I../.. -DUSE_PERL_SSI" if $PERL_SSI;
 #    $inc = qq{$dssv=\\"mod_perl/$VERSION\\" } if $ADD_VERSION;
 #    $inc .= " $ccopts -I. -I../.. -DUSE_PERL_SSI" if $PERL_SSI; 
