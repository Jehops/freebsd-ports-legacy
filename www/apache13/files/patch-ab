*** Makefile.tmpl.orig	Wed Jul 15 21:03:25 1998
--- Makefile.tmpl	Thu Jul 23 16:14:15 1998
***************
*** 107,112 ****
--- 107,113 ----
  runtimedir      = @runtimedir@
  logfiledir      = @logfiledir@
  proxycachedir   = @proxycachedir@
+ doc_prefix      = $(prefix)/share/doc/apache
  
  libexecdir_relative   = @libexecdir_relative@
  
***************
*** 167,173 ****
  			-DGID_MIN=$(suexec_gidmin) \
  			-DUSERDIR_SUFFIX=\"$(suexec_userdir)\" \
  			-DLOG_EXEC=\"$(logfiledir)/suexec_log\" \
! 			-DDOC_ROOT=\"$(datadir)/htdocs\" \
  			-DSAFE_PATH=\"$(suexec_safepath)\" \
  		' \
  		suexec; \
--- 168,174 ----
  			-DGID_MIN=$(suexec_gidmin) \
  			-DUSERDIR_SUFFIX=\"$(suexec_userdir)\" \
  			-DLOG_EXEC=\"$(logfiledir)/suexec_log\" \
! 			-DDOC_ROOT=\"$(datadir)/data\" \
  			-DSAFE_PATH=\"$(suexec_safepath)\" \
  		' \
  		suexec; \
***************
*** 224,232 ****
  	$(MKDIR) $(root)$(mandir)/man1
  	$(MKDIR) $(root)$(mandir)/man8
  	$(MKDIR) $(root)$(sysconfdir)
! 	$(MKDIR) $(root)$(datadir)/htdocs
  	$(MKDIR) $(root)$(datadir)/icons
! 	$(MKDIR) $(root)$(datadir)/cgi-bin
  	$(MKDIR) $(root)$(includedir)
  	$(MKDIR) $(root)$(runtimedir)
  	$(MKDIR) $(root)$(logfiledir)
--- 225,233 ----
  	$(MKDIR) $(root)$(mandir)/man1
  	$(MKDIR) $(root)$(mandir)/man8
  	$(MKDIR) $(root)$(sysconfdir)
! 	$(MKDIR) $(root)$(doc_prefix)
  	$(MKDIR) $(root)$(datadir)/icons
! 	$(MKDIR) $(root)$(datadir)/cgi-bin.default
  	$(MKDIR) $(root)$(includedir)
  	$(MKDIR) $(root)$(runtimedir)
  	$(MKDIR) $(root)$(logfiledir)
***************
*** 338,360 ****
  #   icons and distributed CGI scripts.
  install-data:
  	@echo "===> [data: Installing initial data files]"
! 	-@if [ -f $(root)$(datadir)/htdocs/index.html ]; then \
! 		echo "[PRESERVING EXISTING DATA SUBDIR: $(root)$(datadir)/htdocs/]"; \
! 	else \
! 		echo "Copying tree $(TOP)/htdocs/ -> $(root)$(datadir)/htdocs/"; \
  		(cd $(TOP)/htdocs/ && $(TAR) cf - *) |\
! 		(cd $(root)$(datadir)/htdocs/ && $(TAR) xf -); \
! 		find $(root)$(datadir)/htdocs/ -type d -exec chmod a+rx {} \; ; \
! 		find $(root)$(datadir)/htdocs/ -type f -exec chmod a+r {} \; ; \
! 	fi
! 	-@if [ -f $(root)$(datadir)/cgi-bin/printenv ]; then \
! 		echo "[PRESERVING EXISTING DATA SUBDIR: $(root)$(datadir)/cgi-bin/]"; \
! 	else \
! 		echo "Copying tree $(TOP)/cgi-bin/ -> $(root)$(datadir)/cgi-bin/"; \
  		(cd $(TOP)/cgi-bin/ && $(TAR) cf - *) |\
! 		(cd $(root)$(datadir)/cgi-bin/ && $(TAR) xf -); \
! 		find $(root)$(datadir)/cgi-bin/ -type d -exec chmod a+rx {} \; ; \
! 		find $(root)$(datadir)/cgi-bin/ -type f -exec chmod a+r {} \; ; \
  	fi
  	@echo "Copying tree $(TOP)/icons/ -> $(root)$(datadir)/icons/"; \
  	(cd $(TOP)/icons/ && $(TAR) cf - *) |\
--- 339,368 ----
  #   icons and distributed CGI scripts.
  install-data:
  	@echo "===> [data: Installing initial data files]"
! #        -@if [ -f $(root)$(datadir)/htdocs/index.html ]; then \
! #                echo "[PRESERVING EXISTING DATA SUBDIR: $(root)$(datadir)/htdocs/]"; \
! #        else \
! 		echo "Copying tree $(TOP)/htdocs/ -> $(root)$(doc_prefix)/"; \
  		(cd $(TOP)/htdocs/ && $(TAR) cf - *) |\
! 		(cd $(root)$(doc_prefix)/ && $(TAR) xf -); \
! 		find $(root)$(doc_prefix)/ -type d -exec chmod a+rx {} \; ; \
! 		find $(root)$(doc_prefix)/ -type f -exec chmod a+r {} \; ; \
! #        fi
! 	 if [ ! -d $(root)$(datadir)/data ]; then \
! 		$(LN) -s $(root)$(doc_prefix) $(root)$(datadir)/data; \
! 	 fi
! 	 $(LN) -s $(root)$(doc_prefix) $(root)$(datadir)/data.default
! #        -@if [ -f $(root)$(datadir)/cgi-bin/printenv ]; then \
! #                echo "[PRESERVING EXISTING DATA SUBDIR: $(root)$(datadir)/cgi-bin/]"; \
! #        else \
! 		echo "Copying tree $(TOP)/cgi-bin/ -> $(root)$(datadir)/cgi-bin.default/"; \
  		(cd $(TOP)/cgi-bin/ && $(TAR) cf - *) |\
! 		(cd $(root)$(datadir)/cgi-bin.default/ && $(TAR) xf -); \
! 		find $(root)$(datadir)/cgi-bin.default/ -type d -exec chmod a+rx {} \; ; \
! 		find $(root)$(datadir)/cgi-bin.default/ -type f -exec chmod a+r {} \; ; \
! #        fi
! 	if [ ! -d $(root)$(datadir)/cgi-bin ]; then \
! 		$(LN) -s $(root)$(datadir)/cgi-bin.default $(root)$(datadir)/cgi-bin; \
  	fi
  	@echo "Copying tree $(TOP)/icons/ -> $(root)$(datadir)/icons/"; \
  	(cd $(TOP)/icons/ && $(TAR) cf - *) |\
***************
*** 374,381 ****
  		 echo ""; \
  		 cat $(TOP)/conf/$${conf}-dist ) |\
  		 sed -e '/# LoadModule/r $(TOP)/$(SRC)/.apaci.install.conf' \
! 			-e 's;@@ServerRoot@@/htdocs;$(datadir)/htdocs;' \
! 			-e 's;@@ServerRoot@@/htdocs;$(datadir)/htdocs;' \
  			-e 's;@@ServerRoot@@/icons;$(datadir)/icons;' \
  			-e 's;@@ServerRoot@@/cgi-bin;$(datadir)/cgi-bin;' \
  			-e 's;@@ServerRoot@@/proxy;$(proxycachedir);' \
--- 382,389 ----
  		 echo ""; \
  		 cat $(TOP)/conf/$${conf}-dist ) |\
  		 sed -e '/# LoadModule/r $(TOP)/$(SRC)/.apaci.install.conf' \
! 			-e 's;@@ServerRoot@@/htdocs;$(datadir)/data;' \
! 			-e 's;@@ServerRoot@@/htdocs;$(datadir)/data;' \
  			-e 's;@@ServerRoot@@/icons;$(datadir)/icons;' \
  			-e 's;@@ServerRoot@@/cgi-bin;$(datadir)/cgi-bin;' \
  			-e 's;@@ServerRoot@@/proxy;$(proxycachedir);' \
***************
*** 383,392 ****
  			-e 's;logs/accept.lock;$(runtimedir)/httpd.lock;' \
  			-e 's;logs/apache_runtime_status;$(runtimedir)/httpd.scoreboard;' \
  			-e 's;logs/httpd.pid;$(runtimedir)/httpd.pid;' \
! 			-e 's;logs/access_log;$(logfiledir)/access_log;' \
! 			-e 's;logs/error_log;$(logfiledir)/error_log;' \
! 			-e 's;logs/referer_log;$(logfiledir)/referer_log;' \
! 			-e 's;logs/agent_log;$(logfiledir)/agent_log;' \
  			-e 's;conf/magic;$(sysconfdir)/magic;' \
  			-e 's;conf/mime.types;$(sysconfdir)/mime.types;' \
  			-e 's;Group #-1;Group $(conf_group);' \
--- 391,400 ----
  			-e 's;logs/accept.lock;$(runtimedir)/httpd.lock;' \
  			-e 's;logs/apache_runtime_status;$(runtimedir)/httpd.scoreboard;' \
  			-e 's;logs/httpd.pid;$(runtimedir)/httpd.pid;' \
! 			-e 's;logs/access_log;$(logfiledir)/httpd-access.log;' \
! 			-e 's;logs/error_log;$(logfiledir)/httpd-error.log;' \
! 			-e 's;logs/referer_log;$(logfiledir)/httpd-referer.log;' \
! 			-e 's;logs/agent_log;$(logfiledir)/httpd-agent.log;' \
  			-e 's;conf/magic;$(sysconfdir)/magic;' \
  			-e 's;conf/mime.types;$(sysconfdir)/mime.types;' \
  			-e 's;Group #-1;Group $(conf_group);' \
