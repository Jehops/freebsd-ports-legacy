#!/bin/sh
#
# $FreeBSD$

echo ${WRKSRC}/components.conf
if [ -f ${WRKSRC}/components.conf ]; then
	exit
fi

tempfile=`/usr/bin/mktemp -t checklist`

echo "browser deflenus langenus psm regus xpcom" > /tmp/checklist.tmp.$$;

/usr/bin/dialog --title "Mozilla component selection" --clear \
	--checklist "\n\
Choose which components of Mozilla to download and install. \n\
Press the space bar to toggle selections." -1 -1 6 \
"chatzilla"	"IRC client (160 kB)"					ON \
"inspector"	"DOM inspector (124 kB)"				ON \
"mail"		"mail and news client (1920 kB)"			ON \
"spellcheck"	"Spelling checker for mail and news (304 kB)"		ON \
"venkman"	"JavaScript debugger (224 kB)"				ON \
2>> /tmp/checklist.tmp.$$

retval=$?

case $retval in
	1)	echo "Cancel pressed."
		exit 1
	;;
esac

choice=`cat /tmp/checklist.tmp.$$`
rm -f /tmp/checklist.tmp.$$

echo "$choice"
echo "$choice" \
	| sed -e "s/\"//g" \
	| sort -u \
	| sed -e "s/ /.xpi /g" \
	| sed -e "s/$/.xpi/g" \
	| perl -pi -e "s/ /\n/g" \
	> ${WRKSRC}/components.conf

echo "* Your choices are saved.  You must run the \"make\" command again to"
echo "* complete the build.  Ignore the \"Error code 1\" below."
exit 1
