--- Makefile.orig	Wed Aug  4 13:44:08 1999
+++ Makefile	Wed Aug  4 14:40:54 1999
@@ -3,18 +3,19 @@
 #-----------------------------------------------------------------------------
 
 # Where to install web500gw
-INSTDIR = /usr/local/etc
+#INSTDIR = /usr/local/etc
 
 # Where to install the manual web500gw.8
-MANDIR	= /usr/local/man/man8
+#MANDIR	= /usr/local/man/man8
 
 # Where to install web500gw's config/filter/template/help/message files
 # It's recommended to use an own directory for it.
-WEB500GWDIR	= $(INSTDIR)/web500
+#WEB500GWDIR	= $(INSTDIR)/web500
 
 # What language dependent files should be installed? 
 # "" stands for english (default) versions
-SUFFIX = "" de es fr
+SUFFIX = "" de 
+# es fr
 
 
 # DEFINES - Enable/disable some features
@@ -51,7 +52,7 @@
 
 # T.61 <-> ISO-8859-1 translation: This is built in from LDAP 3.2.
 # If you didn't define this translation there comment out the following line:
-STR_TRANSLATION = -DSTR_TRANSLATION
+#STR_TRANSLATION = -DSTR_TRANSLATION
 # If you defined LDAP_DEBUG there and want to enable LDAP debugging
 # uncomment the following line:
 LDAP_DEBUG = -DLDAP_DEBUG
@@ -69,7 +70,7 @@
 
 # platform specific:
 # Linux
-PLATFORMCFLAGS= -Dlinux -DSYSV 
+# PLATFORMCFLAGS= -Dlinux -DSYSV 
 # Solaris 2
 # PLATFORMCFLAGS= -Dsunos5
 # PLATFORMLDFLAGS= -lsocket -lnsl
@@ -82,8 +83,8 @@
 # AIX
 # PLATFORMCFLAGS= -Daix
 # NetBSD:
-#PLATFORMCFLAGS=
-#PLATFORMLDFLAGS= -lcompat
+# PLATFORMCFLAGS=
+# PLATFORMLDFLAGS= -lcompat
 # OSF/1
 #PLATFORMCFLAGS= -Dosf -DSYSV
 #PLATFORMLDFLAGS=
@@ -99,8 +100,8 @@
 # when using gcc:
 CC	= gcc 
 #WARN = -Wall -Wno-implicit
-#CFLAGS	= -O4 $(WARN) $(ALLDEFINES) -fpcc-struct-return -fwritable-strings
-CFLAGS	= -g $(WARN) $(ALLDEFINES) -fpcc-struct-return -fwritable-strings
+CFLAGS	= -O4 $(WARN) $(ALLDEFINES) -fpcc-struct-return -fwritable-strings
+#CFLAGS	= -g $(WARN) $(ALLDEFINES) -fpcc-struct-return -fwritable-strings
 
 # or cc:
 #CC	= cc
@@ -110,9 +111,9 @@
 
 ################ end of configuration area ###############
 # ALDFLAGS are always passed to ld
-ALDFLAGS        = $(PLATFORMLDFLAGS)
+ALDFLAGS        = ${LDFLAGS} $(PLATFORMLDFLAGS)
 
-INSTALL = util/install.sh
+#INSTALL = util/install.sh
 MKDIR   = mkdir
 # LIBEFENCE = -lefence
 
@@ -138,7 +139,7 @@
 #web500gw.o:  messages.h web500gw.h
 
 web500gw:	Makefile $(OBJS)
-	$(CC) $(ALDFLAGS) -o $@ $(OBJS)  $(LIBS)
+	$(CC) $(ALDFLAGS) -o $@ $(OBJS)  $(LIBS) -lgnuregex
 
 #$(CC) $(ALDFLAGS) -o $@ $(OBJS) -R/usr/local/ic/usr/lib -L/usr/local/ic/usr/lib -lldap -llber -lisode
 
@@ -160,34 +161,34 @@
 	@echo ""
 	@if [ ! -d $(INSTDIR) ]; then $(MKDIR) -p $(INSTDIR); fi
 	@echo "Installing web500gw to $(INSTDIR)"
-	$(INSTALL) $(INSTALLFLAGS) -m 755 web500gw $(INSTDIR)
+	$(INSTALL_PROGRAM) web500gw $(INSTDIR)
 	@echo "... done!"
 
 install-etc:;
 	@echo ""
 	@if [ ! -d $(WEB500GWDIR) ]; then $(MKDIR) -p $(WEB500GWDIR); fi
 	@echo "Installing web500gw config/template/filter files to $(WEB500GWDIR)"
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/web500gw.conf $(WEB500GWDIR)
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/ldapfilter.conf $(WEB500GWDIR)
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/ldapfilter.conf.internal $(WEB500GWDIR)
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/ldaptemplates.conf $(WEB500GWDIR)
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/ldaptemplates.conf.internal $(WEB500GWDIR)
+	$(INSTALL_DATA) etc/web500gw.conf $(WEB500GWDIR)/sample.web500gw.conf
+	$(INSTALL_DATA) etc/ldapfilter.conf $(WEB500GWDIR)/sample.ldapfilter.conf
+	$(INSTALL_DATA) etc/ldapfilter.conf.internal $(WEB500GWDIR)/sample.ldapfilter.conf.internal
+	$(INSTALL_DATA) etc/ldaptemplates.conf $(WEB500GWDIR)/sample.ldaptemplates.conf
+	$(INSTALL_DATA) etc/ldaptemplates.conf.internal $(WEB500GWDIR)/sample.ldaptemplates.conf.internal
 	@echo ""
 	@echo "Installing web500gw help/message/friendly files to $(WEB500GWDIR)"
 	@for i in $(SUFFIX); do \
 	if [ "x$$i" = "x" ]; then echo " english"; SUFF="";\
 	else echo " $$i"; SUFF=".$$i"; fi; \
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/web500gw.help$$SUFF $(WEB500GWDIR); \
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/web500gw.messages$$SUFF $(WEB500GWDIR); \
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/web500gw.attr$$SUFF $(WEB500GWDIR); \
-	$(INSTALL) $(INSTALLFLAGS) -m 644 etc/ldapfriendly$$SUFF $(WEB500GWDIR); \
+	$(INSTALL_DATA) etc/web500gw.help$$SUFF $(WEB500GWDIR); \
+	$(INSTALL_DATA) etc/web500gw.messages$$SUFF $(WEB500GWDIR); \
+	$(INSTALL_DATA) etc/web500gw.attr$$SUFF $(WEB500GWDIR); \
+	$(INSTALL_DATA) etc/ldapfriendly$$SUFF $(WEB500GWDIR); \
 	done;
 	@echo "... done!"
 
 install-man:;
 	@echo ""
 	@echo "Installing web500gw.8 to $(MANDIR)"
-	$(INSTALL) $(INSTALLFLAGS) -m 644 doc/web500gw.8 $(MANDIR)
+	$(INSTALL_MAN) doc/web500gw.8 $(MANDIR)
 	@echo "... done!"
 
 lint:;
