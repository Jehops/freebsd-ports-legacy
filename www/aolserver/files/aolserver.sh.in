#! /bin/sh
#
#
# PROVIDE: aolserver
# REQUIRE: DAEMON NETWORKING SERVERS
#
# Add the following line to /etc/rc.conf to enable aolserver:
#
# aolserver_enable="YES"
#
# Tweakable parameters for users to override in rc.conf

aolserver_enable="${aolserver_enable-NO}"
aolserver_home=%%PREFIX%%/aolserver
aolserver_conf=${aolserver_home}/sample-config.tcl 
aolserver_flags="-u nobody -g nobody"
aolserver_prog=${aolserver_home}/bin/nsd

. "%%RC_SUBR%%"

name=aolserver
load_rc_config ${name}
pid=`ps -ax | grep ${aolserver_conf} | grep -v grep| awk -F' ' '{print $1}'`
rcvar=`set_rcvar`
required_files=${aolserver_conf}
command=${aolserver_prog}
procname=${aolserver_prog}

stop_cmd="if [ ! -z \"${pid}\" ] ; then \
		echo \"Notice: stopping aolserver.... Kill -TERM ${pid}\" ; \
		kill -TERM ${pid} ; \
	else \
		echo \"Notice: No aolserver process found. Nothing to stop.\" ; \
	fi"
start_cmd="if [ ! -z \"${pid}\" ] ; then \
		echo \"Notice: aolserver is already running.\"; \
	else \
		echo \"Notice: starting aolserver.......\" ; \
		echo \"Issuing command: ${command} -t ${aolserver_conf} ${aolserver_flags} \" ; \
		${command} -t ${aolserver_conf} ${aolserver_flags}; \
	fi"
status_cmd="if [ ! -z \"${pid}\" ] ; then \
		echo \"Notice: aolserver is running with pid ${pid}\" ; \
	else \
		echo \"Notice: aolserver is not running\" ; \
	fi"

run_rc_command "$1"

