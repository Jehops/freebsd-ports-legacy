--- links-2.2-ipv6-2.diff.orig	2011-10-20 16:20:13.000000000 +0400
+++ links-2.2-ipv6-2.diff	2011-10-20 16:21:37.000000000 +0400
@@ -207,7 +207,7 @@
  	if (!*name) return -1;
  	for (n = name; *n; n++) if (*n != '.' && (*n < '0' || *n > '9')) goto nogethostbyaddr;
  	n = name;
-@@ -73,26 +73,34 @@ int do_real_lookup(unsigned char *name, ip__address *host)
+@@ -63,27 +63,35 @@ int do_real_lookup(unsigned char *name, 
  	if (get_addr_byte(&n, ((unsigned char *)host + 3), 0)) goto skip_addr;
  	return 0;
  	skip_addr:
@@ -234,6 +234,7 @@
  	return 0;
  }
  
+ #ifndef NO_ASYNC_LOOKUP
  static void lookup_fn(unsigned char *name, int h)
  {
 -	ip__address host;
