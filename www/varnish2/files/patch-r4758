Index: bin/varnishd/cache_response.c
===================================================================
--- bin/varnishd/cache_response.c	(revision 4757)
+++ bin/varnishd/cache_response.c	(revision 4758)
@@ -325,7 +325,7 @@
 		}
 		if (ptr + len > high)
 			/* Chop tail of segment off */
-			len = 1 + high - low;
+			len = 1 + high - ptr;
 
 		ptr += len;
 
