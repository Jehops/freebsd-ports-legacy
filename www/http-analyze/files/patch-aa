--- Makefile.orig	Sun May 31 06:06:53 1998
+++ Makefile	Fri Sep  6 20:00:06 2002
@@ -28,9 +28,9 @@
 #	SVR4	/usr/share/man/cat1	-		1
 #	Linux	/usr/local/man/man1	-		man
 #
-LOCALLIB = /usr/local/lib
-LOCALBIN = /usr/local/bin
-LOCALMAN = /usr/local/man/cat1
+LOCALLIB = $(PREFIX)/lib
+LOCALBIN = $(PREFIX)/bin
+LOCALMAN = $(PREFIX)/man/man1
 
 # Program to use for compressing the manpage.
 # If set to 'true', no compression is applied.
@@ -41,12 +41,12 @@
 # Extension of the source to be installed as manpage.
 # if it is set to '1', the pre-formatted format is used,
 # if it is set to 'man', the source format is used.
-#EXTENSION = man
-EXTENSION = 1
+EXTENSION = man
+#EXTENSION = 1
 
 # Location of the GD library and include files.
-GDLIB	= /usr/local/lib/libgd.a
-GDINC	= /usr/local/include
+GDLIB	= $(PREFIX)/lib/libgd.a
+GDINC	= $(PREFIX)/include/gd
 
 #
 # Platform selection
@@ -76,7 +76,7 @@
 #
 #CC = cc
 #OPTIM = -O2
-OPTIM = -g
+#OPTIM = -g
 
 # Remove NDEBUG to include various assertion checks in the program.
 #COMDEFS = -DTIME_STATS -DNDEBUG
@@ -108,6 +108,10 @@
 #PLATFORM = -ansi -Dunix
 #CC = gcc
 
+# FreeBSD
+DEFINES = -DBSD -DHA_LIBDIR="$(LOCALLIB)/http-analyze"
+PLATFORM =
+
 # HP/UX
 #
 # Lacks definition of the 'unix' macro in it's compiler, so we
@@ -139,7 +143,7 @@
 #DEFINES = -DNETWARE $(COMDEFS)
 #PLATFORM = 
 
-CFLAGS  = $(OPTIM) $(PLATFORM) $(DEFINES)
+CFLAGS  += $(PLATFORM) $(DEFINES)
 LDFLAGS	=  
 LINT	= lint -Dunix -Xa -u
 LIBS	= -lm
@@ -212,14 +216,15 @@
 	cp http-analyze.$(EXTENSION) $(LOCALMAN)/http-analyze.1
 	chmod 755 $(LOCALBIN)/http-analyze $(LOCALBIN)/ha-setup
 	chmod 444 $(LOCALMAN)/http-analyze.1
-	chown bin.bin $(LOCALBIN)/http-analyze $(LOCALBIN)/ha-setup
-	$(COMPRESS) $(LOCALMAN)/http-analyze.1
+	chown bin:bin $(LOCALBIN)/http-analyze $(LOCALBIN)/ha-setup
+	-mkdir -p $(PREFIX)/share/doc/http-analyze
+	cp http-analyze.pdf http-analyze.ps $(PREFIX)/share/doc/http-analyze
 	-mkdir -p $(LOCALLIB)/http-analyze/btn
-	cp files/3D* files/TLD files/bugreport.html sample.conf $(LOCALLIB)/http-analyze/
+	cp files/3D* files/TLD files/bugreport.html rotate-httpd sample.conf \
+		$(LOCALLIB)/http-analyze/
 	cp files/btn/* $(LOCALLIB)/http-analyze/btn/
 	@echo "\nNow run 'ha-setup' to configure http-analyze for your server (Unix only).\n"
 
-
 clean:
 	-rm -f $(HA_OBJ) $(3D_OBJ) lint.out
 
@@ -228,4 +233,3 @@
 
 clobber::	realclean
 	-rm -f index.html stats*.html stats*.hist sites*.html files*.html agents*.html *.gif
-
