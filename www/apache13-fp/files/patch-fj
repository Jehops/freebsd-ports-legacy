--- src/main/util.c.orig	Thu Feb  1 04:06:37 2001
+++ src/main/util.c	Wed Mar 21 21:12:35 2001
@@ -708,7 +708,7 @@
     char *res;
 
     for (x = 0; (*line)[x]; x++) {
-	if (ap_isspace((*line)[x])) {
+	if (ap_isspace((*line)[x]) && ((*line)[x] & 0x80)==0) {
 	    pos = x;
 	    break;
 	}
@@ -2040,7 +2040,6 @@
 	ap_log_error(APLOG_MARK, APLOG_WARNING, NULL,
 	             "%s: gethostname() failed to determine ServerName\n",
                      ap_server_argv0);
-	server_hostname = ap_pstrdup(a, "127.0.0.1");
     }
     else 
     {
@@ -2048,7 +2047,7 @@
         if ((!(p = gethostbyname(str))) 
             || (!(server_hostname = find_fqdn(a, p)))) {
             /* Recovery - return the default servername by IP: */
-            if (p->h_addr_list[0]) {
+            if (p && p->h_addr_list[0]) {
                 ap_snprintf(str, sizeof(str), "%pA", p->h_addr_list[0]);
 	        server_hostname = ap_pstrdup(a, str);
                 /* We will drop through to report the IP-named server */
