--- src/main/http_request.c.orig	Tue Jan 11 08:13:41 2000
+++ src/main/http_request.c	Sun Feb 20 18:44:49 2000
@@ -176,7 +176,7 @@
 {
     char *cp;
     char *path = r->filename;
-    char *end = &path[strlen(path)];
+    char *end;
     char *last_cp = NULL;
     int rv;
 #ifdef HAVE_DRIVE_LETTERS
@@ -188,6 +188,9 @@
 	return OK;
     }
 
+    if (r->execfilename) path = r->execfilename;
+    end = path + strlen(path);
+
 #ifdef HAVE_DRIVE_LETTERS
     /* If the directory is x:\, then we don't want to strip
      * the trailing slash since x: is not a valid directory.
@@ -576,6 +579,7 @@
             res = ap_parse_htaccess(&htaccess_conf, r, overrides_here,
                                  ap_pstrdup(r->pool, test_dirname),
                                  sconf->access_name);
+            if (r->execfilename) r->filename = r->execfilename;
             if (res)
                 return res;
 
@@ -586,6 +590,7 @@
 		r->per_dir_config = per_dir_defaults;
 	    }
         }
+	if (r->execfilename) r->filename = r->execfilename;
     }
 
     /*
