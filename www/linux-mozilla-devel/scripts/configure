#!/bin/sh
#
# $FreeBSD$

echo ${WRKSRC}/components.conf
if [ -f ${WRKSRC}/components.conf ]; then
	exit
fi

tempfile=`/usr/bin/mktemp -t checklist`

echo "browser langenus regus xpcom" > /tmp/checklist.tmp.$$;

/usr/bin/dialog --title "Mozilla component selection" --clear \
	--checklist "\n\
Choose which components of Mozilla to download and install. \n\
Press the space bar to toggle selections." -1 -1 6 \
"deflenus"	"American English profile defaults (8 kB)"		ON \
"inspector"	"DOM inspector (150 kB)"				ON \
"mail"		"Mozilla Mail and News (1824 kB)"			ON \
"psm"		"Personal Security Manager--recommended (768 kB)"	ON \
"talkback"	"sends crash logs to Mozilla staff (832 kB)"		ON \
"venkman"	"JavaScript debugger (224 kB)"				ON \
2>> /tmp/checklist.tmp.$$

retval=$?

case $retval in
	1)	echo "Cancel pressed."
		exit 1
	;;
esac

choice=`cat /tmp/checklist.tmp.$$`
rm -f /tmp/checklist.tmp.$$

echo "$choice"
echo "$choice" \
	| sed -e "s/\"//g" \
	| sort -u \
	| sed -e "s/ /.xpi /g" \
	| sed -e "s/$/.xpi/g" \
	| perl -pi -e "s/ /\n/g" \
	> ${WRKSRC}/components.conf

echo "* Your choices are saved.  You must run the \"make\" command again to"
echo "* complete the build.  Ignore the \"Error code 1\" below."
exit 1
