--- CGI.pm.orig	2008-05-13 09:32:19.000000000 +0200
+++ CGI.pm	2008-05-13 09:32:59.000000000 +0200
@@ -3387,7 +3387,7 @@ sub read_multipart {
         # content-disposition parsing fail.
         my ($filename) = $header{'Content-Disposition'}
 	               =~/ filename=(("[^"]*")|([a-z\d!\#'\*\+,\.^_\`\{\}\|\~]*))/i;
-        $filename =~ s/^"([^"]*)"$/$1/;
+        $filename =~ s/^"([^"]*)"$/$1/ if defined $filename;
 	# Test for Opera's multiple upload feature
 	my($multipart) = ( defined( $header{'Content-Type'} ) &&
 		$header{'Content-Type'} =~ /multipart\/mixed/ ) ?
