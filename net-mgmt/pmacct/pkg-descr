pmacct is a network tool to gather ip traffic informations
(bytes counter and number of packets); aggregation of
statistics is done using simple primitives (MAC addresses,
source host, destination host, ports and ip protocols) that can
be used alone or combined together to form complex aggregation
methods; counters are either global or historical (aggregated
and separated at fixed timeslots). Data is stored in a
in-memory table or using a SQL database (MySQL or PostgreSQL).
Gathering packets off the wire is done using pcap library and
promiscuous mode of network interfaces when specifically
required.

WWW: http://www.ba.cnr.it/~paolo/pmacct/ 
