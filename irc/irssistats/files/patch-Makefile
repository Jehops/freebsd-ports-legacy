--- Makefile.orig	Mon Feb  7 16:57:05 2005
+++ Makefile	Thu Jun 22 11:36:11 2006
@@ -1,23 +1,31 @@
-PRE = /usr/local
-BIN = $(PRE)/bin
-DAT = $(PRE)/share/irssistats/data
-DOC = $(PRE)/share/doc/irssistats
-MAN = $(PRE)/share/man/man1
+PRE = $(PREFIX)
+BIN = $(PREFIX)/bin
+DAT = $(DATADIR)
+SMP = $(EXAMPLESDIR)
+DOC = $(DOCSDIR)
+MAN = $(PREFIX)/man/man1
 
 irssistats:irssistats.c
-	gcc -O2 -o irssistats irssistats.c
+	${CC} ${CFLAGS} -o irssistats irssistats.c
 
 clean:
 	rm -f irssistats
 
 install:irssistats
-	mkdir -p $(BIN) $(DAT) $(DOC) $(MAN)
+	mkdir -p $(BIN) $(DAT) $(MAN) $(SMP)
+
 	cp -f irssistats $(BIN)
 	cp -f data/* $(DAT)
-	cp -f COPYING README sample.nickfile sample.configfile irssistats.sgml $(DOC)
+	cp -f sample.nickfile sample.configfile $(SMP)
+.ifndef NOPORTDOCS
+	mkdir -p $(DOC)
+	cp -f COPYING README $(DOC)
+.endif
 	cp -f irssistats.1 $(MAN)
 
 uninstall:
 	rm -f $(BIN)/irssistats
 	rm -rf $(DAT) $(DOC)
 	rm -f $(MAN)/irssistats.1
+
+all: install
