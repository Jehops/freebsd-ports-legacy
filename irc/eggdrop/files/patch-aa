--- configure.orig	Sat Mar 30 04:48:49 2002
+++ configure
@@ -2808,7 +2808,13 @@
   *BSD)
     # FreeBSD/OpenBSD/NetBSD
     SHLIB_CC="$CC -fPIC"
-    SHLIB_LD="ld -Bshareable -x"
+    if [ `echo __ELF__ | $CC -E - | grep -v '#'` = 1 ]; then
+	SHLIB_LD="ld -shared -x"
+	BEL_MOD_LD="$CC -Wl,-E $LDFLAGS"
+    else
+	SHLIB_LD="ld -Bshareable -x"
+	BEL_MOD_LD="$CC $LDFLAGS"
+    fi
     cat >>confdefs.h <<\_ACEOF
 #define MODULES_OK 1
 _ACEOF
