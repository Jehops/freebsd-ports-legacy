# Fixes potential crash when receiving an invalid PSEND ID number.
--- src/common/dcc.c	2003-11-28 14:06:57.000000000 +1100
+++ src/common/dcc.c	2003-12-13 20:17:12.000000000 +1100
@@ -1659,9 +1659,15 @@
 			 * sending file.
 			 */
 			dcc = find_dcc_from_id (pasvid, TYPE_SEND);
-			dcc->addr = addr;
-			dcc->port = port;
-			dcc_connect(dcc);
+			if (dcc)
+			{
+				dcc->addr = addr;
+				dcc->port = port;
+				dcc_connect (dcc);
+			} else
+			{
+				dcc_malformed (sess, nick, word_eol[4] + 2);
+			}
 			return;
 		}

