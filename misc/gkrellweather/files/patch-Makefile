--- Makefile.orig	Sat Apr 14 12:49:15 2001
+++ Makefile	Tue Jul  3 01:47:05 2001
@@ -1,20 +1,20 @@
-GTK_INCLUDE = `gtk-config --cflags`
-GTK_LIB = `gtk-config --libs`
+GTK_INCLUDE = `$(GTK_CONFIG) --cflags`
+GTK_LIB = `$(GTK_CONFIG) --libs`
 
-IMLIB_INCLUDE = `imlib-config --cflags-gdk`
-IMLIB_LIB = `imlib-config --libs-gdk`
+IMLIB_INCLUDE = `$(IMLIB_CONFIG) --cflags-gdk`
+IMLIB_LIB = `$(IMLIB_CONFIG) --libs-gdk`
 
 
-FLAGS = -O2 -Wall -fPIC $(GTK_INCLUDE) $(IMLIB_INCLUDE)
-LIBS = $(GTK_LIB) $(IMLIB_LIB)
+FLAGS = -Wall -fPIC $(GTK_INCLUDE) $(IMLIB_INCLUDE) ${PTHREAD_CFLAGS}
+LIBS = $(GTK_LIB) $(IMLIB_LIB) ${PTHREAD_LIBS}
 LFLAGS = -shared
 
-CC = gcc $(CFLAGS) $(FLAGS)
+CC += $(CFLAGS) $(FLAGS)
 
 OBJS = gkrellweather.o
 
 gkrellweather.so: $(OBJS)
-	$(CC) $(OBJS) -o gkrellweather.so $(LFLAGS) $(LIBS)  -lpthread
+	$(CC) $(OBJS) -o gkrellweather.so $(LFLAGS) $(LIBS)
 
 clean:
 	rm -f *.o core *.so* *.bak *~
