
$FreeBSD$

--- Makefile.orig	Mon Apr  9 01:16:34 2001
+++ Makefile	Tue May 29 19:37:05 2001
@@ -9,14 +9,15 @@
 #FONTDIR	= /usr/lib/X11/fonts/local
 
 # Works on my Red Hat Linux system:
-GTK-CONFIG	= gtk-config
-PREFIX		= `$(GTK-CONFIG) --prefix`
+GTK-CONFIG	?= gtk-config
+PREFIX		?= `$(GTK-CONFIG) --prefix`
 FONTDIR		= /usr/lib/X11/fonts/misc
 
-CC		= gcc -pipe
-CFLAGS		= -O2 -fomit-frame-pointer `$(GTK-CONFIG) --cflags` -DG_DISABLE_CHECKS
+CC		?= gcc -pipe
+GTK_CFLAGS	!= $(GTK-CONFIG) --cflags
+CFLAGS		+= $(GTK_CFLAGS) -DG_DISABLE_CHECKS
 #CFLAGS		= `$(GTK-CONFIG) --cflags`
-LIBS		= `$(GTK-CONFIG) --libs`
+LIBS		!= $(GTK-CONFIG) --libs
 
 
 #-- End of Configuration --
@@ -35,8 +36,8 @@
 OBJECTS		= xeno_theme_main.o xeno_theme_rc.o xeno_theme_style.o xeno_theme_draw.o \
 		  xeno_theme_color.o xeno_theme_images.o xeno_theme_patches.o
 
-SONAME		= libxeno.so.$(VERSION)
-SHORTNAME	= libxeno.so.$(MAJOR)
+SONAME		= libxeno.so
+SHORTNAME	= libxeno.so
 TINYNAME	= libxeno.so
 
 #-- Targets ----------------------------------------
@@ -44,19 +45,25 @@
 		$(LINK) $(GTKLIBS) $(OBJECTS) -shared -Wl,-soname,$(SHORTNAME) -o $(SONAME)
 
 install-libs:	$(SONAME)
-		install -d $(LIB_PATH)
-		chmod 755 $(SONAME)
-		cp -fdp $(SONAME) $(LIB_PATH)
-		ln -fs $(SONAME) $(LIB_PATH)/$(SHORTNAME)
-		ln -fs $(SONAME) $(LIB_PATH)/$(TINYNAME)
+#		install -d $(LIB_PATH)
+#		chmod 755 $(SONAME)
+#		cp -fdp $(SONAME) $(LIB_PATH)
+#		ln -fs $(SONAME) $(LIB_PATH)/$(SHORTNAME)
+#		ln -fs $(SONAME) $(LIB_PATH)/$(TINYNAME)
+		$(BSD_INSTALL_PROGRAM) $(SONAME) $(LIB_PATH)/$(SONAME)
 
 install-data:
-		cp -fdpR themes/Xenophilia $(DATA_PATH)
-		cp -fdpR "themes/Xeno Thin" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Gradient" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Helix" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Buffed" $(DATA_PATH)
-		ln -fs ../Xenophilia/README.html "$(DATA_PATH)/Xeno Thin/README.html"
+		mkdir -p $(DATA_PATH)/Xenophilia/gtk
+		cd themes/Xenophilia ; \
+			$(BSD_INSTALL_DATA) README.html arrows.png buds.png buttons.png \
+			dimple.png holes.png lines.png xeno.css $(DATA_PATH)/Xenophilia/ ; \
+			$(BSD_INSTALL_DATA) gtk/gtkrc $(DATA_PATH)/Xenophilia/gtk
+		for dir in "Xeno Thin" "Xeno Gradient" "Xeno Helix" "Xeno Buffed"; do \
+			target_dir=$(DATA_PATH)/`echo $${dir} | sed 's| ||'`/gtk ; \
+			mkdir -p $${target_dir} ; \
+			$(BSD_INSTALL_DATA) "themes/$${dir}/gtk/gtkrc" $${target_dir} ; \
+			ln -fs ../Xenophilia/README.html $${target_dir}/../ ; \
+		done
 
 install-fonts:
 		cp -fdp fonts/infernal-120.pcf.gz $(FONTDIR)/infernal-120.pcf.gz
