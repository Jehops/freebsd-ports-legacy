
$FreeBSD$

--- Makefile.orig	Thu Jan 25 13:55:15 2001
+++ Makefile	Wed Feb  7 16:01:50 2001
@@ -4,12 +4,13 @@
 # Edit the entries below for your system:
 # In most cases you don't have to
 
-PREFIX		= `gtk-config --prefix`
-FONTDIR		= /usr/lib/X11/fonts/misc
+#PREFIX		= `gtk-config --prefix`
+FONTDIR		= $(PREFIX)/X11/fonts/misc
 
-CC			= gcc -pipe -ansi
-CFLAGS		= -O2 `gtk-config --cflags` -DG_DISABLE_CHECKS
-LIBS		= `gtk-config --libs`
+CC			?= gcc -pipe -ansi
+GTK_CFLAGS	!= $(GTK_CONFIG) --cflags
+CFLAGS		= $(GTK_CFLAGS) -DG_DISABLE_CHECKS
+LIBS		!= $(GTK_CONFIG) --libs
 
 #Use these for FreeBSD:
 #PREFIX		= `gtk12-config --prefix`
@@ -28,8 +29,8 @@
 
 OBJECTS		= xeno_theme_main.o xeno_theme_patches.o xeno_theme_draw.o xeno_theme_color.o \
 			  xeno_theme_images.o
-SONAME		= libxeno.so.0.6
-SHORTNAME	= libxeno.so.0
+SONAME		= libxeno.so
+SHORTNAME	= libxeno.so
 TINYNAME	= libxeno.so
 OLDNAME		= libxeno.so.0.5
 
@@ -38,19 +39,25 @@
 		$(LINK) $(GTKLIBS) $(OBJECTS) -shared -Wl,-soname,$(SHORTNAME) -o $(SONAME)
 
 install-libs:	$(SONAME)
-		install -d $(LIB_PATH)
-		chmod 755 $(SONAME)
-		cp -fdp $(SONAME) $(LIB_PATH)
-		ln -fs $(SONAME) $(LIB_PATH)/$(SHORTNAME)
-		ln -fs $(SONAME) $(LIB_PATH)/$(TINYNAME)
+#		install -d $(LIB_PATH)
+#		chmod 755 $(SONAME)
+#		cp -fdp $(SONAME) $(LIB_PATH)
+#		ln -fs $(SONAME) $(LIB_PATH)/$(SHORTNAME)
+#		ln -fs $(SONAME) $(LIB_PATH)/$(TINYNAME)
+		$(BSD_INSTALL_PROGRAM) $(SONAME) $(LIB_PATH)/$(SONAME)
 
 install-data:
-		cp -fdpR themes/Xenophilia $(DATA_PATH)
-		cp -fdpR "themes/Xeno Thin" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Gradient" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Helix" $(DATA_PATH)
-		cp -fdpR "themes/Xeno Buffed" $(DATA_PATH)
-		ln -fs ../Xenophilia/README.html "$(DATA_PATH)/Xeno Thin/README.html"
+		mkdir -p $(DATA_PATH)/Xenophilia/gtk
+		cd themes/Xenophilia ; \
+			$(BSD_INSTALL_DATA) README.html arrows.png buds.png buttons.png \
+			dimple.png holes.png lines.png xeno.css $(DATA_PATH)/Xenophilia/ ; \
+			$(BSD_INSTALL_DATA) gtk/gtkrc $(DATA_PATH)/Xenophilia/gtk
+		for dir in "Xeno Thin" "Xeno Gradient" "Xeno Helix" "Xeno Buffed"; do \
+			target_dir=$(DATA_PATH)/`echo $${dir} | sed 's| ||'`/gtk ; \
+			mkdir -p $${target_dir} ; \
+			$(BSD_INSTALL_DATA) "themes/$${dir}/gtk/gtkrc" $${target_dir} ; \
+			ln -fs ../Xenophilia/README.html $${target_dir}/../ ; \
+		done
 
 install-fonts:
 		cp -fdp fonts/infernal-120.pcf.gz $(FONTDIR)/infernal-120.pcf.gz
