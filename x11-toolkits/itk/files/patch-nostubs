--- generic/itk_cmds.c.orig	Fri Jun 22 04:38:54 2001
+++ generic/itk_cmds.c	Sun Mar 13 21:46:16 2005
@@ -111,12 +111,14 @@
 {
     Tcl_Namespace *itkNs, *parserNs;
     ClientData parserInfo;
+    #ifdef USE_ITK_STUBS
     extern ItkStubs itkStubs;
+    #endif
 
-    if (Tcl_InitStubs(interp, "8.1", 0) == NULL) {
+    if (Tcl_InitStubs(interp, TCL_VERSION, 0) == NULL) {
 	return TCL_ERROR;
     };
-    if (Tk_InitStubs(interp, "8.1", 0) == NULL) {
+    if (Tk_InitStubs(interp, TK_VERSION, 0) == NULL) {
 	return TCL_ERROR;
     };
     if (Itcl_InitStubs(interp, ITCL_VERSION, 1) == NULL) {
@@ -209,7 +211,12 @@
      *  end-of-the-line?
      */
     if (Tcl_PkgProvideEx(interp, "Itk", ITCL_VERSION,
-            (ClientData) &itkStubs) != TCL_OK) {
+#ifdef USE_ITK_STUBS
+            (ClientData) &itkStubs
+#else
+	    (ClientData) NULL
+#endif
+		) != TCL_OK) {
 	return TCL_ERROR;
     }
     return TCL_OK;
