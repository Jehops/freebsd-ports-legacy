--- fop.sh.orig	Fri Oct  3 00:24:47 2003
+++ fop.sh	Fri Oct  3 00:25:24 2003
@@ -1,5 +1,25 @@
 #! /bin/sh
 #
+# Common variables
+PREFIX=%%PREFIX%%
+
+# Default JAVACMD, JAVA_HOME, FOP_HOME
+JAVACMD=${JAVACMD:-`which javavm`}
+if [ -f ${PREFIX}/etc/javavms ]; then
+    JAVA_HOME=`head -1 /usr/local/etc/javavms | sed -e 's,/bin/java *#.*$,,'`
+elif [ -n "`echo ${PREFIX}/jdk*/bin/java 2> /dev/null`" ]; then
+    JAVA_HOME=`ls -d /usr/local/jdk*/bin/java | sort -r | head -1 | sed -e 's,/bin/java *$,,'`
+fi
+SHAREDIR=${PREFIX}/share
+FOP_HOME=${SHAREDIR}/fop
+DIRLIBS="\
+    ${FOP_HOME}/lib/xml-apis.jar
+    ${FOP_HOME}/lib/xercesImpl-2.2.1.jar
+    ${FOP_HOME}/lib/xalan-2.4.1.jar
+    ${FOP_HOME}/lib/batik.jar
+    ${FOP_HOME}/lib/avalon-framework-cvs-20020806.jar
+    ${FOP_HOME}/lib/ant-1.5.1.jar"
+
 # Shell script to run FOP, adapted from the Jakarta-Ant project.
 
 if [ -f $HOME/.foprc ] ; then 
@@ -79,7 +99,7 @@
 LOCALCLASSPATH=${FOP_HOME}/build/fop.jar:$LOCALCLASSPATH
 
 # add in the dependency .jar files, which reside in $FOP_HOME/lib
-DIRLIBS=${FOP_HOME}/lib/*.jar
+
 for i in ${DIRLIBS}
 do
     # if the directory is empty, then it will return the input string
